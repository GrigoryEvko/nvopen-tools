// Function: sub_39772B0
// Address: 0x39772b0
//
void __fastcall sub_39772B0(__int64 a1)
{
  __int64 v1; // rax
  __int64 v2; // rdx
  __int64 v3; // rax
  __int64 v4; // rdx
  __int64 v6; // rbx
  int v7; // r12d
  __int64 v8; // r13
  __int64 v9; // rax
  unsigned int v10; // eax
  __int64 v11; // rcx
  __int64 v12; // r15
  __int64 (__fastcall *v13)(__int64, __int64, _QWORD, __int64, unsigned int *); // r13
  __int64 v14; // rax
  __int64 v15; // rax
  __int64 v16; // rcx
  int v17; // r9d
  unsigned int v18; // r13d
  _BYTE *v19; // r8
  __int64 v20; // rsi
  __int64 v21; // rdx
  _BYTE *v22; // rax
  unsigned int v23; // edx
  __int64 v24; // rdx
  __int64 v25; // rax
  int v26; // r14d
  _BYTE *v27; // rax
  __int64 v28; // r12
  __int64 v29; // r15
  int v30; // ecx
  _BYTE *v31; // r12
  _BYTE *v32; // rbx
  unsigned __int64 v33; // rdi
  _QWORD **v34; // r13
  __int64 v35; // rax
  __int64 v36; // rbx
  __int64 v37; // rax
  _QWORD *v38; // r15
  __int64 v39; // rsi
  unsigned int v40; // esi
  unsigned int v41; // eax
  __int64 *v42; // rdi
  int v43; // ebx
  __int64 v44; // r14
  unsigned int v45; // eax
  __int64 v46; // rdi
  __int64 v47; // rcx
  unsigned __int64 v48; // r9
  __int64 v49; // rax
  int v50; // eax
  unsigned int v51; // eax
  __int64 v52; // rdi
  __int64 v53; // r11
  __int64 v54; // rsi
  unsigned __int64 v55; // r14
  _QWORD *v56; // rax
  int v57; // eax
  unsigned __int64 v58; // rdx
  __int64 *v59; // rbx
  __int64 v60; // rax
  __int64 v61; // rax
  unsigned int v62; // esi
  int v63; // eax
  unsigned int v64; // eax
  __int64 v65; // rdi
  __int64 v66; // rsi
  _QWORD *v67; // rax
  __int64 v68; // rax
  unsigned __int64 v69; // rax
  unsigned __int64 v70; // rax
  unsigned __int64 v71; // rcx
  __int64 v72; // rax
  __int64 v73; // rax
  _BYTE *v74; // r8
  __int64 v75; // rax
  __int64 v76; // rdx
  _BYTE *v77; // r12
  _BYTE *v78; // rbx
  _BYTE *v79; // r15
  int v80; // eax
  char **v81; // rsi
  __int64 v82; // rdi
  _BYTE *v83; // r15
  _BYTE *v84; // rbx
  unsigned __int64 v85; // rdi
  __int64 v86; // rax
  __int64 v87; // rdi
  __int64 v88; // rsi
  int v89; // eax
  __int64 v90; // rax
  __int64 v91; // rax
  unsigned int v92; // esi
  __int64 v93; // [rsp+18h] [rbp-1B8h]
  __int64 v94; // [rsp+18h] [rbp-1B8h]
  __int64 v95; // [rsp+20h] [rbp-1B0h]
  __int64 v96; // [rsp+28h] [rbp-1A8h]
  __int64 v97; // [rsp+30h] [rbp-1A0h]
  __int64 v98; // [rsp+40h] [rbp-190h]
  __int64 v99; // [rsp+40h] [rbp-190h]
  __int64 v100; // [rsp+40h] [rbp-190h]
  __int64 v101; // [rsp+48h] [rbp-188h]
  __int64 v102; // [rsp+48h] [rbp-188h]
  unsigned __int64 v103; // [rsp+48h] [rbp-188h]
  __int64 v104; // [rsp+50h] [rbp-180h]
  __int64 v105; // [rsp+50h] [rbp-180h]
  __int64 v106; // [rsp+50h] [rbp-180h]
  __int64 v107; // [rsp+50h] [rbp-180h]
  unsigned __int64 v108; // [rsp+58h] [rbp-178h]
  __int64 v109; // [rsp+58h] [rbp-178h]
  unsigned __int64 v110; // [rsp+58h] [rbp-178h]
  unsigned __int64 v111; // [rsp+58h] [rbp-178h]
  __int64 v112; // [rsp+58h] [rbp-178h]
  __int64 v113; // [rsp+58h] [rbp-178h]
  __int64 v114; // [rsp+58h] [rbp-178h]
  _BYTE *v115; // [rsp+58h] [rbp-178h]
  int v116; // [rsp+58h] [rbp-178h]
  __int64 v117; // [rsp+60h] [rbp-170h]
  __int64 v118; // [rsp+68h] [rbp-168h]
  __int64 v119; // [rsp+70h] [rbp-160h]
  __int64 v120; // [rsp+78h] [rbp-158h]
  __int64 v121; // [rsp+78h] [rbp-158h]
  __int64 v122; // [rsp+78h] [rbp-158h]
  __int64 v123; // [rsp+78h] [rbp-158h]
  __int64 v124; // [rsp+78h] [rbp-158h]
  __int64 v125; // [rsp+78h] [rbp-158h]
  unsigned int v126; // [rsp+80h] [rbp-150h]
  __int64 v127; // [rsp+80h] [rbp-150h]
  int v128; // [rsp+80h] [rbp-150h]
  __int64 v129; // [rsp+88h] [rbp-148h]
  __int64 v130; // [rsp+88h] [rbp-148h]
  _BYTE *v131; // [rsp+88h] [rbp-148h]
  _BYTE *v132; // [rsp+88h] [rbp-148h]
  unsigned int v133; // [rsp+9Ch] [rbp-134h] BYREF
  __m128i v134; // [rsp+A0h] [rbp-130h] BYREF
  char *v135; // [rsp+B0h] [rbp-120h] BYREF
  __int64 v136; // [rsp+B8h] [rbp-118h]
  _BYTE v137[16]; // [rsp+C0h] [rbp-110h] BYREF
  _BYTE *v138; // [rsp+D0h] [rbp-100h]
  __int64 v139; // [rsp+D8h] [rbp-F8h]
  _BYTE v140[240]; // [rsp+E0h] [rbp-F0h] BYREF

  v1 = *(_QWORD *)(*(_QWORD *)(a1 + 264) + 64LL);
  v118 = v1;
  v2 = *(_QWORD *)(v1 + 16);
  if ( v2 != *(_QWORD *)(v1 + 8) )
  {
    v138 = v140;
    v139 = 0x400000000LL;
    v3 = *(_QWORD *)(v1 + 8);
    v4 = (v2 - v3) >> 4;
    if ( (_DWORD)v4 )
    {
      v6 = 0;
      v120 = (unsigned int)v4;
      while ( 1 )
      {
        v7 = v6;
        v8 = v3 + 16 * v6;
        v133 = *(_DWORD *)(v8 + 8) & 0x7FFFFFFF;
        v9 = sub_396DDB0(a1);
        v10 = sub_1E0AB90(v8, v9);
        v11 = 0;
        if ( *(int *)(v8 + 8) >= 0 )
          v11 = *(_QWORD *)v8;
        v126 = v10;
        v129 = v11;
        v12 = sub_396DD80(a1);
        v13 = *(__int64 (__fastcall **)(__int64, __int64, _QWORD, __int64, unsigned int *))(*(_QWORD *)v12 + 40LL);
        v14 = sub_396DDB0(a1);
        v15 = v13(v12, v14, v126, v129, &v133);
        v18 = v139;
        v19 = v138;
        v20 = v15;
        LODWORD(v21) = v139;
        while ( (_DWORD)v21 )
        {
          v21 = (unsigned int)(v21 - 1);
          v22 = &v138[48 * v21];
          if ( *(_QWORD *)v22 == v20 )
            goto LABEL_18;
        }
        v134.m128i_i64[0] = v20;
        v134.m128i_i32[2] = v133;
        v135 = v137;
        v136 = 0x400000000LL;
        if ( (unsigned int)v139 >= HIDWORD(v139) )
        {
          v115 = v138;
          v69 = (((((unsigned __int64)HIDWORD(v139) + 2) >> 1) | (HIDWORD(v139) + 2LL)) >> 2)
              | (((unsigned __int64)HIDWORD(v139) + 2) >> 1)
              | (HIDWORD(v139) + 2LL);
          v70 = (((v69 >> 4) | v69) >> 8) | (v69 >> 4) | v69;
          v71 = (v70 | (v70 >> 16) | HIDWORD(v70)) + 1;
          v72 = 0xFFFFFFFFLL;
          if ( v71 <= 0xFFFFFFFF )
            v72 = v71;
          v128 = v72;
          v73 = malloc(48 * v72);
          v74 = v115;
          v132 = (_BYTE *)v73;
          if ( v73 )
          {
            v75 = v18;
          }
          else
          {
            sub_16BD1C0("Allocation failed", 1u);
            v74 = v138;
            v75 = (unsigned int)v139;
          }
          v76 = (__int64)&v74[48 * v75];
          if ( (_BYTE *)v76 != v74 )
          {
            v116 = v6;
            v77 = v74;
            v107 = v6;
            v78 = &v74[48 * v75];
            v79 = v132;
            do
            {
              while ( 1 )
              {
                if ( v79 )
                {
                  *(_QWORD *)v79 = *(_QWORD *)v77;
                  v80 = *((_DWORD *)v77 + 2);
                  *((_DWORD *)v79 + 6) = 0;
                  *((_DWORD *)v79 + 2) = v80;
                  *((_QWORD *)v79 + 2) = v79 + 32;
                  *((_DWORD *)v79 + 7) = 4;
                  v16 = *((unsigned int *)v77 + 6);
                  if ( (_DWORD)v16 )
                    break;
                }
                v77 += 48;
                v79 += 48;
                if ( v78 == v77 )
                  goto LABEL_87;
              }
              v81 = (char **)(v77 + 16);
              v82 = (__int64)(v79 + 16);
              v77 += 48;
              v79 += 48;
              sub_396BC80(v82, v81, v76, v16, (int)v74, v17);
            }
            while ( v78 != v77 );
LABEL_87:
            v7 = v116;
            v6 = v107;
            v74 = &v138[48 * (unsigned int)v139];
            if ( v138 != v74 )
            {
              v83 = v138;
              v84 = &v138[48 * (unsigned int)v139];
              do
              {
                v84 -= 48;
                v85 = *((_QWORD *)v84 + 2);
                if ( (_BYTE *)v85 != v84 + 32 )
                  _libc_free(v85);
              }
              while ( v83 != v84 );
              v6 = v107;
              v74 = v138;
            }
          }
          if ( v74 != v140 )
            _libc_free((unsigned __int64)v74);
          v19 = v132;
          v23 = v139;
          v138 = v132;
          HIDWORD(v139) = v128;
        }
        else
        {
          v23 = v139;
        }
        v19 += 48 * v23;
        if ( v19 )
        {
          *(_QWORD *)v19 = v134.m128i_i64[0];
          *((_DWORD *)v19 + 2) = v134.m128i_i32[2];
          *((_QWORD *)v19 + 2) = v19 + 32;
          *((_QWORD *)v19 + 3) = 0x400000000LL;
          if ( (_DWORD)v136 )
            sub_396BC80((__int64)(v19 + 16), &v135, (unsigned int)v136, v16, (int)v19, v17);
          v23 = v139;
        }
        LODWORD(v139) = v23 + 1;
        if ( v135 != v137 )
          _libc_free((unsigned __int64)v135);
        v22 = &v138[48 * v18];
LABEL_18:
        if ( *((_DWORD *)v22 + 2) < v133 )
          *((_DWORD *)v22 + 2) = v133;
        v24 = *((unsigned int *)v22 + 6);
        if ( (unsigned int)v24 >= *((_DWORD *)v22 + 7) )
        {
          v131 = v22;
          sub_16CD150((__int64)(v22 + 16), v22 + 32, 0, 4, (int)v19, v17);
          v22 = v131;
          v24 = *((unsigned int *)v131 + 6);
        }
        ++v6;
        *(_DWORD *)(*((_QWORD *)v22 + 2) + 4 * v24) = v7;
        ++*((_DWORD *)v22 + 6);
        if ( v120 == v6 )
          break;
        v3 = *(_QWORD *)(v118 + 8);
      }
      v31 = v138;
      if ( (_DWORD)v139 )
      {
        v29 = 0;
        v30 = 0;
        v34 = (_QWORD **)a1;
        v119 = 0;
        v117 = 48LL * (unsigned int)v139;
        do
        {
          v35 = *(unsigned int *)&v31[v29 + 24];
          if ( (_DWORD)v35 )
          {
            v130 = v29;
            v127 = 4 * v35;
            v27 = v31;
            v28 = 0;
            v26 = v30;
            do
            {
              v36 = *(unsigned int *)(*(_QWORD *)&v27[v130 + 16] + v28);
              v37 = ((__int64 (__fastcall *)(_QWORD **, _QWORD))(*v34)[36])(v34, (unsigned int)v36);
              v38 = (_QWORD *)v37;
              if ( (*(_QWORD *)v37 & 0xFFFFFFFFFFFFFFF8LL) == 0 )
              {
                if ( (*(_BYTE *)(v37 + 9) & 0xC) != 8
                  || (*(_BYTE *)(v37 + 8) |= 4u,
                      v58 = (unsigned __int64)sub_38CE440(*(_QWORD *)(v37 + 24)),
                      *v38 = v58 | *v38 & 7LL,
                      !v58) )
                {
                  v39 = *(_QWORD *)&v138[v130];
                  if ( v39 != v119 )
                  {
                    (*(void (__fastcall **)(_QWORD *, __int64, _QWORD))(*v34[32] + 160LL))(v34[32], v39, 0);
                    v40 = -1;
                    v41 = *(_DWORD *)&v138[v130 + 8];
                    if ( v41 )
                    {
                      _BitScanReverse(&v41, v41);
                      v40 = 31 - (v41 ^ 0x1F);
                    }
                    v26 = 0;
                    sub_396F480((__int64)v34, v40, 0);
                    v119 = *(_QWORD *)&v138[v130];
                  }
                  v42 = v34[32];
                  v134 = _mm_loadu_si128((const __m128i *)(*(_QWORD *)(v118 + 8) + 16 * v36));
                  v43 = -(v134.m128i_i32[2] & 0x7FFFFFFF) & (v26 + (v134.m128i_i32[2] & 0x7FFFFFFF) - 1);
                  sub_38DD110(v42, (unsigned int)(v43 - v26));
                  v44 = sub_1E0AB50((__int64)&v134);
                  v121 = sub_396DDB0((__int64)v34);
                  v45 = sub_15A9FE0(v121, v44);
                  v46 = v121;
                  v47 = 1;
                  v48 = v45;
                  while ( 2 )
                  {
                    switch ( *(_BYTE *)(v44 + 8) )
                    {
                      case 0:
                      case 8:
                      case 0xA:
                      case 0xC:
                      case 0x10:
                        v49 = *(_QWORD *)(v44 + 32);
                        v44 = *(_QWORD *)(v44 + 24);
                        v47 *= v49;
                        continue;
                      case 1:
                        v25 = 16;
                        break;
                      case 2:
                        v25 = 32;
                        break;
                      case 3:
                      case 9:
                        v25 = 64;
                        break;
                      case 4:
                        v25 = 80;
                        break;
                      case 5:
                      case 6:
                        v25 = 128;
                        break;
                      case 7:
                        v111 = v48;
                        v125 = v47;
                        v57 = sub_15A9520(v46, 0);
                        v47 = v125;
                        v48 = v111;
                        v25 = (unsigned int)(8 * v57);
                        break;
                      case 0xB:
                        v25 = *(_DWORD *)(v44 + 8) >> 8;
                        break;
                      case 0xD:
                        v110 = v48;
                        v124 = v47;
                        v56 = (_QWORD *)sub_15A9930(v46, v44);
                        v47 = v124;
                        v48 = v110;
                        v25 = 8LL * *v56;
                        break;
                      case 0xE:
                        v98 = v48;
                        v101 = v47;
                        v104 = *(_QWORD *)(v44 + 24);
                        v109 = v121;
                        v123 = *(_QWORD *)(v44 + 32);
                        v51 = sub_15A9FE0(v46, v104);
                        v52 = v109;
                        v48 = v98;
                        v53 = 1;
                        v54 = v104;
                        v47 = v101;
                        v55 = v51;
                        while ( 2 )
                        {
                          switch ( *(_BYTE *)(v54 + 8) )
                          {
                            case 0:
                            case 8:
                            case 0xA:
                            case 0xC:
                            case 0x10:
                              v68 = *(_QWORD *)(v54 + 32);
                              v54 = *(_QWORD *)(v54 + 24);
                              v53 *= v68;
                              continue;
                            case 1:
                              v61 = 16;
                              goto LABEL_65;
                            case 2:
                              v61 = 32;
                              goto LABEL_65;
                            case 3:
                            case 9:
                              v61 = 64;
                              goto LABEL_65;
                            case 4:
                              v61 = 80;
                              goto LABEL_65;
                            case 5:
                            case 6:
                              v61 = 128;
                              goto LABEL_65;
                            case 7:
                              v102 = v98;
                              v62 = 0;
                              v105 = v47;
                              v112 = v53;
                              goto LABEL_69;
                            case 0xB:
                              v61 = *(_DWORD *)(v54 + 8) >> 8;
                              goto LABEL_65;
                            case 0xD:
                              v114 = v53;
                              v67 = (_QWORD *)sub_15A9930(v52, v54);
                              v53 = v114;
                              v47 = v101;
                              v48 = v98;
                              v61 = 8LL * *v67;
                              goto LABEL_65;
                            case 0xE:
                              v93 = v98;
                              v95 = v101;
                              v96 = v53;
                              v97 = *(_QWORD *)(v54 + 24);
                              v99 = v109;
                              v106 = *(_QWORD *)(v54 + 32);
                              v64 = sub_15A9FE0(v109, v97);
                              v65 = v109;
                              v113 = 1;
                              v48 = v93;
                              v47 = v101;
                              v103 = v64;
                              v66 = v97;
                              v53 = v96;
                              while ( 2 )
                              {
                                switch ( *(_BYTE *)(v66 + 8) )
                                {
                                  case 0:
                                  case 8:
                                  case 0xA:
                                  case 0xC:
                                  case 0x10:
                                    v90 = v113 * *(_QWORD *)(v66 + 32);
                                    v66 = *(_QWORD *)(v66 + 24);
                                    v113 = v90;
                                    continue;
                                  case 1:
                                    v86 = 16;
                                    goto LABEL_98;
                                  case 2:
                                    v86 = 32;
                                    goto LABEL_98;
                                  case 3:
                                  case 9:
                                    v86 = 64;
                                    goto LABEL_98;
                                  case 4:
                                    v86 = 80;
                                    goto LABEL_98;
                                  case 5:
                                  case 6:
                                    v86 = 128;
                                    goto LABEL_98;
                                  case 7:
                                    v89 = sub_15A9520(v65, 0);
                                    v53 = v96;
                                    v47 = v95;
                                    v48 = v93;
                                    v86 = (unsigned int)(8 * v89);
                                    goto LABEL_98;
                                  case 0xB:
                                    v86 = *(_DWORD *)(v66 + 8) >> 8;
LABEL_98:
                                    v61 = 8
                                        * v103
                                        * v106
                                        * ((v103 + ((unsigned __int64)(v113 * v86 + 7) >> 3) - 1)
                                         / v103);
                                    break;
                                  case 0xD:
                                    JUMPOUT(0x3977E29);
                                  case 0xE:
                                    v94 = *(_QWORD *)(v66 + 24);
                                    sub_15A9FE0(v65, v94);
                                    v87 = v99;
                                    v100 = 1;
                                    v88 = v94;
                                    while ( 2 )
                                    {
                                      switch ( *(_BYTE *)(v88 + 8) )
                                      {
                                        case 0:
                                        case 8:
                                        case 0xA:
                                        case 0xC:
                                        case 0x10:
                                          v91 = v100 * *(_QWORD *)(v88 + 32);
                                          v88 = *(_QWORD *)(v88 + 24);
                                          v100 = v91;
                                          continue;
                                        case 1:
                                        case 2:
                                        case 4:
                                        case 5:
                                        case 6:
                                        case 0xB:
                                          goto LABEL_118;
                                        case 3:
                                        case 9:
                                          JUMPOUT(0x3977EA9);
                                        case 7:
                                          v92 = 0;
                                          goto LABEL_112;
                                        case 0xD:
                                          sub_15A9930(v87, v88);
                                          goto LABEL_118;
                                        case 0xE:
                                          sub_12BE0A0(v87, *(_QWORD *)(v88 + 24));
                                          goto LABEL_118;
                                        case 0xF:
                                          v92 = *(_DWORD *)(v88 + 8) >> 8;
LABEL_112:
                                          sub_15A9520(v87, v92);
LABEL_118:
                                          JUMPOUT(0x3977EAE);
                                      }
                                    }
                                  case 0xF:
                                    JUMPOUT(0x3977E59);
                                }
                                goto LABEL_65;
                              }
                            case 0xF:
                              v102 = v98;
                              v105 = v47;
                              v112 = v53;
                              v62 = *(_DWORD *)(v54 + 8) >> 8;
LABEL_69:
                              v63 = sub_15A9520(v52, v62);
                              v53 = v112;
                              v47 = v105;
                              v48 = v102;
                              v61 = (unsigned int)(8 * v63);
LABEL_65:
                              v25 = 8 * v55 * v123 * ((v55 + ((unsigned __int64)(v61 * v53 + 7) >> 3) - 1) / v55);
                              break;
                          }
                          break;
                        }
                        break;
                      case 0xF:
                        v108 = v48;
                        v122 = v47;
                        v50 = sub_15A9520(v46, *(_DWORD *)(v44 + 8) >> 8);
                        v47 = v122;
                        v48 = v108;
                        v25 = (unsigned int)(8 * v50);
                        break;
                    }
                    break;
                  }
                  v26 = v43 + v48 * ((v48 + ((unsigned __int64)(v25 * v47 + 7) >> 3) - 1) / v48);
                  (*(void (__fastcall **)(_QWORD *, _QWORD *, _QWORD))(*v34[32] + 176LL))(v34[32], v38, 0);
                  if ( v134.m128i_i32[2] >= 0 )
                  {
                    v59 = (__int64 *)v134.m128i_i64[0];
                    v60 = sub_396DDB0((__int64)v34);
                    sub_3976960((__int64)v34, v60, v59);
                  }
                  else
                  {
                    ((void (__fastcall *)(_QWORD **, __int64))(*v34)[38])(v34, v134.m128i_i64[0]);
                  }
                }
              }
              v27 = v138;
              v28 += 4;
            }
            while ( v127 != v28 );
            v29 = v130;
            v30 = v26;
            v31 = v138;
          }
          v29 += 48;
        }
        while ( v117 != v29 );
        v32 = &v31[48 * (unsigned int)v139];
        if ( v32 != v31 )
        {
          do
          {
            v32 -= 48;
            v33 = *((_QWORD *)v32 + 2);
            if ( (_BYTE *)v33 != v32 + 32 )
              _libc_free(v33);
          }
          while ( v32 != v31 );
          v31 = v138;
        }
      }
      if ( v31 != v140 )
        _libc_free((unsigned __int64)v31);
    }
  }
}

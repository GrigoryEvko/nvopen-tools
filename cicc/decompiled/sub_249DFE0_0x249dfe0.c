// Function: sub_249DFE0
// Address: 0x249dfe0
//
__int64 __fastcall sub_249DFE0(__int64 a1, __int64 a2)
{
  __int64 v3; // rax
  __int64 v4; // rax
  __int64 v5; // r12
  __int64 v6; // r13
  __int64 v7; // r14
  __int64 v8; // rbx
  __int64 v9; // rdx
  __int64 v10; // rax
  __int64 v11; // rdx
  __int64 v12; // rbx
  __int64 v13; // rdx
  __int64 v14; // rax
  unsigned __int8 *v15; // rax
  __int64 v16; // r12
  __int64 v17; // rax
  __int64 *v18; // rax
  __int64 *v19; // rax
  _QWORD *v20; // rax
  unsigned int **v21; // rsi
  _QWORD *v22; // rax
  __int64 v23; // rcx
  __int64 v24; // rax
  unsigned int v25; // r10d
  unsigned int ***v26; // r9
  unsigned int **v27; // rax
  __int64 v28; // rax
  __int64 v29; // rax
  unsigned __int64 v30; // rsi
  __int64 v31; // rdx
  __int64 v32; // r12
  __int64 v33; // rax
  unsigned __int64 *v34; // rbx
  unsigned __int64 *v35; // r12
  unsigned __int64 v36; // rdi
  __int64 **v37; // rax
  unsigned __int8 *v38; // r12
  __int64 *v39; // rax
  __int64 v40; // rax
  unsigned __int8 *v41; // rbx
  __int64 (__fastcall *v42)(__int64, unsigned int, unsigned __int8 *, unsigned __int8 *); // rax
  __int64 v43; // r13
  __int64 v44; // rbx
  bool v45; // r13
  __int64 v46; // r13
  char v47; // al
  _QWORD *v48; // r12
  __int64 v49; // rax
  unsigned int v50; // eax
  __int64 v51; // rax
  int v52; // eax
  __int64 v53; // rax
  __int64 v54; // rax
  __int64 v55; // rax
  __int64 v56; // rax
  __int64 v57; // r13
  __int64 v58; // rax
  char v59; // al
  __int16 v60; // cx
  unsigned __int8 *v61; // rax
  unsigned __int8 *v62; // r15
  unsigned int *v63; // r14
  unsigned int *v64; // r13
  __int64 v65; // rdx
  unsigned int v66; // esi
  __int64 (__fastcall *v67)(__int64, unsigned int, unsigned __int8 *, unsigned __int8 *, unsigned __int8, char); // rax
  __int64 v68; // r14
  __int64 v69; // rax
  char v70; // al
  char v71; // r15
  _QWORD *v72; // rax
  __int64 v73; // r9
  __int64 v74; // r13
  unsigned int *v75; // r15
  unsigned int *v76; // r14
  __int64 v77; // rdx
  unsigned int v78; // esi
  char v79; // al
  __int64 v80; // rax
  __int64 v81; // r12
  __int64 v82; // rax
  __int64 v83; // rdx
  __int64 v84; // rcx
  __int64 v85; // r8
  __int64 v86; // r9
  __m128i v87; // xmm0
  __m128i v88; // xmm1
  __m128i v89; // xmm2
  int v90; // r13d
  unsigned __int64 *v91; // r12
  unsigned __int64 *v92; // r13
  unsigned __int64 *v93; // r12
  unsigned __int64 v94; // rdi
  __int64 v95; // rax
  _BYTE *v96; // rax
  __int64 v97; // r9
  __int64 v98; // rax
  __int64 v99; // rax
  unsigned __int64 v100; // rsi
  __int64 v101; // rdx
  __int64 v102; // r12
  __int64 v103; // rax
  unsigned __int64 *v104; // rbx
  unsigned __int64 *v105; // r12
  unsigned __int64 v106; // rdi
  __int64 v107; // rax
  __int64 v108; // rax
  __m128i *v109; // rax
  __int64 v110; // rsi
  unsigned __int64 *v111; // r14
  unsigned __int64 *v112; // r12
  unsigned __int64 *v113; // rbx
  __m128i *v114; // r14
  unsigned __int64 v115; // rdi
  __int64 v116; // r13
  __int64 v117; // rax
  char v118; // al
  char v119; // r15
  _QWORD *v120; // rax
  __int64 v121; // r9
  __int64 v122; // r14
  unsigned int *v123; // r15
  unsigned int *v124; // r13
  __int64 v125; // rdx
  unsigned int v126; // esi
  __int64 v127; // rax
  __int64 v128; // rax
  __int64 v129; // r13
  __int64 v130; // rax
  char v131; // al
  __int16 v132; // cx
  __int64 v133; // r9
  _QWORD *v134; // r14
  unsigned int *v135; // r15
  unsigned int *v136; // r13
  __int64 v137; // rdx
  unsigned int v138; // esi
  unsigned int *v139; // r15
  unsigned int *v140; // r13
  __int64 v141; // rdx
  unsigned int v142; // esi
  unsigned __int64 v143; // rsi
  __int64 v144; // rdx
  __int64 v145; // r12
  const char *v146; // rax
  __int64 v147; // rdx
  unsigned int *v148; // r12
  unsigned int *v149; // rbx
  __int64 v150; // rdx
  unsigned int v151; // esi
  __int64 v152; // rax
  unsigned __int8 *v153; // r13
  __int64 (__fastcall *v154)(__int64, unsigned int, unsigned __int8 *, unsigned __int8 *); // rax
  _BYTE *v155; // rbx
  __int64 v156; // r13
  __int64 *v157; // rax
  __int64 v158; // rax
  __int64 v159; // rax
  __int64 v160; // r13
  __int64 v161; // rax
  __int64 v162; // rax
  __int64 v163; // rax
  unsigned int *v164; // r13
  __int64 v165; // r12
  unsigned int *v166; // rbx
  __int64 v167; // rdx
  unsigned int v168; // esi
  int v169; // edi
  __int64 v170; // rax
  __int64 v171; // rax
  __int64 v172; // [rsp+8h] [rbp-498h]
  unsigned __int8 v175; // [rsp+2Fh] [rbp-471h]
  unsigned int **v176; // [rsp+30h] [rbp-470h]
  __int64 v177; // [rsp+38h] [rbp-468h]
  unsigned __int64 v178; // [rsp+40h] [rbp-460h]
  __int64 v179; // [rsp+48h] [rbp-458h]
  __int64 v180; // [rsp+50h] [rbp-450h]
  __int64 v181; // [rsp+58h] [rbp-448h]
  __int64 v182; // [rsp+60h] [rbp-440h]
  __int64 v183; // [rsp+68h] [rbp-438h]
  unsigned __int8 *v184; // [rsp+70h] [rbp-430h]
  __int64 v185; // [rsp+78h] [rbp-428h]
  _BYTE *v186; // [rsp+78h] [rbp-428h]
  __int16 v187; // [rsp+84h] [rbp-41Ch]
  __int16 v188; // [rsp+86h] [rbp-41Ah]
  __int64 v189; // [rsp+88h] [rbp-418h]
  __int64 **v190; // [rsp+88h] [rbp-418h]
  __int64 v191; // [rsp+88h] [rbp-418h]
  unsigned __int8 *v192; // [rsp+88h] [rbp-418h]
  _QWORD *v193; // [rsp+90h] [rbp-410h]
  __int64 *v194; // [rsp+98h] [rbp-408h]
  __int64 v195; // [rsp+98h] [rbp-408h]
  __int64 v196; // [rsp+A0h] [rbp-400h]
  _BYTE *v197[4]; // [rsp+B0h] [rbp-3F0h] BYREF
  __int16 v198; // [rsp+D0h] [rbp-3D0h]
  _BYTE *v199; // [rsp+E0h] [rbp-3C0h] BYREF
  __int64 v200; // [rsp+E8h] [rbp-3B8h]
  __int64 v201; // [rsp+F0h] [rbp-3B0h]
  __int64 v202; // [rsp+F8h] [rbp-3A8h]
  __int64 v203; // [rsp+100h] [rbp-3A0h]
  unsigned int *v204; // [rsp+110h] [rbp-390h] BYREF
  int v205; // [rsp+118h] [rbp-388h]
  char v206; // [rsp+11Ch] [rbp-384h]
  _QWORD *v207; // [rsp+120h] [rbp-380h] BYREF
  __m128i v208; // [rsp+128h] [rbp-378h]
  __int64 v209; // [rsp+138h] [rbp-368h]
  __m128i v210; // [rsp+140h] [rbp-360h]
  __m128i v211; // [rsp+150h] [rbp-350h]
  unsigned __int64 *v212; // [rsp+160h] [rbp-340h] BYREF
  __int64 v213; // [rsp+168h] [rbp-338h]
  _BYTE v214[32]; // [rsp+170h] [rbp-330h] BYREF
  void *v215; // [rsp+190h] [rbp-310h]
  char v216; // [rsp+2B0h] [rbp-1F0h]
  int v217; // [rsp+2B4h] [rbp-1ECh]
  __int64 v218; // [rsp+2B8h] [rbp-1E8h]
  unsigned int *v219; // [rsp+2C0h] [rbp-1E0h] BYREF
  _QWORD *v220; // [rsp+2C8h] [rbp-1D8h]
  _QWORD *v221; // [rsp+2D0h] [rbp-1D0h] BYREF
  __m128i v222; // [rsp+2D8h] [rbp-1C8h] BYREF
  __int64 v223; // [rsp+2E8h] [rbp-1B8h]
  __m128i v224; // [rsp+2F0h] [rbp-1B0h] BYREF
  __m128i v225; // [rsp+300h] [rbp-1A0h] BYREF
  unsigned __int64 *v226; // [rsp+310h] [rbp-190h]
  __int64 v227; // [rsp+318h] [rbp-188h]
  _BYTE v228[32]; // [rsp+320h] [rbp-180h] BYREF
  void *v229; // [rsp+340h] [rbp-160h]
  char v230; // [rsp+460h] [rbp-40h]
  int v231; // [rsp+464h] [rbp-3Ch]
  __int64 v232; // [rsp+468h] [rbp-38h]

  v175 = sub_B2FC80(a2);
  if ( v175 )
    return 0;
  v3 = sub_BC0510(*(_QWORD *)(a1 + 8), &unk_4F82418, *(_QWORD *)a1);
  v4 = sub_BC1CD0(*(_QWORD *)(v3 + 8), &unk_4F8FAE8, a2);
  v5 = *(_QWORD *)(a2 + 80);
  v196 = v4;
  v194 = (__int64 *)(v4 + 8);
  v177 = a2 + 72;
  if ( v5 == a2 + 72 )
  {
    v11 = a2 + 72;
    LODWORD(v7) = 0;
    LODWORD(v6) = 0;
  }
  else
  {
    LODWORD(v6) = 0;
    LODWORD(v7) = 0;
    while ( 1 )
    {
      if ( !v5 )
        BUG();
      v8 = *(_QWORD *)(v5 + 32);
      if ( v8 != v5 + 24 )
        break;
LABEL_24:
      v5 = *(_QWORD *)(v5 + 8);
      if ( v177 == v5 )
        goto LABEL_25;
    }
    while ( 1 )
    {
      if ( !v8 )
        BUG();
      if ( *(_BYTE *)(v8 - 24) == 85 )
      {
        v9 = *(_QWORD *)(v8 - 56);
        if ( v9 )
        {
          if ( !*(_BYTE *)v9
            && *(_QWORD *)(v9 + 24) == *(_QWORD *)(v8 + 56)
            && (*(_BYTE *)(v9 + 33) & 0x20) != 0
            && (unsigned int)(*(_DWORD *)(v9 + 36) - 198) <= 1 )
          {
            v80 = sub_B59B70(v8 - 24);
            if ( *(_DWORD *)(v80 + 32) <= 0x40u )
              v7 = *(_QWORD *)(v80 + 24);
            else
              v7 = **(_QWORD **)(v80 + 24);
          }
          else if ( !*(_BYTE *)v9
                 && *(_QWORD *)(v9 + 24) == *(_QWORD *)(v8 + 56)
                 && (*(_BYTE *)(v9 + 33) & 0x20) != 0
                 && *(_DWORD *)(v9 + 36) == 196 )
          {
            v10 = sub_B59B70(v8 - 24);
            if ( *(_DWORD *)(v10 + 32) <= 0x40u )
              v6 = *(_QWORD *)(v10 + 24);
            else
              v6 = **(_QWORD **)(v10 + 24);
          }
        }
      }
      if ( (_DWORD)v7 && (_DWORD)v6 )
        break;
      v8 = *(_QWORD *)(v8 + 8);
      if ( v5 + 24 == v8 )
        goto LABEL_24;
    }
LABEL_25:
    v11 = *(_QWORD *)(a2 + 80);
    if ( !v11 )
      BUG();
  }
  v12 = *(_QWORD *)(v11 + 32);
  v13 = v11 + 24;
  if ( v13 == v12 )
    goto LABEL_105;
  while ( 1 )
  {
    if ( !v12 )
      BUG();
    if ( *(_BYTE *)(v12 - 24) == 85 )
    {
      v14 = *(_QWORD *)(v12 - 56);
      if ( v14 )
      {
        if ( !*(_BYTE *)v14
          && *(_QWORD *)(v14 + 24) == *(_QWORD *)(v12 + 56)
          && (*(_BYTE *)(v14 + 33) & 0x20) != 0
          && (unsigned int)(*(_DWORD *)(v14 + 36) - 198) <= 1 )
        {
          break;
        }
      }
    }
    v12 = *(_QWORD *)(v12 + 8);
    if ( v13 == v12 )
      goto LABEL_105;
  }
  v193 = (_QWORD *)(v12 - 24);
  sub_23D0AB0((__int64)&v204, v12 - 24, 0, 0, 0);
  v15 = sub_BD3990(*(unsigned __int8 **)(v12 - 32LL * (*(_DWORD *)(v12 - 20) & 0x7FFFFFF) - 24), v12 - 24);
  v16 = sub_30A7A60(v15);
  v17 = sub_BCB2E0((_QWORD *)v211.m128i_i64[1]);
  v189 = sub_ACD640(v17, v16, 0);
  v219 = *(unsigned int **)(a1 + 16);
  v18 = (__int64 *)sub_BCB2E0((_QWORD *)v211.m128i_i64[1]);
  v220 = sub_BCD420(v18, (unsigned int)v7);
  v19 = (__int64 *)sub_BCE3C0((__int64 *)v211.m128i_i64[1], 0);
  v221 = sub_BCD420(v19, (unsigned int)v6);
  v20 = (_QWORD *)sub_B2BE50(a2);
  v21 = &v219;
  v22 = sub_BD0B90(v20, &v219, 3, 0);
  v23 = *(_QWORD *)(a1 + 48);
  v183 = (__int64)v22;
  v24 = *(unsigned int *)(a1 + 64);
  if ( (_DWORD)v24 )
  {
    v25 = (v24 - 1) & (((unsigned int)a2 >> 9) ^ ((unsigned int)a2 >> 4));
    v26 = (unsigned int ***)(v23 + 16LL * v25);
    v21 = *v26;
    if ( (unsigned int **)a2 == *v26 )
    {
LABEL_38:
      if ( v26 != (unsigned int ***)(v23 + 16 * v24) )
      {
        v27 = v26[1];
        v222.m128i_i16[4] = 257;
        v176 = v27;
        v199 = v27;
        v200 = v189;
        v28 = sub_BCB2D0((_QWORD *)v211.m128i_i64[1]);
        v201 = sub_ACD640(v28, (unsigned int)v7, 0);
        v29 = sub_BCB2D0((_QWORD *)v211.m128i_i64[1]);
        v30 = 0;
        v202 = sub_ACD640(v29, (unsigned int)v6, 0);
        v31 = *(_QWORD *)(a1 + 72);
        if ( v31 )
          v30 = *(_QWORD *)(v31 + 24);
        v181 = sub_921880(&v204, v30, v31, (int)&v199, 4, (__int64)&v219, 0);
        v32 = *(_QWORD *)(v196 + 8);
        v33 = sub_B2BE50(v32);
        if ( sub_B6EA50(v33)
          || (v162 = sub_B2BE50(v32),
              v163 = sub_B6F970(v162),
              (*(unsigned __int8 (__fastcall **)(__int64))(*(_QWORD *)v163 + 48LL))(v163)) )
        {
          sub_B17560((__int64)&v219, (__int64)"ctx-instr-lower", (__int64)"Entrypoint", 10, a2);
          sub_1049740(v194, (__int64)&v219);
          v34 = v226;
          v219 = (unsigned int *)&unk_49D9D40;
          v35 = &v226[10 * (unsigned int)v227];
          if ( v226 != v35 )
          {
            do
            {
              v35 -= 10;
              v36 = v35[4];
              if ( (unsigned __int64 *)v36 != v35 + 6 )
                j_j___libc_free_0(v36);
              if ( (unsigned __int64 *)*v35 != v35 + 2 )
                j_j___libc_free_0(*v35);
            }
            while ( v34 != v35 );
            v35 = v226;
          }
          if ( v35 != (unsigned __int64 *)v228 )
            _libc_free((unsigned __int64)v35);
        }
        goto LABEL_51;
      }
    }
    else
    {
      v169 = 1;
      while ( v21 != (unsigned int **)-4096LL )
      {
        v25 = (v24 - 1) & (v169 + v25);
        v26 = (unsigned int ***)(v23 + 16LL * v25);
        v21 = *v26;
        if ( (unsigned int **)a2 == *v26 )
          goto LABEL_38;
        ++v169;
      }
    }
  }
  v95 = sub_AD6530(*(_QWORD *)(a1 + 32), (__int64)v21);
  BYTE4(v199) = 0;
  v185 = v95;
  v222.m128i_i16[4] = 257;
  v96 = sub_BD2C40(88, unk_3F0FAE8);
  if ( v96 )
  {
    v97 = v185;
    v186 = v96;
    sub_B30000((__int64)v96, *(_QWORD *)a1, *(_QWORD **)(a1 + 32), 0, 7, v97, (__int64)&v219, 0, 0, (__int64)v199, 0);
    v96 = v186;
  }
  v199 = v96;
  v222.m128i_i16[4] = 257;
  v200 = a2;
  v201 = v189;
  v98 = sub_BCB2D0((_QWORD *)v211.m128i_i64[1]);
  v202 = sub_ACD640(v98, (unsigned int)v7, 0);
  v99 = sub_BCB2D0((_QWORD *)v211.m128i_i64[1]);
  v100 = 0;
  v203 = sub_ACD640(v99, (unsigned int)v6, 0);
  v101 = *(_QWORD *)(a1 + 80);
  if ( v101 )
    v100 = *(_QWORD *)(v101 + 24);
  v181 = sub_921880(&v204, v100, v101, (int)&v199, 5, (__int64)&v219, 0);
  v102 = *(_QWORD *)(v196 + 8);
  v103 = sub_B2BE50(v102);
  if ( sub_B6EA50(v103)
    || (v107 = sub_B2BE50(v102),
        v108 = sub_B6F970(v107),
        (*(unsigned __int8 (__fastcall **)(__int64))(*(_QWORD *)v108 + 48LL))(v108)) )
  {
    sub_B17560((__int64)&v219, (__int64)"ctx-instr-lower", (__int64)"RegularFunction", 15, a2);
    sub_1049740(v194, (__int64)&v219);
    v104 = v226;
    v219 = (unsigned int *)&unk_49D9D40;
    v105 = &v226[10 * (unsigned int)v227];
    if ( v226 != v105 )
    {
      do
      {
        v105 -= 10;
        v106 = v105[4];
        if ( (unsigned __int64 *)v106 != v105 + 6 )
          j_j___libc_free_0(v106);
        if ( (unsigned __int64 *)*v105 != v105 + 2 )
          j_j___libc_free_0(*v105);
      }
      while ( v104 != v105 );
      v105 = v226;
    }
    if ( v105 != (unsigned __int64 *)v228 )
      _libc_free((unsigned __int64)v105);
  }
  v176 = 0;
LABEL_51:
  v222.m128i_i16[4] = 257;
  v37 = (__int64 **)sub_BCB2E0((_QWORD *)v211.m128i_i64[1]);
  v38 = (unsigned __int8 *)sub_249DCB0((__int64 *)&v204, 0x2Fu, v181, v37, (__int64)&v219, 0, (int)v199, 0);
  if ( !(_DWORD)v6 )
  {
    v179 = 0;
    v180 = 0;
    goto LABEL_53;
  }
  LOWORD(v203) = 257;
  v152 = sub_BCB2E0((_QWORD *)v211.m128i_i64[1]);
  v153 = (unsigned __int8 *)sub_ACD640(v152, 1, 0);
  v154 = *(__int64 (__fastcall **)(__int64, unsigned int, unsigned __int8 *, unsigned __int8 *))(*v212 + 16);
  if ( v154 == sub_9202E0 )
  {
    if ( *v38 > 0x15u || *v153 > 0x15u )
    {
LABEL_188:
      v222.m128i_i16[4] = 257;
      v155 = (_BYTE *)sub_B504D0(28, (__int64)v38, (__int64)v153, (__int64)&v219, 0, 0);
      (*(void (__fastcall **)(__int64, _BYTE *, _BYTE **, __int64, __int64))(*(_QWORD *)v213 + 16LL))(
        v213,
        v155,
        &v199,
        v210.m128i_i64[1],
        v211.m128i_i64[0]);
      v164 = &v204[4 * v205];
      if ( v204 != v164 )
      {
        v192 = v38;
        v165 = (__int64)v155;
        v166 = v204;
        do
        {
          v167 = *((_QWORD *)v166 + 1);
          v168 = *v166;
          v166 += 4;
          sub_B99FD0(v165, v168, v167);
        }
        while ( v164 != v166 );
        v155 = (_BYTE *)v165;
        v38 = v192;
      }
      goto LABEL_182;
    }
    if ( (unsigned __int8)sub_AC47B0(28) )
      v155 = (_BYTE *)sub_AD5570(28, (__int64)v38, v153, 0, 0);
    else
      v155 = (_BYTE *)sub_AABE40(0x1Cu, v38, v153);
  }
  else
  {
    v155 = (_BYTE *)v154((__int64)v212, 28u, v38, v153);
  }
  if ( !v155 )
    goto LABEL_188;
LABEL_182:
  v199 = v155;
  v222.m128i_i16[4] = 257;
  v156 = sub_B34A60((__int64)&v204, *(unsigned __int8 **)(a1 + 96));
  v157 = (__int64 *)sub_B2BE50(a2);
  v158 = sub_BCE3C0(v157, 0);
  v159 = sub_921130(&v204, v158, v156, &v199, 1, (__int64)&v219, 0);
  v199 = v155;
  v180 = v159;
  v222.m128i_i16[4] = 257;
  v160 = sub_B34A60((__int64)&v204, *(unsigned __int8 **)(a1 + 104));
  v161 = sub_BCB2D0((_QWORD *)v211.m128i_i64[1]);
  v179 = sub_921130(&v204, v161, v160, &v199, 1, (__int64)&v219, 0);
LABEL_53:
  LOWORD(v203) = 257;
  v39 = (__int64 *)sub_B2BE50(a2);
  v198 = 257;
  v190 = (__int64 **)sub_BCE3C0(v39, 0);
  v40 = sub_BCB2E0((_QWORD *)v211.m128i_i64[1]);
  v41 = (unsigned __int8 *)sub_ACD640(v40, -2, 0);
  v42 = *(__int64 (__fastcall **)(__int64, unsigned int, unsigned __int8 *, unsigned __int8 *))(*v212 + 16);
  if ( v42 != sub_9202E0 )
  {
    v43 = v42((__int64)v212, 28u, v38, v41);
    goto LABEL_58;
  }
  if ( *v38 <= 0x15u && *v41 <= 0x15u )
  {
    if ( (unsigned __int8)sub_AC47B0(28) )
      v43 = sub_AD5570(28, (__int64)v38, v41, 0, 0);
    else
      v43 = sub_AABE40(0x1Cu, v38, v41);
LABEL_58:
    if ( v43 )
      goto LABEL_59;
  }
  v222.m128i_i16[4] = 257;
  v43 = sub_B504D0(28, (__int64)v38, (__int64)v41, (__int64)&v219, 0, 0);
  (*(void (__fastcall **)(__int64, __int64, _BYTE **, __int64, __int64))(*(_QWORD *)v213 + 16LL))(
    v213,
    v43,
    v197,
    v210.m128i_i64[1],
    v211.m128i_i64[0]);
  v148 = v204;
  v149 = &v204[4 * v205];
  if ( v204 != v149 )
  {
    do
    {
      v150 = *((_QWORD *)v148 + 1);
      v151 = *v148;
      v148 += 4;
      sub_B99FD0(v43, v151, v150);
    }
    while ( v149 != v148 );
  }
LABEL_59:
  v178 = sub_249DCB0((__int64 *)&v204, 0x30u, v43, v190, (__int64)&v199, 0, (int)v219, 0);
  sub_B43D60(v193);
  nullsub_61();
  v215 = &unk_49DA100;
  nullsub_63();
  if ( v204 != (unsigned int *)&v207 )
    _libc_free((unsigned __int64)v204);
  if ( v181 )
  {
    v182 = *(_QWORD *)(a2 + 80);
    if ( v182 == v177 )
    {
      v79 = 1;
LABEL_98:
      v175 = v79 & (v176 != 0);
      if ( v175 )
      {
        v145 = sub_B2BE50(a2);
        v146 = sub_BD5D20(a2);
        v222.m128i_i16[4] = 1283;
        v219 = (unsigned int *)"[ctx_prof] An entrypoint was instrumented but it has no `ret` instructions above which to"
                               " release the context: ";
        v221 = v146;
        v222.m128i_i64[0] = v147;
        sub_B6ECE0(v145, (__int64)&v219);
      }
      else
      {
        return 1;
      }
      return v175;
    }
    while ( 1 )
    {
      if ( !v182 )
        BUG();
      v44 = *(_QWORD *)(v182 + 32);
      v195 = v182 + 24;
      if ( v182 + 24 != v44 )
        break;
LABEL_96:
      v182 = *(_QWORD *)(v182 + 8);
      if ( v182 == v177 )
      {
        v79 = v175 ^ 1;
        goto LABEL_98;
      }
    }
    while ( 1 )
    {
      v46 = v44;
      v44 = *(_QWORD *)(v44 + 8);
      v47 = *(_BYTE *)(v46 - 24);
      v48 = (_QWORD *)(v46 - 24);
      if ( v47 != 85 )
      {
        v45 = v176 != 0 && v47 == 30;
        if ( v45 )
        {
          sub_23D0AB0((__int64)&v219, (__int64)v48, 0, 0, 0);
          v208.m128i_i16[4] = 257;
          v143 = 0;
          v199 = v176;
          v144 = *(_QWORD *)(a1 + 88);
          if ( v144 )
            v143 = *(_QWORD *)(v144 + 24);
          sub_921880(&v219, v143, v144, (int)&v199, 1, (__int64)&v204, 0);
          nullsub_61();
          v229 = &unk_49DA100;
          nullsub_63();
          if ( v219 != (unsigned int *)&v221 )
            _libc_free((unsigned __int64)v219);
          v175 = v45;
        }
        goto LABEL_67;
      }
      v49 = *(_QWORD *)(v46 - 56);
      if ( !v49 || *(_BYTE *)v49 || *(_QWORD *)(v49 + 24) != *(_QWORD *)(v46 + 56) || (*(_BYTE *)(v49 + 33) & 0x20) == 0 )
        goto LABEL_67;
      v50 = *(_DWORD *)(v49 + 36);
      if ( v50 > 0xC7 )
      {
        if ( v50 - 202 > 1 )
          goto LABEL_67;
LABEL_75:
        sub_23D0AB0((__int64)&v219, v46 - 24, 0, 0, 0);
        v51 = *(_QWORD *)(v46 - 56);
        if ( !v51 || *(_BYTE *)v51 || *(_QWORD *)(v51 + 24) != *(_QWORD *)(v46 + 56) )
          BUG();
        v52 = *(_DWORD *)(v51 + 36);
        if ( v52 != 196 )
        {
          if ( (unsigned int)(v52 - 198) > 1 )
            goto LABEL_94;
          v208.m128i_i16[4] = 257;
          v53 = sub_BCB2D0((_QWORD *)v225.m128i_i64[1]);
          v199 = (_BYTE *)sub_ACD640(v53, 0, 0);
          v54 = sub_BCB2D0((_QWORD *)v225.m128i_i64[1]);
          v200 = sub_ACD640(v54, 1, 0);
          v201 = sub_B59BC0(v46 - 24);
          v55 = sub_921130(&v219, v183, v178, &v199, 3, (__int64)&v204, 0);
          LOWORD(v203) = 257;
          v191 = v55;
          v56 = sub_B59CA0(v46 - 24);
          v198 = 257;
          v184 = (unsigned __int8 *)v56;
          v57 = sub_BCB2E0((_QWORD *)v225.m128i_i64[1]);
          v58 = sub_AA4E30(v224.m128i_i64[0]);
          v59 = sub_AE5020(v58, v57);
          HIBYTE(v60) = HIBYTE(v187);
          v208.m128i_i16[4] = 257;
          LOBYTE(v60) = v59;
          v187 = v60;
          v61 = (unsigned __int8 *)sub_BD2C40(80, unk_3F10A14);
          v62 = v61;
          if ( v61 )
            sub_B4D190((__int64)v61, v57, v191, (__int64)&v204, 0, v187, 0, 0);
          (*(void (__fastcall **)(__int64, unsigned __int8 *, _BYTE **, __int64, __int64))(*(_QWORD *)v227 + 16LL))(
            v227,
            v62,
            v197,
            v224.m128i_i64[1],
            v225.m128i_i64[0]);
          v63 = v219;
          v64 = &v219[4 * (unsigned int)v220];
          if ( v219 != v64 )
          {
            do
            {
              v65 = *((_QWORD *)v63 + 1);
              v66 = *v63;
              v63 += 4;
              sub_B99FD0((__int64)v62, v66, v65);
            }
            while ( v64 != v63 );
          }
          v67 = *(__int64 (__fastcall **)(__int64, unsigned int, unsigned __int8 *, unsigned __int8 *, unsigned __int8, char))(*v226 + 32);
          if ( v67 == sub_9201A0 )
          {
            if ( *v62 > 0x15u || *v184 > 0x15u )
              goto LABEL_162;
            v68 = (unsigned __int8)sub_AC47B0(13)
                ? sub_AD5570(13, (__int64)v62, v184, 0, 0)
                : sub_AABE40(0xDu, v62, v184);
LABEL_89:
            if ( !v68 )
            {
LABEL_162:
              v208.m128i_i16[4] = 257;
              v68 = sub_B504D0(13, (__int64)v62, (__int64)v184, (__int64)&v204, 0, 0);
              (*(void (__fastcall **)(__int64, __int64, _BYTE **, __int64, __int64))(*(_QWORD *)v227 + 16LL))(
                v227,
                v68,
                &v199,
                v224.m128i_i64[1],
                v225.m128i_i64[0]);
              v139 = v219;
              v140 = &v219[4 * (unsigned int)v220];
              if ( v219 != v140 )
              {
                do
                {
                  v141 = *((_QWORD *)v139 + 1);
                  v142 = *v139;
                  v139 += 4;
                  sub_B99FD0(v68, v142, v141);
                }
                while ( v140 != v139 );
              }
            }
            v69 = sub_AA4E30(v224.m128i_i64[0]);
            v70 = sub_AE5020(v69, *(_QWORD *)(v68 + 8));
            v208.m128i_i16[4] = 257;
            v71 = v70;
            v72 = sub_BD2C40(80, unk_3F10A10);
            v74 = (__int64)v72;
            if ( v72 )
            {
              sub_B4D3C0((__int64)v72, v68, v191, 0, v71, v73, 0, 0);
              v73 = v172;
            }
            (*(void (__fastcall **)(__int64, __int64, unsigned int **, __int64, __int64, __int64))(*(_QWORD *)v227 + 16LL))(
              v227,
              v74,
              &v204,
              v224.m128i_i64[1],
              v225.m128i_i64[0],
              v73);
            v75 = v219;
            v76 = &v219[4 * (unsigned int)v220];
            if ( v219 != v76 )
            {
              do
              {
                v77 = *((_QWORD *)v75 + 1);
                v78 = *v75;
                v75 += 4;
                sub_B99FD0(v74, v78, v77);
              }
              while ( v76 != v75 );
            }
            goto LABEL_94;
          }
          v68 = v67((__int64)v226, 13u, v62, v184, 0, 0);
          goto LABEL_89;
        }
        v116 = sub_B59D20(v46 - 24);
        v117 = sub_AA4E30(v224.m128i_i64[0]);
        v118 = sub_AE5020(v117, *(_QWORD *)(v116 + 8));
        v208.m128i_i16[4] = 257;
        v119 = v118;
        v120 = sub_BD2C40(80, unk_3F10A10);
        v122 = (__int64)v120;
        if ( v120 )
          sub_B4D3C0((__int64)v120, v116, v180, 1, v119, v121, 0, 0);
        (*(void (__fastcall **)(__int64, __int64, unsigned int **, __int64, __int64))(*(_QWORD *)v227 + 16LL))(
          v227,
          v122,
          &v204,
          v224.m128i_i64[1],
          v225.m128i_i64[0]);
        v123 = v219;
        v124 = &v219[4 * (unsigned int)v220];
        if ( v219 != v124 )
        {
          do
          {
            v125 = *((_QWORD *)v123 + 1);
            v126 = *v123;
            v123 += 4;
            sub_B99FD0(v122, v126, v125);
          }
          while ( v124 != v123 );
        }
        LOWORD(v203) = 257;
        v127 = sub_BCB2D0((_QWORD *)v225.m128i_i64[1]);
        v197[0] = (_BYTE *)sub_ACD640(v127, 0, 0);
        v128 = sub_BCB2D0((_QWORD *)v225.m128i_i64[1]);
        v197[1] = (_BYTE *)sub_ACD640(v128, 2, 0);
        v197[2] = (_BYTE *)sub_B59BC0((__int64)v48);
        v129 = sub_921130(&v219, v183, v181, v197, 3, (__int64)&v199, 0);
        v130 = sub_AA4E30(v224.m128i_i64[0]);
        v131 = sub_AE5020(v130, *(_QWORD *)(v129 + 8));
        HIBYTE(v132) = HIBYTE(v188);
        LOBYTE(v132) = v131;
        v208.m128i_i16[4] = 257;
        v188 = v132;
        v134 = sub_BD2C40(80, unk_3F10A10);
        if ( v134 )
          sub_B4D3C0((__int64)v134, v129, v179, 1, v188, v133, 0, 0);
        (*(void (__fastcall **)(__int64, _QWORD *, unsigned int **, __int64, __int64))(*(_QWORD *)v227 + 16LL))(
          v227,
          v134,
          &v204,
          v224.m128i_i64[1],
          v225.m128i_i64[0]);
        v135 = v219;
        v136 = &v219[4 * (unsigned int)v220];
        if ( v219 != v136 )
        {
          do
          {
            v137 = *((_QWORD *)v135 + 1);
            v138 = *v135;
            v135 += 4;
            sub_B99FD0((__int64)v134, v138, v137);
          }
          while ( v136 != v135 );
        }
LABEL_94:
        sub_B43D60(v48);
        nullsub_61();
        v229 = &unk_49DA100;
        nullsub_63();
        if ( v219 == (unsigned int *)&v221 )
          goto LABEL_67;
        _libc_free((unsigned __int64)v219);
        if ( v195 == v44 )
          goto LABEL_96;
      }
      else
      {
        if ( v50 > 0xC3 )
          goto LABEL_75;
LABEL_67:
        if ( v195 == v44 )
          goto LABEL_96;
      }
    }
  }
LABEL_105:
  v81 = *(_QWORD *)(v196 + 8);
  v82 = sub_B2BE50(v81);
  if ( sub_B6EA50(v82)
    || (v170 = sub_B2BE50(v81),
        v171 = sub_B6F970(v170),
        (*(unsigned __int8 (__fastcall **)(__int64))(*(_QWORD *)v171 + 48LL))(v171)) )
  {
    sub_B17770((__int64)&v219, (__int64)"ctx-instr-lower", (__int64)"Skip", 4, a2);
    sub_B18290((__int64)&v219, "Function doesn't have instrumentation, skipping", 0x2Fu);
    v87 = _mm_loadu_si128(&v222);
    v88 = _mm_loadu_si128(&v224);
    v205 = (int)v220;
    v89 = _mm_loadu_si128(&v225);
    v90 = v227;
    v208 = v87;
    v206 = BYTE4(v220);
    v210 = v88;
    v207 = v221;
    v204 = (unsigned int *)&unk_49D9D40;
    v211 = v89;
    v209 = v223;
    v212 = (unsigned __int64 *)v214;
    v213 = 0x400000000LL;
    if ( (_DWORD)v227 )
    {
      v109 = (__m128i *)v214;
      v110 = (unsigned int)v227;
      if ( (unsigned int)v227 > 4 )
      {
        sub_11F02D0((__int64)&v212, (unsigned int)v227, v83, v84, v85, v86);
        v109 = (__m128i *)v212;
        v110 = (unsigned int)v227;
      }
      v111 = v226;
      v112 = &v226[10 * v110];
      v113 = v226;
      if ( v226 != v112 )
      {
        v114 = v109;
        do
        {
          if ( v114 )
          {
            v114->m128i_i64[0] = (__int64)v114[1].m128i_i64;
            sub_249DC00(v114->m128i_i64, (_BYTE *)*v113, *v113 + v113[1]);
            v114[2].m128i_i64[0] = (__int64)v114[3].m128i_i64;
            sub_249DC00(v114[2].m128i_i64, (_BYTE *)v113[4], v113[4] + v113[5]);
            v114[4] = _mm_loadu_si128((const __m128i *)v113 + 4);
          }
          v113 += 10;
          v114 += 5;
        }
        while ( v112 != v113 );
        v111 = v226;
      }
      LODWORD(v213) = v90;
      v216 = v230;
      v217 = v231;
      v218 = v232;
      v204 = (unsigned int *)&unk_49D9DB0;
      v219 = (unsigned int *)&unk_49D9D40;
      v91 = &v111[10 * (unsigned int)v227];
      if ( v111 != v91 )
      {
        do
        {
          v91 -= 10;
          v115 = v91[4];
          if ( (unsigned __int64 *)v115 != v91 + 6 )
            j_j___libc_free_0(v115);
          if ( (unsigned __int64 *)*v91 != v91 + 2 )
            j_j___libc_free_0(*v91);
        }
        while ( v111 != v91 );
        v91 = v226;
      }
    }
    else
    {
      v91 = v226;
      v216 = v230;
      v217 = v231;
      v218 = v232;
      v204 = (unsigned int *)&unk_49D9DB0;
    }
    if ( v91 != (unsigned __int64 *)v228 )
      _libc_free((unsigned __int64)v91);
    sub_1049740(v194, (__int64)&v204);
    v92 = v212;
    v204 = (unsigned int *)&unk_49D9D40;
    v93 = &v212[10 * (unsigned int)v213];
    if ( v212 != v93 )
    {
      do
      {
        v93 -= 10;
        v94 = v93[4];
        if ( (unsigned __int64 *)v94 != v93 + 6 )
          j_j___libc_free_0(v94);
        if ( (unsigned __int64 *)*v93 != v93 + 2 )
          j_j___libc_free_0(*v93);
      }
      while ( v92 != v93 );
      v93 = v212;
    }
    if ( v93 != (unsigned __int64 *)v214 )
      _libc_free((unsigned __int64)v93);
  }
  return v175;
}

// Function: sub_31E9900
// Address: 0x31e9900
//
void __fastcall sub_31E9900(__int64 a1, __int64 a2, __int64 a3, _BYTE *a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r14
  __int64 v7; // r13
  char v10; // r15
  __int64 v11; // rax
  const char *v12; // rdx
  unsigned __int64 v13; // rcx
  unsigned __int8 v14; // al
  __int64 v15; // r13
  __int64 v16; // rsi
  unsigned __int64 v17; // r13
  __int64 v18; // rax
  _BYTE *v19; // rdx
  _BYTE *v20; // rax
  __int64 v21; // rax
  const char *v22; // rdx
  unsigned __int64 v23; // r14
  __int64 v24; // rcx
  __int64 v25; // rdi
  __int64 v26; // r8
  __int64 v27; // r9
  __int64 v28; // rdx
  _QWORD *v29; // rsi
  __int64 v30; // r13
  __int64 *v31; // rsi
  int v32; // eax
  unsigned __int8 v33; // r15
  __int64 v34; // r13
  __int64 v35; // rax
  const char *v36; // rdx
  unsigned __int64 v37; // rax
  unsigned int v38; // r13d
  unsigned int v39; // r15d
  char *i; // rbx
  int v41; // eax
  unsigned __int8 v42; // r15
  __int64 v43; // r13
  char v44; // bl
  __int64 v45; // rax
  const char *v46; // rdx
  __int64 v47; // rax
  __int64 v48; // r15
  char v49; // r13
  __int64 v50; // rax
  const char *v51; // rdx
  __int64 v52; // r15
  char v53; // r13
  __int64 v54; // rax
  const char *v55; // rdx
  int v56; // eax
  __int64 v57; // r10
  __int64 v58; // rsi
  int v59; // ebx
  __int64 v60; // rax
  __int64 v61; // rdx
  __int64 v62; // rbx
  __int64 v63; // r13
  unsigned __int64 v64; // rdx
  char v65; // al
  __int64 v66; // r14
  __int64 v67; // r13
  char v68; // r15
  __int64 v69; // rax
  const char *v70; // rdx
  __int64 v71; // r13
  unsigned int v72; // eax
  __int64 v73; // r13
  __int64 v74; // r15
  __int64 v75; // rbx
  __int64 v76; // rax
  const char *v77; // rdx
  __int64 v78; // rsi
  __int64 v79; // rbx
  char v80; // al
  __int64 v81; // rdx
  char v82; // al
  __int64 v83; // rax
  __int64 v84; // r12
  void (__fastcall *v85)(__int64, __int64); // r13
  __int64 v86; // rax
  unsigned int v87; // eax
  __int64 v88; // r15
  __int64 v89; // rdi
  __int64 j; // rbx
  __int64 v91; // rax
  const char *v92; // rdx
  unsigned int v93; // r13d
  unsigned int v94; // r15d
  unsigned int v95; // r14d
  __int64 v96; // rax
  __int64 v97; // r9
  unsigned int v98; // esi
  __int64 v99; // rax
  __int64 v100; // rax
  __int64 v101; // r10
  int *v102; // r15
  __int64 v103; // r8
  unsigned int v104; // ecx
  __int64 v105; // rdi
  int v106; // edx
  unsigned int k; // eax
  _QWORD *v108; // rsi
  __int64 v109; // rax
  __int64 v110; // rbx
  __int64 v111; // rdx
  __int64 v112; // rcx
  __int64 v113; // r8
  __int64 v114; // r9
  __int64 v115; // rax
  _BYTE *v116; // rsi
  int v117; // r14d
  __int64 v118; // rax
  __int64 v119; // rcx
  __int64 v120; // r8
  __int64 v121; // r9
  __int64 v122; // rdx
  __int64 v123; // rdi
  __int64 (*v124)(); // rax
  int v125; // r14d
  __int64 v126; // rax
  unsigned int v127; // eax
  __int64 v128; // [rsp+8h] [rbp-B8h]
  __int64 v129; // [rsp+10h] [rbp-B0h]
  unsigned int v130; // [rsp+18h] [rbp-A8h]
  void *v131; // [rsp+20h] [rbp-A0h]
  __int64 v132; // [rsp+20h] [rbp-A0h]
  int v133; // [rsp+28h] [rbp-98h]
  __int64 v134; // [rsp+30h] [rbp-90h]
  __int64 v135; // [rsp+30h] [rbp-90h]
  __int64 v136; // [rsp+30h] [rbp-90h]
  __int64 v137; // [rsp+38h] [rbp-88h]
  __int64 v138; // [rsp+38h] [rbp-88h]
  __int64 v139; // [rsp+38h] [rbp-88h]
  __int64 v140; // [rsp+38h] [rbp-88h]
  __int64 v141; // [rsp+38h] [rbp-88h]
  int v142; // [rsp+38h] [rbp-88h]
  __int64 v143; // [rsp+38h] [rbp-88h]
  __int64 v144; // [rsp+40h] [rbp-80h]
  unsigned int v145; // [rsp+40h] [rbp-80h]
  __int64 v146; // [rsp+40h] [rbp-80h]
  __int64 v147; // [rsp+40h] [rbp-80h]
  char v148; // [rsp+40h] [rbp-80h]
  __int64 v149; // [rsp+40h] [rbp-80h]
  char v151; // [rsp+48h] [rbp-78h]
  unsigned int v152; // [rsp+48h] [rbp-78h]
  __int64 v153; // [rsp+48h] [rbp-78h]
  __int64 v154; // [rsp+48h] [rbp-78h]
  void (__fastcall *v155)(__int64, __int64, _QWORD); // [rsp+48h] [rbp-78h]
  __int64 v156; // [rsp+48h] [rbp-78h]
  __int64 v157; // [rsp+48h] [rbp-78h]
  __int64 v158; // [rsp+58h] [rbp-68h]
  int v159; // [rsp+58h] [rbp-68h]
  __int64 v160; // [rsp+58h] [rbp-68h]
  __int64 v161; // [rsp+58h] [rbp-68h]
  __int64 v162; // [rsp+60h] [rbp-60h] BYREF
  char v163; // [rsp+68h] [rbp-58h]
  unsigned __int64 v164; // [rsp+70h] [rbp-50h] BYREF
  const char *v165; // [rsp+78h] [rbp-48h]
  __int64 v166; // [rsp+80h] [rbp-40h]
  int v167; // [rsp+88h] [rbp-38h]

  v6 = a1;
  v7 = a5;
  v158 = a6;
  sub_31DB520(a3, a5, a6);
  while ( 1 )
  {
    v144 = *(_QWORD *)(a2 + 8);
    v10 = sub_AE5020(a1, v144);
    v11 = sub_9208B0(a1, v144);
    v165 = v12;
    v164 = ((1LL << v10) + ((unsigned __int64)(v11 + 7) >> 3) - 1) >> v10 << v10;
    v13 = sub_CA1930(&v164);
    if ( !a4 )
    {
      v18 = *(_QWORD *)(a2 + 16);
      if ( v18 )
      {
        v19 = *(_BYTE **)(v18 + 8);
        if ( !v19 )
        {
          v20 = *(_BYTE **)(v18 + 24);
          if ( *v20 < 0x16u )
            v19 = v20;
          a4 = v19;
        }
      }
    }
    v14 = *(_BYTE *)a2;
    if ( *(_BYTE *)a2 == 14 )
    {
      v57 = v7;
      v15 = v13;
      if ( v158 )
      {
        v58 = *(_QWORD *)(a2 + 8);
        if ( *(_BYTE *)(v58 + 8) == 15 )
        {
          v59 = *(_DWORD *)(v58 + 12);
          if ( v59 )
          {
            v146 = v57;
            v60 = sub_AE4AC0(a1, v58);
            if ( v59 == 1 )
            {
              v62 = 0;
            }
            else
            {
              v61 = (unsigned int)(v59 - 2);
              v138 = v15;
              v62 = 0;
              v63 = v60 + 40;
              v153 = v60 + 16 * v61 + 56;
              do
              {
                v64 = *(_QWORD *)v63;
                v65 = *(_BYTE *)(v63 + 8);
                v66 = v62;
                v63 += 16;
                v164 = v64;
                LOBYTE(v165) = v65;
                v62 = sub_CA1930(&v164);
                sub_E99300(*(_QWORD ***)(a3 + 224), v62 - v66);
                sub_31DB520(a3, v62 + v146, v158);
              }
              while ( v153 != v63 );
              v15 = v138;
            }
            sub_E99300(*(_QWORD ***)(a3 + 224), v15 - v62);
            return;
          }
        }
      }
LABEL_6:
      sub_E99300(*(_QWORD ***)(a3 + 224), v15);
      return;
    }
    if ( (unsigned int)v14 - 12 <= 1 )
    {
      v15 = v13;
      goto LABEL_6;
    }
    switch ( v14 )
    {
      case 0x11u:
        v16 = *(_QWORD *)(a2 + 8);
        v17 = v13;
        if ( (unsigned int)*(unsigned __int8 *)(v16 + 8) - 17 > 1 )
        {
          v21 = sub_9208B0(a1, v16);
          v165 = v22;
          v164 = (unsigned __int64)(v21 + 7) >> 3;
          v23 = sub_CA1930(&v164);
          if ( v23 > 8 )
          {
            sub_31DA950(a2, a3);
          }
          else
          {
            if ( *(_BYTE *)(a3 + 488) )
            {
              v25 = (*(__int64 (__fastcall **)(_QWORD))(**(_QWORD **)(a3 + 224) + 128LL))(*(_QWORD *)(a3 + 224));
              if ( *(_DWORD *)(a2 + 32) <= 0x40u )
                v28 = *(_QWORD *)(a2 + 24);
              else
                v28 = **(_QWORD **)(a2 + 24);
              v166 = v28;
              v165 = "0x%lx\n";
              v164 = (unsigned __int64)&unk_49DC5C0;
              sub_CB6620(v25, (__int64)&v164, v28, v24, v26, v27);
            }
            v29 = *(_QWORD **)(a2 + 24);
            if ( *(_DWORD *)(a2 + 32) > 0x40u )
              v29 = (_QWORD *)*v29;
            (*(void (__fastcall **)(_QWORD, _QWORD *, _QWORD))(**(_QWORD **)(a3 + 224) + 536LL))(
              *(_QWORD *)(a3 + 224),
              v29,
              (unsigned int)v23);
          }
          if ( v17 != v23 )
            sub_E99300(*(_QWORD ***)(a3 + 224), v17 - v23);
          return;
        }
LABEL_9:
        sub_31EFFA0(a1, a2, a3, v158);
        return;
      case 0x12u:
        v30 = *(_QWORD *)(a2 + 8);
        if ( (unsigned int)*(unsigned __int8 *)(v30 + 8) - 17 > 1 )
        {
          v31 = (__int64 *)(a2 + 24);
          if ( *(void **)(a2 + 24) == sub_C33340() )
            sub_C3C790(&v164, (_QWORD **)v31);
          else
            sub_C33EB0(&v164, v31);
          sub_31DABF0((__int64 *)&v164, v30, a3);
          sub_91D830(&v164);
          return;
        }
        goto LABEL_9;
      case 0x14u:
        (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD))(**(_QWORD **)(a3 + 224) + 536LL))(
          *(_QWORD *)(a3 + 224),
          0,
          (unsigned int)v13);
        return;
    }
    if ( (unsigned int)v14 - 15 <= 1 )
    {
      v32 = sub_31D9E60((unsigned __int8 *)a2, a1);
      v33 = v32;
      if ( v32 == -1
        || (v34 = *(_QWORD *)(a2 + 8),
            v151 = sub_AE5020(a1, v34),
            v35 = sub_9208B0(a1, v34),
            v165 = v36,
            v164 = ((1LL << v151) + ((unsigned __int64)(v35 + 7) >> 3) - 1) >> v151 << v151,
            v37 = sub_CA1930(&v164),
            v37 <= 1) )
      {
        if ( (unsigned __int8)sub_AC5570(a2, 8u) )
        {
          v84 = *(_QWORD *)(a3 + 224);
          v85 = *(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v84 + 512LL);
          v86 = sub_AC52D0(a2);
          v85(v84, v86);
        }
        else
        {
          v145 = sub_AC52A0(a2);
          if ( *(_BYTE *)(sub_AC5230(a2) + 8) == 12 )
          {
            v93 = 0;
            v94 = 0;
            v142 = sub_AC5290(a2);
            if ( v142 )
            {
              v95 = v145;
              do
              {
                sub_31DB520(a3, v93, v158);
                if ( *(_BYTE *)(a3 + 488) )
                {
                  v154 = (*(__int64 (__fastcall **)(_QWORD))(**(_QWORD **)(a3 + 224) + 128LL))(*(_QWORD *)(a3 + 224));
                  v96 = sub_AC5320(a2, v94);
                  v165 = "0x%lx\n";
                  v166 = v96;
                  v164 = (unsigned __int64)&unk_49DC5C0;
                  sub_CB6620(v154, (__int64)&v164, (__int64)&unk_49DC5C0, (__int64)"0x%lx\n", v154, v97);
                }
                v98 = v94++;
                v93 += v95;
                v149 = *(_QWORD *)(a3 + 224);
                v155 = *(void (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)v149 + 536LL);
                v99 = sub_AC5320(a2, v98);
                v155(v149, v99, v95);
              }
              while ( v142 != v94 );
              v6 = a1;
            }
          }
          else
          {
            v134 = sub_AC5230(a2);
            v133 = sub_AC5290(a2);
            if ( v133 )
            {
              v38 = 0;
              v39 = 0;
              v131 = sub_C33340();
              v137 = a2;
              do
              {
                sub_31DB520(a3, v38, v158);
                sub_AC5470((__int64)&v164, v137, v39);
                sub_31DABF0((__int64 *)&v164, v134, a3);
                if ( (void *)v164 == v131 )
                {
                  if ( v165 )
                  {
                    for ( i = (char *)&v165[24 * *((_QWORD *)v165 - 1)]; v165 != i; sub_91D830(i) )
                      i -= 24;
                    j_j_j___libc_free_0_0((unsigned __int64)(i - 8));
                  }
                }
                else
                {
                  sub_C338F0((__int64)&v164);
                }
                ++v39;
                v38 += v145;
              }
              while ( v133 != v39 );
              a2 = v137;
            }
          }
          v48 = *(_QWORD *)(a2 + 8);
          v49 = sub_AE5020(v6, v48);
          v50 = sub_9208B0(v6, v48);
          v165 = v51;
          v164 = ((1LL << v49) + ((unsigned __int64)(v50 + 7) >> 3) - 1) >> v49 << v49;
          v159 = sub_CA1930(&v164);
          v152 = sub_AC5290(a2);
          v52 = sub_AC5230(a2);
          v53 = sub_AE5020(v6, v52);
          v54 = sub_9208B0(v6, v52);
          v165 = v55;
          v164 = v152 * (((1LL << v53) + ((unsigned __int64)(v54 + 7) >> 3) - 1) >> v53 << v53);
          v56 = sub_CA1930(&v164);
          if ( v159 != v56 )
            sub_E99300(*(_QWORD ***)(a3 + 224), (unsigned int)(v159 - v56));
        }
      }
      else
      {
        sub_E99280(*(_QWORD ***)(a3 + 224), v37, v33);
      }
      return;
    }
    if ( v14 == 9 )
    {
      v41 = sub_31D9E60((unsigned __int8 *)a2, a1);
      v42 = v41;
      if ( v41 == -1 )
      {
        v87 = *(_DWORD *)(a2 + 4) & 0x7FFFFFF;
        if ( v87 )
        {
          v88 = v7;
          v136 = v87 - 1;
          v89 = a2;
          for ( j = 0; ; ++j )
          {
            sub_31E9900(v6, *(_QWORD *)(v89 + 32 * (j - v87)), a3, a4, v88, v158);
            v141 = *(_QWORD *)(*(_QWORD *)(v89 + 32 * (j - (*(_DWORD *)(v89 + 4) & 0x7FFFFFF))) + 8LL);
            v148 = sub_AE5020(v6, v141);
            v91 = sub_9208B0(v6, v141);
            v165 = v92;
            v164 = ((1LL << v148) + ((unsigned __int64)(v91 + 7) >> 3) - 1) >> v148 << v148;
            v88 += sub_CA1930(&v164);
            if ( v136 == j )
              break;
            v87 = *(_DWORD *)(v89 + 4) & 0x7FFFFFF;
          }
        }
      }
      else
      {
        v43 = *(_QWORD *)(a2 + 8);
        v44 = sub_AE5020(a1, v43);
        v45 = sub_9208B0(a1, v43);
        v165 = v46;
        v164 = ((1LL << v44) + ((unsigned __int64)(v45 + 7) >> 3) - 1) >> v44 << v44;
        v47 = sub_CA1930(&v164);
        sub_E99280(*(_QWORD ***)(a3 + 224), v47, v42);
      }
      return;
    }
    if ( v14 == 10 )
    {
      v139 = v7;
      v67 = *(_QWORD *)(a2 + 8);
      v68 = sub_AE5020(a1, v67);
      v69 = sub_9208B0(a1, v67);
      v165 = v70;
      v164 = ((1LL << v68) + ((unsigned __int64)(v69 + 7) >> 3) - 1) >> v68 << v68;
      v132 = sub_CA1930(&v164);
      v71 = sub_AE4AC0(a1, *(_QWORD *)(a2 + 8));
      v72 = *(_DWORD *)(a2 + 4) & 0x7FFFFFF;
      if ( v72 )
      {
        v73 = v71 + 24;
        v74 = 0;
        v130 = v72 - 1;
        v129 = v72 - 1;
        v147 = 0;
        v135 = a2;
        v128 = v139;
        while ( 1 )
        {
          v75 = *(_QWORD *)(v135 + 32 * (v74 - v72));
          sub_31E9900(a1, v75, a3, a4, v128 + v147, v158);
          v140 = *(_QWORD *)(v75 + 8);
          LOBYTE(v75) = sub_AE5020(a1, v140);
          v76 = sub_9208B0(a1, v140);
          v165 = v77;
          v164 = ((1LL << v75) + ((unsigned __int64)(v76 + 7) >> 3) - 1) >> v75 << v75;
          v78 = v132;
          v79 = sub_CA1930(&v164);
          if ( v130 != (_DWORD)v74 )
          {
            v80 = *(_BYTE *)(v73 + 24);
            v164 = *(_QWORD *)(v73 + 16);
            LOBYTE(v165) = v80;
            v78 = sub_CA1930(&v164);
          }
          v81 = *(_QWORD *)v73;
          v82 = *(_BYTE *)(v73 + 8);
          v73 += 16;
          v162 = v81;
          v163 = v82;
          v83 = sub_CA1930(&v162);
          v147 += v78 - v83;
          sub_E99300(*(_QWORD ***)(a3 + 224), v78 - v83 - v79);
          if ( v74 == v129 )
            break;
          ++v74;
          v72 = *(_DWORD *)(v135 + 4) & 0x7FFFFFF;
        }
      }
      return;
    }
    if ( v14 != 5 )
    {
      v101 = v7;
      goto LABEL_90;
    }
    if ( *(_WORD *)(a2 + 2) == 49 )
    {
      v100 = *(_QWORD *)(a2 - 32LL * (*(_DWORD *)(a2 + 4) & 0x7FFFFFF));
      goto LABEL_88;
    }
    if ( v13 <= 8 )
    {
      v101 = v7;
      goto LABEL_91;
    }
    v100 = sub_97B670((_BYTE *)a2, a1, 0);
    if ( v100 == a2 )
      break;
LABEL_88:
    v158 = 0;
    a2 = v100;
    v7 = 0;
    a4 = 0;
    sub_31DB520(a3, 0, 0);
  }
  v101 = v7;
  v14 = *(_BYTE *)a2;
LABEL_90:
  if ( v14 == 11 )
    goto LABEL_9;
LABEL_91:
  v160 = v101;
  v102 = (int *)(*(__int64 (__fastcall **)(__int64, __int64))(*(_QWORD *)a3 + 240LL))(a3, a2);
  if ( *(_BYTE *)(sub_31DA6B0(a3) + 936) )
  {
    v164 = 0;
    v165 = 0;
    v166 = 0;
    v167 = 0;
    if ( (unsigned __int8)sub_E81950(v102, (__int64)&v164, 0, 0) )
    {
      if ( v164 )
      {
        v103 = *(_QWORD *)(v164 + 16);
        v104 = *(_DWORD *)(a3 + 376);
        v105 = *(_QWORD *)(a3 + 360);
        v162 = v103;
        if ( v104 )
        {
          v106 = 1;
          for ( k = (v104 - 1) & (((unsigned int)v103 >> 4) ^ ((unsigned int)v103 >> 9)); ; k = (v104 - 1) & v127 )
          {
            v108 = (_QWORD *)(v105 + 16LL * k);
            if ( v103 == *v108 )
              break;
            if ( *v108 == -4096 )
              goto LABEL_92;
            v127 = v106 + k;
            ++v106;
          }
          if ( v108 != (_QWORD *)(v105 + 16LL * v104) )
          {
            if ( a4 )
            {
              if ( *a4 <= 3u )
              {
                v109 = sub_31DB510(a3, (__int64)a4);
                if ( v165 )
                {
                  if ( v109 == *((_QWORD *)v165 + 2) )
                  {
                    v110 = v166 + v160;
                    if ( *(_BYTE *)(sub_31DA6B0(a3) + 937) == 1 || !v110 )
                    {
                      v156 = v160;
                      v115 = sub_31E7750(a3 + 352, &v162, v111, v112, v113, v114);
                      v116 = *(_BYTE **)(*(_QWORD *)v115 - 32LL);
                      v161 = *(_QWORD *)v115;
                      v117 = *(_DWORD *)(v115 + 8);
                      if ( *v116 > 3u )
                        v116 = 0;
                      v143 = v156;
                      v102 = 0;
                      v157 = sub_31DB510(a3, (__int64)v116);
                      v118 = sub_31DA6B0(a3);
                      v122 = v157;
                      v123 = v118;
                      v124 = *(__int64 (**)())(*(_QWORD *)v118 + 208LL);
                      if ( v124 != sub_302E480 )
                        v102 = (int *)((__int64 (__fastcall *)(__int64, _BYTE *, __int64, unsigned __int64 *, __int64, _QWORD, _QWORD, __int64))v124)(
                                        v123,
                                        v116,
                                        v157,
                                        &v164,
                                        v143,
                                        *(_QWORD *)(a3 + 240),
                                        *(_QWORD *)(a3 + 224),
                                        v119);
                      v125 = v117 - 1;
                      if ( v125 >= 0 )
                      {
                        v126 = sub_31E7750(a3 + 352, &v162, v122, v119, v120, v121);
                        *(_DWORD *)(v126 + 8) = v125;
                        *(_QWORD *)v126 = v161;
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
LABEL_92:
  sub_E9A5B0(*(_QWORD *)(a3 + 224), (unsigned __int8 *)v102);
}

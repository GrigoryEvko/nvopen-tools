// Function: sub_1043250
// Address: 0x1043250
//
void __fastcall sub_1043250(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 *v5; // rax
  __int64 *v6; // rax
  __int64 v7; // r12
  __int64 v8; // rax
  int v9; // ebx
  _QWORD *v10; // r14
  __int64 v11; // rsi
  _QWORD *v12; // r13
  int v13; // eax
  bool v14; // zf
  _QWORD *v15; // rax
  __int64 v16; // rdx
  __int64 v17; // rdi
  __int64 v18; // r12
  __int64 *v19; // rbx
  __int64 *v20; // r14
  __int64 v21; // rsi
  _QWORD *v22; // rax
  __int64 v23; // rcx
  __int64 v24; // r8
  __int64 v25; // r9
  __int64 v26; // rdx
  __int64 v27; // rsi
  __int64 v28; // rax
  __int64 v29; // rsi
  __int64 v30; // rax
  __int64 v31; // rdi
  __int64 v32; // rax
  int v33; // esi
  __int64 v34; // rdi
  __int64 v35; // rdx
  int v36; // esi
  unsigned int v37; // ecx
  __int64 *v38; // rax
  __int64 v39; // r9
  __int64 v40; // r8
  __int64 v41; // rax
  __int64 v42; // rdi
  __int64 *v43; // rdx
  __int64 v44; // rcx
  __int64 v45; // r8
  __int64 v46; // r9
  __int64 *v47; // r13
  char v48; // di
  __int64 *v49; // r14
  __int64 v50; // rsi
  __int64 *v51; // rax
  __int64 ***v52; // r13
  __int64 v53; // r14
  __int64 v54; // rax
  __int64 v55; // rdx
  __int64 *v56; // rsi
  char v57; // cl
  __int64 *j; // r13
  __int64 v59; // r12
  __int64 *v60; // rax
  __int64 *v61; // rdx
  __int64 v62; // rax
  __int64 v63; // rsi
  __int64 v64; // rcx
  __int64 v65; // rdx
  char *v66; // rax
  __int64 v67; // rax
  int v68; // eax
  int v69; // r8d
  __int64 *v71; // [rsp+20h] [rbp-520h]
  __int64 *v72; // [rsp+30h] [rbp-510h]
  _QWORD *v73; // [rsp+38h] [rbp-508h]
  __int64 v74; // [rsp+40h] [rbp-500h]
  char v75; // [rsp+48h] [rbp-4F8h]
  __int64 v76; // [rsp+48h] [rbp-4F8h]
  __int64 *i; // [rsp+50h] [rbp-4F0h]
  __int64 v78; // [rsp+58h] [rbp-4E8h]
  __int64 *v79; // [rsp+60h] [rbp-4E0h] BYREF
  __int64 v80; // [rsp+68h] [rbp-4D8h]
  _BYTE v81[48]; // [rsp+70h] [rbp-4D0h] BYREF
  __int64 v82; // [rsp+A0h] [rbp-4A0h] BYREF
  __int64 *v83; // [rsp+A8h] [rbp-498h]
  __int64 v84; // [rsp+B0h] [rbp-490h]
  int v85; // [rsp+B8h] [rbp-488h]
  char v86; // [rsp+BCh] [rbp-484h]
  char v87; // [rsp+C0h] [rbp-480h] BYREF
  __int64 v88; // [rsp+140h] [rbp-400h] BYREF
  char *v89; // [rsp+148h] [rbp-3F8h]
  __int64 v90; // [rsp+150h] [rbp-3F0h]
  int v91; // [rsp+158h] [rbp-3E8h]
  char v92; // [rsp+15Ch] [rbp-3E4h]
  char v93; // [rsp+160h] [rbp-3E0h] BYREF
  __int64 v94[3]; // [rsp+260h] [rbp-2E0h] BYREF
  __int64 v95; // [rsp+278h] [rbp-2C8h]
  __int64 v96; // [rsp+280h] [rbp-2C0h] BYREF
  unsigned int v97; // [rsp+288h] [rbp-2B8h]
  _QWORD v98[2]; // [rsp+3C0h] [rbp-180h] BYREF
  char v99; // [rsp+3D0h] [rbp-170h]
  _BYTE *v100; // [rsp+3D8h] [rbp-168h]
  __int64 v101; // [rsp+3E0h] [rbp-160h]
  _BYTE v102[128]; // [rsp+3E8h] [rbp-158h] BYREF
  __int16 v103; // [rsp+468h] [rbp-D8h]
  _QWORD v104[2]; // [rsp+470h] [rbp-D0h] BYREF
  __int64 v105; // [rsp+480h] [rbp-C0h]
  __int64 v106; // [rsp+488h] [rbp-B8h] BYREF
  unsigned int v107; // [rsp+490h] [rbp-B0h]
  char v108; // [rsp+508h] [rbp-38h] BYREF

  *(_QWORD *)(a1 + 144) = a1 + 168;
  v5 = &v96;
  *(_QWORD *)a1 = 0;
  *(_QWORD *)(a1 + 8) = a4;
  *(_QWORD *)(a1 + 16) = 0;
  *(_QWORD *)(a1 + 24) = a2;
  *(_QWORD *)(a1 + 32) = 0;
  *(_QWORD *)(a1 + 40) = 0;
  *(_QWORD *)(a1 + 48) = 0;
  *(_DWORD *)(a1 + 56) = 0;
  *(_QWORD *)(a1 + 64) = 0;
  *(_QWORD *)(a1 + 72) = 0;
  *(_QWORD *)(a1 + 80) = 0;
  *(_DWORD *)(a1 + 88) = 0;
  *(_QWORD *)(a1 + 96) = 0;
  *(_QWORD *)(a1 + 104) = 0;
  *(_QWORD *)(a1 + 112) = 0;
  *(_DWORD *)(a1 + 120) = 0;
  *(_QWORD *)(a1 + 128) = 0;
  *(_QWORD *)(a1 + 136) = 0;
  *(_QWORD *)(a1 + 152) = 16;
  *(_DWORD *)(a1 + 160) = 0;
  *(_BYTE *)(a1 + 164) = 1;
  *(_QWORD *)(a1 + 296) = 0;
  *(_QWORD *)(a1 + 304) = 0;
  *(_QWORD *)(a1 + 312) = 0;
  *(_DWORD *)(a1 + 320) = 0;
  *(_QWORD *)(a1 + 328) = 0;
  *(_QWORD *)(a1 + 336) = 0;
  *(_QWORD *)(a1 + 344) = 0;
  *(_DWORD *)(a1 + 352) = 0;
  *(_BYTE *)(a1 + 356) = 0;
  v94[2] = 0;
  v95 = 1;
  v94[0] = a3;
  v94[1] = a3;
  do
  {
    *v5 = -4;
    v5 += 5;
    *(v5 - 4) = -3;
    *(v5 - 3) = -4;
    *(v5 - 2) = -3;
  }
  while ( v5 != v98 );
  v98[1] = 0;
  v98[0] = v104;
  v100 = v102;
  v101 = 0x400000000LL;
  v103 = 256;
  v99 = 0;
  v104[1] = 0;
  v105 = 1;
  v104[0] = &unk_49DDBE8;
  v6 = &v106;
  do
  {
    *v6 = -4096;
    v6 += 2;
  }
  while ( v6 != (__int64 *)&v108 );
  v7 = **(_QWORD **)(a2 + 32);
  v72 = *(__int64 **)(a2 + 40);
  v71 = *(__int64 **)(a2 + 32);
  v8 = sub_AA48A0(v7);
  v9 = *(_DWORD *)(a1 + 352);
  v10 = (_QWORD *)v8;
  *(_DWORD *)(a1 + 352) = v9 + 1;
  v11 = unk_3F8E4CC;
  v12 = sub_BD2C40(88, unk_3F8E4CC);
  if ( v12 )
  {
    v11 = sub_BCB120(v10);
    sub_BD35F0((__int64)v12, v11, 27);
    v13 = *((_DWORD *)v12 + 1);
    v12[4] = 0;
    v12[5] = 0;
    v12[6] = 0;
    v14 = *(_BYTE *)v12 == 26;
    v12[7] = 0;
    *((_DWORD *)v12 + 1) = v13 & 0x38000000 | 2;
    v12[8] = v7;
    v12[3] = sub_103AB40;
    v15 = v12 - 8;
    if ( v14 )
      v15 = v12 - 4;
    v12[9] = 0;
    if ( *v15 )
    {
      v16 = v15[1];
      *(_QWORD *)v15[2] = v16;
      if ( v16 )
        *(_QWORD *)(v16 + 16) = v15[2];
    }
    *v15 = 0;
    *((_DWORD *)v12 + 20) = v9;
    *((_DWORD *)v12 + 21) = -1;
  }
  v17 = *(_QWORD *)(a1 + 128);
  *(_QWORD *)(a1 + 128) = v12;
  if ( v17 )
    sub_BD72D0(v17, v11);
  v88 = 0;
  v89 = &v93;
  v90 = 32;
  v91 = 0;
  v92 = 1;
  for ( i = v71; v72 != i; ++i )
  {
    v18 = *(_QWORD *)(*i + 56);
    v74 = *i;
    v78 = *i + 48;
    if ( v18 == v78 )
      continue;
    v75 = 0;
    v19 = 0;
    v20 = 0;
    do
    {
      while ( 1 )
      {
        v21 = v18 - 24;
        if ( !v18 )
          v21 = 0;
        v22 = sub_10406B0(a1, v21, v94, 0);
        v26 = (__int64)v22;
        if ( v22 )
        {
          if ( !v20 )
          {
            v73 = v22;
            v62 = sub_10416E0(a1, v74);
            v26 = (__int64)v73;
            v20 = (__int64 *)v62;
          }
          v27 = *v20;
          v28 = *(_QWORD *)(v26 + 32);
          *(_QWORD *)(v26 + 40) = v20;
          v27 &= 0xFFFFFFFFFFFFFFF8LL;
          *(_QWORD *)(v26 + 32) = v27 | v28 & 7;
          *(_QWORD *)(v27 + 8) = v26 + 32;
          v23 = *v20 & 7 | (v26 + 32);
          *v20 = v23;
          if ( *(_BYTE *)v26 == 27 )
            break;
        }
        v18 = *(_QWORD *)(v18 + 8);
        if ( v78 == v18 )
          goto LABEL_27;
      }
      if ( !v19 )
      {
        v76 = v26;
        v67 = sub_1041AC0(a1, v74);
        v26 = v76;
        v19 = (__int64 *)v67;
      }
      v29 = *v19;
      v30 = *(_QWORD *)(v26 + 48);
      *(_QWORD *)(v26 + 56) = v19;
      v75 = 1;
      v29 &= 0xFFFFFFFFFFFFFFF8LL;
      *(_QWORD *)(v26 + 48) = v29 | v30 & 7;
      *(_QWORD *)(v29 + 8) = v26 + 48;
      v23 = *v19 & 7 | (v26 + 48);
      *v19 = v23;
      v18 = *(_QWORD *)(v18 + 8);
    }
    while ( v78 != v18 );
LABEL_27:
    if ( !v75 )
      continue;
    if ( !v92 )
      goto LABEL_84;
    v66 = v89;
    v23 = HIDWORD(v90);
    v26 = (__int64)&v89[8 * HIDWORD(v90)];
    if ( v89 != (char *)v26 )
    {
      while ( v74 != *(_QWORD *)v66 )
      {
        v66 += 8;
        if ( (char *)v26 == v66 )
          goto LABEL_83;
      }
      continue;
    }
LABEL_83:
    if ( HIDWORD(v90) < (unsigned int)v90 )
    {
      ++HIDWORD(v90);
      *(_QWORD *)v26 = v74;
      ++v88;
    }
    else
    {
LABEL_84:
      sub_C8CC70((__int64)&v88, v74, v26, v23, v24, v25);
    }
  }
  sub_10422E0(a1, (__int64)&v88);
  v31 = *(_QWORD *)(a1 + 24);
  v82 = 0;
  v83 = (__int64 *)&v87;
  v84 = 16;
  v85 = 0;
  v86 = 1;
  if ( !v31 )
  {
    v56 = *(__int64 **)(*(_QWORD *)(a1 + 8) + 96LL);
    sub_103C0D0(a1, v56, *(__int64 ****)(a1 + 128), (__int64)&v82, 0, 0);
    goto LABEL_48;
  }
  v32 = sub_D4B130(v31);
  v33 = *(_DWORD *)(a1 + 56);
  v34 = *(_QWORD *)(a1 + 40);
  v35 = v32;
  if ( v33 )
  {
    v36 = v33 - 1;
    v37 = v36 & (((unsigned int)v32 >> 9) ^ ((unsigned int)v32 >> 4));
    v38 = (__int64 *)(v34 + 16LL * v37);
    v39 = *v38;
    if ( v35 != *v38 )
    {
      v68 = 1;
      while ( v39 != -4096 )
      {
        v69 = v68 + 1;
        v37 = v36 & (v68 + v37);
        v38 = (__int64 *)(v34 + 16LL * v37);
        v39 = *v38;
        if ( v35 == *v38 )
          goto LABEL_32;
        v68 = v69;
      }
      goto LABEL_35;
    }
LABEL_32:
    v40 = v38[1];
    if ( v40 )
    {
      v41 = *(_QWORD *)(v40 + 16);
      if ( !v41 )
      {
LABEL_34:
        sub_103CDC0(a1, v40, 1);
        goto LABEL_35;
      }
      while ( 1 )
      {
        v64 = *(_QWORD *)(v41 + 8);
        v65 = *(_QWORD *)(a1 + 128);
        if ( *(_QWORD *)v41 )
        {
          **(_QWORD **)(v41 + 16) = v64;
          if ( v64 )
          {
            *(_QWORD *)(v64 + 16) = *(_QWORD *)(v41 + 16);
            *(_QWORD *)v41 = v65;
            if ( !v65 )
              goto LABEL_73;
          }
          else
          {
            *(_QWORD *)v41 = v65;
            if ( !v65 )
              goto LABEL_34;
          }
        }
        else
        {
          *(_QWORD *)v41 = v65;
          if ( !v65 )
            goto LABEL_72;
        }
        v63 = *(_QWORD *)(v65 + 16);
        *(_QWORD *)(v41 + 8) = v63;
        if ( v63 )
          *(_QWORD *)(v63 + 16) = v41 + 8;
        *(_QWORD *)(v41 + 16) = v65 + 16;
        *(_QWORD *)(v65 + 16) = v41;
LABEL_72:
        if ( !v64 )
          goto LABEL_34;
LABEL_73:
        v41 = v64;
      }
    }
  }
LABEL_35:
  v42 = *(_QWORD *)(a1 + 24);
  v80 = 0x600000000LL;
  v79 = (__int64 *)v81;
  sub_D472F0(v42, (__int64)&v79);
  v47 = v79;
  v48 = v86;
  v49 = &v79[(unsigned int)v80];
  if ( v79 != v49 )
  {
    while ( 1 )
    {
      while ( 1 )
      {
        v50 = *v47;
        if ( v48 )
          break;
LABEL_87:
        ++v47;
        sub_C8CC70((__int64)&v82, v50, (__int64)v43, v44, v45, v46);
        v48 = v86;
        if ( v49 == v47 )
          goto LABEL_42;
      }
      v51 = v83;
      v44 = HIDWORD(v84);
      v43 = &v83[HIDWORD(v84)];
      if ( v83 == v43 )
      {
LABEL_93:
        if ( HIDWORD(v84) >= (unsigned int)v84 )
          goto LABEL_87;
        v44 = (unsigned int)(HIDWORD(v84) + 1);
        ++v47;
        ++HIDWORD(v84);
        *v43 = v50;
        v48 = v86;
        ++v82;
        if ( v49 == v47 )
          break;
      }
      else
      {
        while ( v50 != *v51 )
        {
          if ( v43 == ++v51 )
            goto LABEL_93;
        }
        if ( v49 == ++v47 )
          break;
      }
    }
  }
LABEL_42:
  v52 = *(__int64 ****)(a1 + 128);
  v53 = *(_QWORD *)(a1 + 8);
  v54 = sub_D4B130(*(_QWORD *)(a1 + 24));
  v55 = 0;
  if ( v54 )
  {
    v55 = (unsigned int)(*(_DWORD *)(v54 + 44) + 1);
    LODWORD(v54) = *(_DWORD *)(v54 + 44) + 1;
  }
  v56 = 0;
  if ( (unsigned int)v54 < *(_DWORD *)(v53 + 32) )
    v56 = *(__int64 **)(*(_QWORD *)(v53 + 24) + 8 * v55);
  sub_103C0D0(a1, v56, v52, (__int64)&v82, 0, 0);
  if ( v79 != (__int64 *)v81 )
    _libc_free(v79, v56);
LABEL_48:
  v57 = v86;
  if ( v71 != v72 )
  {
    for ( j = v71; v72 != j; ++j )
    {
      while ( 1 )
      {
        v59 = *j;
        if ( !v57 )
          break;
        v60 = v83;
        v61 = &v83[HIDWORD(v84)];
        if ( v83 == v61 )
          goto LABEL_90;
        while ( v59 != *v60 )
        {
          if ( v61 == ++v60 )
            goto LABEL_90;
        }
        if ( v72 == ++j )
          goto LABEL_56;
      }
      v56 = (__int64 *)*j;
      if ( !sub_C8CA60((__int64)&v82, *j) )
      {
LABEL_90:
        v56 = (__int64 *)v59;
        sub_103C5C0(a1, v59);
      }
      v57 = v86;
    }
  }
LABEL_56:
  if ( !v57 )
    _libc_free(v83, v56);
  if ( !v92 )
    _libc_free(v89, v56);
  *(_QWORD *)a1 = a3;
  sub_103E0E0((_QWORD *)a1);
  v104[0] = &unk_49DDBE8;
  if ( (v105 & 1) == 0 )
  {
    v56 = (__int64 *)(16LL * v107);
    sub_C7D6A0(v106, (__int64)v56, 8);
  }
  nullsub_184();
  if ( v100 != v102 )
    _libc_free(v100, v56);
  if ( (v95 & 1) == 0 )
    sub_C7D6A0(v96, 40LL * v97, 8);
}

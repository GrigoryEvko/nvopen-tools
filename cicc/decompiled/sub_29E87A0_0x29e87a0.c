// Function: sub_29E87A0
// Address: 0x29e87a0
//
void __fastcall sub_29E87A0(__int64 a1, __int64 a2, _BYTE *a3)
{
  __int64 v3; // rbx
  __int64 v4; // rdi
  __int64 v5; // rax
  __int64 v6; // r8
  __int64 v7; // r9
  unsigned int v8; // esi
  __int64 v9; // rdx
  __int64 v10; // r14
  __int64 v11; // r12
  __int64 v12; // rdi
  __int64 v13; // rax
  __int64 v14; // rax
  __int64 v15; // r15
  __int64 v16; // rax
  unsigned __int64 v17; // rdx
  __int64 v18; // rax
  __int64 v19; // rbx
  __int64 v20; // rax
  __int64 v21; // rcx
  __int64 v22; // r9
  __int64 v23; // r14
  int v24; // eax
  unsigned __int64 v25; // rdx
  __int64 v26; // rdi
  __int64 v27; // r12
  unsigned __int64 v28; // r15
  __int64 v29; // r13
  _QWORD *v30; // rdi
  __int64 v31; // r15
  __int64 *v32; // r13
  __int64 v33; // rbx
  __int64 *v34; // r12
  int v35; // eax
  unsigned int v36; // esi
  __int64 v37; // rax
  __int64 v38; // rsi
  __int64 v39; // rsi
  __int64 v40; // r14
  int v41; // eax
  unsigned __int8 **v42; // rax
  _BYTE *v43; // rax
  const char *v44; // rax
  __int64 v45; // rdx
  int v46; // r11d
  int v47; // r11d
  __int64 v48; // r13
  __int64 v49; // rax
  unsigned __int8 *v50; // r15
  __int64 v51; // rax
  __int64 *v52; // rdx
  __int64 *v53; // r13
  __int64 *v54; // rax
  __int64 *i; // r14
  __int64 v56; // rsi
  int v57; // r10d
  unsigned __int8 **v58; // rax
  __int64 v59; // rcx
  _QWORD *v60; // rdx
  unsigned __int8 *v61; // rdi
  __int64 *v62; // rax
  __int64 v63; // r13
  __int64 *v64; // r15
  __int64 *v65; // rbx
  int v66; // eax
  unsigned int v67; // esi
  __int64 v68; // rax
  __int64 v69; // rdx
  __int64 v70; // rdx
  __int64 v71; // r14
  int v72; // eax
  __int64 v73; // r13
  __int64 *v74; // r12
  __int64 v75; // rbx
  __int64 v76; // rdi
  __int64 v77; // r8
  __int64 v78; // r15
  __int64 *v79; // r13
  __int64 v80; // rbx
  __int64 *v81; // r12
  int v82; // eax
  unsigned int v83; // edx
  __int64 v84; // rax
  __int64 v85; // rdx
  __int64 v86; // rdx
  __int64 v87; // r14
  int v88; // eax
  __int64 *v89; // rax
  __int64 v90; // r15
  int v91; // r14d
  __int64 *v92; // r11
  unsigned int v93; // ecx
  __int64 *v94; // rax
  __int64 v95; // rdi
  __int64 *v96; // rax
  int v97; // ecx
  __int64 v98; // rdx
  __int64 v99; // r8
  int v100; // edi
  __int64 *v101; // rsi
  int v102; // edi
  __int64 v103; // rdx
  __int64 v104; // r8
  int v105; // edx
  unsigned int v106; // ecx
  unsigned __int8 *v107; // r8
  int v108; // edi
  unsigned __int8 **v109; // rsi
  int v110; // esi
  unsigned int v111; // r13d
  unsigned __int8 **v112; // rcx
  unsigned __int8 *v113; // rdi
  unsigned __int8 *v114; // [rsp+8h] [rbp-138h]
  __int64 v115; // [rsp+10h] [rbp-130h]
  __int64 v117; // [rsp+20h] [rbp-120h]
  int v118; // [rsp+28h] [rbp-118h]
  unsigned int v119; // [rsp+2Ch] [rbp-114h]
  __int64 v120; // [rsp+30h] [rbp-110h]
  __int64 v121; // [rsp+48h] [rbp-F8h]
  __int64 v122; // [rsp+48h] [rbp-F8h]
  __int64 v123; // [rsp+48h] [rbp-F8h]
  __int64 *v124; // [rsp+48h] [rbp-F8h]
  unsigned int v125; // [rsp+50h] [rbp-F0h]
  __int64 v126; // [rsp+50h] [rbp-F0h]
  __int64 v127; // [rsp+58h] [rbp-E8h]
  __int64 v128; // [rsp+58h] [rbp-E8h]
  __int64 v129; // [rsp+60h] [rbp-E0h]
  __int64 v131; // [rsp+68h] [rbp-D8h]
  __int64 v132; // [rsp+68h] [rbp-D8h]
  __int64 v133; // [rsp+70h] [rbp-D0h] BYREF
  __int64 v134; // [rsp+78h] [rbp-C8h]
  __int64 v135; // [rsp+80h] [rbp-C0h]
  unsigned int v136; // [rsp+88h] [rbp-B8h]
  _QWORD v137[4]; // [rsp+90h] [rbp-B0h] BYREF
  __int16 v138; // [rsp+B0h] [rbp-90h]
  __int64 *v139; // [rsp+C0h] [rbp-80h] BYREF
  __int64 v140; // [rsp+C8h] [rbp-78h]
  _BYTE v141[112]; // [rsp+D0h] [rbp-70h] BYREF

  v3 = *(_QWORD *)(a1 + 40);
  v127 = *(_QWORD *)(a2 + 72);
  v4 = *(_QWORD *)(a1 - 64);
  v139 = (__int64 *)v141;
  v129 = v4;
  v140 = 0x800000000LL;
  v5 = sub_AA5930(v4);
  v8 = 0;
  v10 = v9;
  v11 = v5;
  while ( v10 != v11 )
  {
    v12 = *(_QWORD *)(v11 - 8);
    v13 = 0x1FFFFFFFE0LL;
    if ( (*(_DWORD *)(v11 + 4) & 0x7FFFFFF) != 0 )
    {
      v14 = 0;
      do
      {
        if ( v3 == *(_QWORD *)(v12 + 32LL * *(unsigned int *)(v11 + 72) + 8 * v14) )
        {
          v13 = 32 * v14;
          goto LABEL_7;
        }
        ++v14;
      }
      while ( (*(_DWORD *)(v11 + 4) & 0x7FFFFFF) != (_DWORD)v14 );
      v13 = 0x1FFFFFFFE0LL;
    }
LABEL_7:
    v15 = *(_QWORD *)(v12 + v13);
    v16 = v8;
    v17 = v8 + 1LL;
    if ( v17 > HIDWORD(v140) )
    {
      sub_C8D5F0((__int64)&v139, v141, v17, 8u, v6, v7);
      v16 = (unsigned int)v140;
    }
    v139[v16] = v15;
    v8 = v140 + 1;
    v18 = *(_QWORD *)(v11 + 32);
    LODWORD(v140) = v140 + 1;
    if ( !v18 )
      BUG();
    v11 = 0;
    if ( *(_BYTE *)(v18 - 24) == 84 )
      v11 = v18 - 24;
  }
  v133 = 0;
  v134 = 0;
  v135 = 0;
  v136 = 0;
  v117 = a2 + 24;
  v131 = v127 + 72;
  if ( v117 == v127 + 72 )
    goto LABEL_98;
  v115 = v3;
  v119 = 2 - (v129 == 0);
  v19 = v117;
  while ( 1 )
  {
    v27 = v19 - 24;
    v28 = *(_QWORD *)(v19 + 24) & 0xFFFFFFFFFFFFFFF8LL;
    if ( v28 == v19 + 24 )
      goto LABEL_185;
    if ( !v28 )
      BUG();
    if ( (unsigned int)*(unsigned __int8 *)(v28 - 24) - 30 > 0xA )
LABEL_185:
      BUG();
    if ( *(_BYTE *)(v28 - 24) == 37 && (*(_BYTE *)(v28 - 22) & 1) == 0 )
    {
      v29 = *(_QWORD *)(v28 - 32LL * (*(_DWORD *)(v28 - 20) & 0x7FFFFFF) - 24);
      v125 = v119 & 0x1FFFFFFF | v125 & 0xE0000000;
      v30 = sub_BD2C40(72, v119);
      if ( v30 )
        sub_B4BF70((__int64)v30, v29, v129, v125, v28, 0);
      sub_B43D60((_QWORD *)(v28 - 24));
      v31 = *(_QWORD *)(v129 + 56);
      if ( v139 != &v139[(unsigned int)v140] )
      {
        v121 = v29;
        v32 = &v139[(unsigned int)v140];
        v120 = v19;
        v33 = v19 - 24;
        v34 = v139;
        do
        {
          v40 = *v34;
          if ( !v31 )
            BUG();
          v41 = *(_DWORD *)(v31 - 20) & 0x7FFFFFF;
          if ( v41 == *(_DWORD *)(v31 + 48) )
          {
            sub_B48D90(v31 - 24);
            v41 = *(_DWORD *)(v31 - 20) & 0x7FFFFFF;
          }
          v35 = (v41 + 1) & 0x7FFFFFF;
          v36 = v35 | *(_DWORD *)(v31 - 20) & 0xF8000000;
          v37 = *(_QWORD *)(v31 - 32) + 32LL * (unsigned int)(v35 - 1);
          *(_DWORD *)(v31 - 20) = v36;
          if ( *(_QWORD *)v37 )
          {
            v38 = *(_QWORD *)(v37 + 8);
            **(_QWORD **)(v37 + 16) = v38;
            if ( v38 )
              *(_QWORD *)(v38 + 16) = *(_QWORD *)(v37 + 16);
          }
          *(_QWORD *)v37 = v40;
          if ( v40 )
          {
            v39 = *(_QWORD *)(v40 + 16);
            *(_QWORD *)(v37 + 8) = v39;
            if ( v39 )
              *(_QWORD *)(v39 + 16) = v37 + 8;
            *(_QWORD *)(v37 + 16) = v40 + 16;
            *(_QWORD *)(v40 + 16) = v37;
          }
          ++v34;
          *(_QWORD *)(*(_QWORD *)(v31 - 32)
                    + 32LL * *(unsigned int *)(v31 + 48)
                    + 8LL * ((*(_DWORD *)(v31 - 20) & 0x7FFFFFFu) - 1)) = v33;
          v31 = *(_QWORD *)(v31 + 8);
        }
        while ( v32 != v34 );
        v27 = v33;
        v29 = v121;
        v19 = v120;
      }
      v89 = (__int64 *)sub_B2BE50(v127);
      v90 = sub_AC3540(v89);
      if ( v136 )
      {
        v91 = 1;
        v92 = 0;
        v93 = (v136 - 1) & (((unsigned int)v29 >> 9) ^ ((unsigned int)v29 >> 4));
        v94 = (__int64 *)(v134 + 16LL * v93);
        v95 = *v94;
        if ( v29 == *v94 )
        {
LABEL_94:
          v94[1] = v90;
          goto LABEL_15;
        }
        while ( v95 != -4096 )
        {
          if ( !v92 && v95 == -8192 )
            v92 = v94;
          v93 = (v136 - 1) & (v91 + v93);
          v94 = (__int64 *)(v134 + 16LL * v93);
          v95 = *v94;
          if ( v29 == *v94 )
            goto LABEL_94;
          ++v91;
        }
        if ( v92 )
          v94 = v92;
        ++v133;
        v97 = v135 + 1;
        if ( 4 * ((int)v135 + 1) < 3 * v136 )
        {
          if ( v136 - HIDWORD(v135) - v97 > v136 >> 3 )
            goto LABEL_114;
          sub_2685CE0((__int64)&v133, v136);
          if ( !v136 )
          {
LABEL_176:
            LODWORD(v135) = v135 + 1;
            BUG();
          }
          v102 = 1;
          v101 = 0;
          LODWORD(v103) = (v136 - 1) & (((unsigned int)v29 >> 9) ^ ((unsigned int)v29 >> 4));
          v97 = v135 + 1;
          v94 = (__int64 *)(v134 + 16LL * (unsigned int)v103);
          v104 = *v94;
          if ( v29 == *v94 )
            goto LABEL_114;
          while ( v104 != -4096 )
          {
            if ( v104 == -8192 && !v101 )
              v101 = v94;
            v103 = (v136 - 1) & ((_DWORD)v103 + v102);
            v94 = (__int64 *)(v134 + 16 * v103);
            v104 = *v94;
            if ( v29 == *v94 )
              goto LABEL_114;
            ++v102;
          }
          goto LABEL_130;
        }
      }
      else
      {
        ++v133;
      }
      sub_2685CE0((__int64)&v133, 2 * v136);
      if ( !v136 )
        goto LABEL_176;
      v97 = v135 + 1;
      LODWORD(v98) = (v136 - 1) & (((unsigned int)v29 >> 9) ^ ((unsigned int)v29 >> 4));
      v94 = (__int64 *)(v134 + 16LL * (unsigned int)v98);
      v99 = *v94;
      if ( v29 == *v94 )
        goto LABEL_114;
      v100 = 1;
      v101 = 0;
      while ( v99 != -4096 )
      {
        if ( !v101 && v99 == -8192 )
          v101 = v94;
        v98 = (v136 - 1) & ((_DWORD)v98 + v100);
        v94 = (__int64 *)(v134 + 16 * v98);
        v99 = *v94;
        if ( v29 == *v94 )
          goto LABEL_114;
        ++v100;
      }
LABEL_130:
      if ( v101 )
        v94 = v101;
LABEL_114:
      LODWORD(v135) = v97;
      if ( *v94 != -4096 )
        --HIDWORD(v135);
      *v94 = v29;
      v94[1] = 0;
      goto LABEL_94;
    }
LABEL_15:
    v20 = sub_AA4FF0(v27);
    v23 = v20;
    if ( !v20 )
      BUG();
    v24 = *(unsigned __int8 *)(v20 - 24);
    v25 = (unsigned int)(v24 - 39);
    if ( (unsigned int)v25 <= 0x38 )
    {
      v26 = 0x100060000000001LL;
      if ( _bittest64(&v26, v25) )
        break;
    }
LABEL_18:
    v19 = *(_QWORD *)(v19 + 8);
    if ( v131 == v19 )
      goto LABEL_73;
LABEL_19:
    if ( !v19 )
      BUG();
  }
  if ( (_BYTE)v24 == 39 )
  {
    if ( (*(_BYTE *)(v23 - 22) & 1) != 0 )
      goto LABEL_18;
    v42 = *(unsigned __int8 ***)(v23 - 32);
    if ( **v42 <= 0x1Cu )
    {
      v96 = (__int64 *)sub_B2BE50(v127);
      v122 = sub_AC3540(v96);
    }
    else
    {
      v43 = sub_29E73A0(*v42, (__int64)&v133, v25, v21, (__int64)&v133, v22);
      v122 = (__int64)v43;
      if ( v43 && *v43 != 21 )
        goto LABEL_18;
    }
    v114 = (unsigned __int8 *)(v23 - 24);
    v44 = sub_BD5D20(v23 - 24);
    v138 = 261;
    v137[0] = v44;
    v137[1] = v45;
    v46 = *(_DWORD *)(v23 - 20);
    if ( (*(_BYTE *)(v23 - 22) & 1) != 0 )
      v47 = (v46 & 0x7FFFFFF) - 2;
    else
      v47 = (v46 & 0x7FFFFFF) - 1;
    v118 = v47;
    v48 = **(_QWORD **)(v23 - 32);
    v49 = sub_BD2DA0(80);
    v50 = (unsigned __int8 *)v49;
    if ( v49 )
      sub_B4C2D0(v49, v48, v129, v118, (__int64)v137, 0, v23, 0);
    v51 = *(_QWORD *)(v23 - 32);
    v52 = (__int64 *)(v51 + 32);
    v53 = (__int64 *)(v51 + 32LL * (*(_DWORD *)(v23 - 20) & 0x7FFFFFF));
    v54 = (__int64 *)(v51 + 64);
    if ( (*(_BYTE *)(v23 - 22) & 1) != 0 )
      v52 = v54;
    for ( i = v52; v53 != i; i += 4 )
    {
      v56 = *i;
      sub_B4C4B0((__int64)v50, v56);
    }
    if ( v136 )
    {
      v57 = 1;
      v58 = 0;
      LODWORD(v59) = (v136 - 1) & (((unsigned int)v50 >> 4) ^ ((unsigned int)v50 >> 9));
      v60 = (_QWORD *)(v134 + 16LL * (unsigned int)v59);
      v61 = (unsigned __int8 *)*v60;
      if ( (unsigned __int8 *)*v60 == v50 )
      {
LABEL_55:
        v62 = v60 + 1;
LABEL_56:
        *v62 = v122;
        if ( v50 )
        {
          sub_BD6B90(v50, v114);
          sub_BD84D0((__int64)v114, (__int64)v50);
          sub_B43D60(v114);
          v63 = *(_QWORD *)(v129 + 56);
          if ( v139 != &v139[(unsigned int)v140] )
          {
            v123 = v19;
            v64 = v139;
            v65 = &v139[(unsigned int)v140];
            do
            {
              v71 = *v64;
              if ( !v63 )
                BUG();
              v72 = *(_DWORD *)(v63 - 20) & 0x7FFFFFF;
              if ( v72 == *(_DWORD *)(v63 + 48) )
              {
                sub_B48D90(v63 - 24);
                v72 = *(_DWORD *)(v63 - 20) & 0x7FFFFFF;
              }
              v66 = (v72 + 1) & 0x7FFFFFF;
              v67 = v66 | *(_DWORD *)(v63 - 20) & 0xF8000000;
              v68 = *(_QWORD *)(v63 - 32) + 32LL * (unsigned int)(v66 - 1);
              *(_DWORD *)(v63 - 20) = v67;
              if ( *(_QWORD *)v68 )
              {
                v69 = *(_QWORD *)(v68 + 8);
                **(_QWORD **)(v68 + 16) = v69;
                if ( v69 )
                  *(_QWORD *)(v69 + 16) = *(_QWORD *)(v68 + 16);
              }
              *(_QWORD *)v68 = v71;
              if ( v71 )
              {
                v70 = *(_QWORD *)(v71 + 16);
                *(_QWORD *)(v68 + 8) = v70;
                if ( v70 )
                  *(_QWORD *)(v70 + 16) = v68 + 8;
                *(_QWORD *)(v68 + 16) = v71 + 16;
                *(_QWORD *)(v71 + 16) = v68;
              }
              ++v64;
              *(_QWORD *)(*(_QWORD *)(v63 - 32)
                        + 32LL * *(unsigned int *)(v63 + 48)
                        + 8LL * ((*(_DWORD *)(v63 - 20) & 0x7FFFFFFu) - 1)) = v27;
              v63 = *(_QWORD *)(v63 + 8);
            }
            while ( v65 != v64 );
            v19 = v123;
          }
        }
        goto LABEL_18;
      }
      while ( v61 != (unsigned __int8 *)-4096LL )
      {
        if ( !v58 && v61 == (unsigned __int8 *)-8192LL )
          v58 = (unsigned __int8 **)v60;
        v59 = (v136 - 1) & ((_DWORD)v59 + v57);
        v60 = (_QWORD *)(v134 + 16 * v59);
        v61 = (unsigned __int8 *)*v60;
        if ( v50 == (unsigned __int8 *)*v60 )
          goto LABEL_55;
        ++v57;
      }
      if ( !v58 )
        v58 = (unsigned __int8 **)v60;
      ++v133;
      v105 = v135 + 1;
      if ( 4 * ((int)v135 + 1) < 3 * v136 )
      {
        if ( v136 - HIDWORD(v135) - v105 <= v136 >> 3 )
        {
          sub_2685CE0((__int64)&v133, v136);
          if ( !v136 )
          {
LABEL_177:
            LODWORD(v135) = v135 + 1;
            BUG();
          }
          v110 = 1;
          v111 = (v136 - 1) & (((unsigned int)v50 >> 4) ^ ((unsigned int)v50 >> 9));
          v105 = v135 + 1;
          v112 = 0;
          v58 = (unsigned __int8 **)(v134 + 16LL * v111);
          v113 = *v58;
          if ( *v58 != v50 )
          {
            while ( v113 != (unsigned __int8 *)-4096LL )
            {
              if ( v113 == (unsigned __int8 *)-8192LL && !v112 )
                v112 = v58;
              v111 = (v136 - 1) & (v110 + v111);
              v58 = (unsigned __int8 **)(v134 + 16LL * v111);
              v113 = *v58;
              if ( v50 == *v58 )
                goto LABEL_143;
              ++v110;
            }
            if ( v112 )
              v58 = v112;
          }
        }
        goto LABEL_143;
      }
    }
    else
    {
      ++v133;
    }
    sub_2685CE0((__int64)&v133, 2 * v136);
    if ( !v136 )
      goto LABEL_177;
    v105 = v135 + 1;
    v106 = (v136 - 1) & (((unsigned int)v50 >> 9) ^ ((unsigned int)v50 >> 4));
    v58 = (unsigned __int8 **)(v134 + 16LL * v106);
    v107 = *v58;
    if ( *v58 != v50 )
    {
      v108 = 1;
      v109 = 0;
      while ( v107 != (unsigned __int8 *)-4096LL )
      {
        if ( !v109 && v107 == (unsigned __int8 *)-8192LL )
          v109 = v58;
        v106 = (v136 - 1) & (v108 + v106);
        v58 = (unsigned __int8 **)(v134 + 16LL * v106);
        v107 = *v58;
        if ( v50 == *v58 )
          goto LABEL_143;
        ++v108;
      }
      if ( v109 )
        v58 = v109;
    }
LABEL_143:
    LODWORD(v135) = v105;
    if ( *v58 != (unsigned __int8 *)-4096LL )
      --HIDWORD(v135);
    *v58 = v50;
    v62 = (__int64 *)(v58 + 1);
    *v62 = 0;
    goto LABEL_56;
  }
  if ( (unsigned int)(v24 - 80) > 1 )
    BUG();
  v19 = *(_QWORD *)(v19 + 8);
  if ( v131 != v19 )
    goto LABEL_19;
LABEL_73:
  v132 = v19;
  v3 = v115;
  if ( *a3 )
  {
    v73 = v129;
    v74 = &v133;
    v75 = v117;
    do
    {
      v76 = v75 - 24;
      if ( !v75 )
        v76 = 0;
      v77 = sub_29E7990(v76, v73, (__int64)v74);
      if ( v77 )
      {
        v78 = *(_QWORD *)(v73 + 56);
        if ( v139 != &v139[(unsigned int)v140] )
        {
          v128 = v73;
          v79 = v139;
          v126 = v75;
          v80 = v77;
          v124 = v74;
          v81 = &v139[(unsigned int)v140];
          do
          {
            v87 = *v79;
            if ( !v78 )
              BUG();
            v88 = *(_DWORD *)(v78 - 20) & 0x7FFFFFF;
            if ( v88 == *(_DWORD *)(v78 + 48) )
            {
              sub_B48D90(v78 - 24);
              v88 = *(_DWORD *)(v78 - 20) & 0x7FFFFFF;
            }
            v82 = (v88 + 1) & 0x7FFFFFF;
            v83 = v82 | *(_DWORD *)(v78 - 20) & 0xF8000000;
            v84 = *(_QWORD *)(v78 - 32) + 32LL * (unsigned int)(v82 - 1);
            *(_DWORD *)(v78 - 20) = v83;
            if ( *(_QWORD *)v84 )
            {
              v85 = *(_QWORD *)(v84 + 8);
              **(_QWORD **)(v84 + 16) = v85;
              if ( v85 )
                *(_QWORD *)(v85 + 16) = *(_QWORD *)(v84 + 16);
            }
            *(_QWORD *)v84 = v87;
            if ( v87 )
            {
              v86 = *(_QWORD *)(v87 + 16);
              *(_QWORD *)(v84 + 8) = v86;
              if ( v86 )
                *(_QWORD *)(v86 + 16) = v84 + 8;
              *(_QWORD *)(v84 + 16) = v87 + 16;
              *(_QWORD *)(v87 + 16) = v84;
            }
            ++v79;
            *(_QWORD *)(*(_QWORD *)(v78 - 32)
                      + 32LL * *(unsigned int *)(v78 + 48)
                      + 8LL * ((*(_DWORD *)(v78 - 20) & 0x7FFFFFFu) - 1)) = v80;
            v78 = *(_QWORD *)(v78 + 8);
          }
          while ( v81 != v79 );
          v73 = v128;
          v75 = v126;
          v74 = v124;
        }
      }
      v75 = *(_QWORD *)(v75 + 8);
    }
    while ( v132 != v75 );
    v3 = v115;
  }
LABEL_98:
  sub_AA5980(v129, v3, 0);
  sub_C7D6A0(v134, 16LL * v136, 8);
  if ( v139 != (__int64 *)v141 )
    _libc_free((unsigned __int64)v139);
}

// Function: sub_27103A0
// Address: 0x27103a0
//
void __fastcall sub_27103A0(__int64 a1, __int64 a2, unsigned int a3, unsigned __int8 *a4)
{
  __int64 v5; // r12
  bool v7; // zf
  __int64 v8; // rax
  int v9; // eax
  int v10; // ecx
  unsigned int v11; // eax
  __int64 v12; // rdx
  int v13; // eax
  __int64 v14; // rcx
  __int64 v15; // rdx
  __int64 k; // r13
  char v17; // al
  __int64 v18; // r15
  __int64 v19; // rax
  __int64 v20; // rdx
  __int64 v21; // rdx
  __int64 v22; // rdx
  unsigned __int8 *v23; // r13
  __int64 v24; // rax
  unsigned __int8 *v25; // r15
  __int64 v26; // r13
  __int64 v27; // rdi
  __int64 v28; // rdi
  unsigned __int8 *v29; // rax
  __int64 v30; // rdx
  unsigned __int8 *v31; // r14
  unsigned __int8 v32; // al
  __int64 v33; // r8
  int v34; // eax
  __int64 v35; // rsi
  _QWORD *v36; // rdi
  unsigned int v37; // eax
  __int64 v38; // rdx
  __int64 *v39; // rdx
  __int64 v40; // r13
  __int64 v41; // r15
  __int64 v42; // rbx
  __int64 v43; // r12
  char v44; // r15
  unsigned __int8 *v45; // rdi
  __int64 v46; // rdi
  unsigned __int8 *v47; // rax
  __int64 v48; // rdx
  unsigned __int8 *v49; // r14
  unsigned __int8 v50; // al
  __int64 v51; // r8
  unsigned int v52; // eax
  int v53; // eax
  char v54; // al
  __int64 v55; // r15
  char *v56; // r13
  unsigned __int8 **v57; // rdx
  __int64 v58; // rax
  int v59; // eax
  __int64 *v60; // rax
  __int64 v61; // r13
  __int64 *v62; // rax
  __int64 **v63; // rax
  __int64 v64; // r14
  _QWORD *v65; // rdi
  __int64 v66; // rax
  int v67; // eax
  unsigned __int8 *i; // rdi
  __int64 v69; // rdi
  unsigned __int8 *v70; // rax
  __int64 v71; // rdx
  unsigned __int8 *v72; // r13
  unsigned __int8 v73; // al
  __int64 v74; // r8
  unsigned __int8 *m; // rdi
  __int64 v76; // rdi
  unsigned __int8 *v77; // rax
  __int64 v78; // rdx
  unsigned __int8 *v79; // r13
  unsigned __int8 v80; // al
  __int64 v81; // r8
  __int64 v82; // rdx
  unsigned __int64 v83; // rax
  int v84; // edx
  __int64 v85; // rdi
  __int64 v86; // rax
  _QWORD *v87; // r9
  _QWORD *v88; // rdx
  unsigned int v89; // eax
  _QWORD **v90; // r8
  __int64 v91; // rcx
  unsigned __int64 v92; // rdx
  __int64 v93; // r13
  char *v94; // r15
  char v95; // al
  __int64 v96; // rax
  unsigned __int64 v97; // rdx
  __int64 v98; // rdi
  int v99; // eax
  __int64 *v100; // rdx
  unsigned __int8 *ii; // rdi
  __int64 v102; // rdi
  unsigned __int8 *v103; // rax
  __int64 v104; // rdx
  unsigned __int8 v105; // al
  __int64 v106; // r8
  __int64 v107; // rax
  __int64 v108; // rax
  int v109; // eax
  _QWORD *v110; // rsi
  unsigned __int8 *jj; // rdi
  __int64 v112; // rdi
  unsigned __int8 *v113; // rax
  __int64 v114; // rdx
  unsigned __int8 *v115; // r13
  unsigned __int8 v116; // al
  __int64 v117; // r8
  __int64 v118; // rax
  __int64 v119; // r8
  __int64 v120; // r14
  _QWORD *v121; // rax
  __int64 v122; // r13
  __int64 v123; // r15
  __int64 v124; // r14
  unsigned int v125; // esi
  char *v126; // r14
  _QWORD *v127; // rdi
  int v128; // eax
  __int64 v129; // rax
  char *v130; // rbx
  int v131; // edi
  __int64 j; // r13
  char v133; // al
  __int64 v134; // rax
  unsigned __int64 v135; // rax
  unsigned __int64 v136; // rdx
  __int64 v137; // rax
  __int64 v138; // r9
  __int64 v139; // rdx
  __int64 v140; // rbx
  __int64 v141; // rax
  __int64 v142; // r14
  __int64 v143; // r12
  __int64 v144; // rax
  unsigned int *v145; // rax
  __int64 v146; // r10
  unsigned int v147; // ecx
  __int64 v148; // rdx
  int v149; // eax
  char *v150; // r13
  unsigned __int64 *v151; // r15
  __int64 v152; // rdx
  unsigned __int64 *v153; // rdi
  unsigned __int64 v154; // rax
  __int64 v155; // rbx
  _QWORD *v156; // rax
  _QWORD *v157; // r12
  __int64 v158; // rax
  __int64 v159; // rdx
  __int64 v160; // rdx
  __int64 v161; // r8
  __int64 v162; // r9
  __int64 v163; // rax
  unsigned __int64 v164; // rdx
  __int64 *v165; // rax
  __int64 v166; // rbx
  unsigned __int64 *v167; // r12
  unsigned __int64 v168; // rdi
  unsigned __int8 v169; // al
  __int64 v170; // rdi
  size_t v171; // rdx
  __int64 v172; // rax
  __int8 *v173; // r15
  __int64 v174; // rdx
  char *v175; // rdi
  char *v176; // rdx
  __int64 v177; // rax
  int v178; // ebx
  unsigned int v179; // eax
  __int64 v180; // rax
  __int64 v181; // rdx
  __int64 v182; // rdx
  unsigned __int64 v183; // rdi
  size_t v184; // rdx
  __int64 v185; // r8
  __int64 v186; // [rsp+0h] [rbp-1E0h]
  unsigned __int8 *v187; // [rsp+10h] [rbp-1D0h]
  unsigned __int64 *v188; // [rsp+20h] [rbp-1C0h]
  unsigned __int64 v189; // [rsp+28h] [rbp-1B8h]
  __int64 v190; // [rsp+30h] [rbp-1B0h]
  __int64 v191; // [rsp+38h] [rbp-1A8h]
  __int64 v192; // [rsp+50h] [rbp-190h]
  __m128i *v193; // [rsp+58h] [rbp-188h]
  __int64 v194; // [rsp+60h] [rbp-180h]
  unsigned int v195; // [rsp+6Ch] [rbp-174h]
  __int64 v196; // [rsp+70h] [rbp-170h]
  __int64 v197; // [rsp+80h] [rbp-160h]
  __int64 v198; // [rsp+80h] [rbp-160h]
  __int64 v199; // [rsp+88h] [rbp-158h]
  _QWORD *v200; // [rsp+88h] [rbp-158h]
  __int64 v201; // [rsp+88h] [rbp-158h]
  __int64 *v202; // [rsp+88h] [rbp-158h]
  _QWORD *v203; // [rsp+88h] [rbp-158h]
  unsigned int v204; // [rsp+90h] [rbp-150h]
  char v205; // [rsp+90h] [rbp-150h]
  _QWORD **v206; // [rsp+90h] [rbp-150h]
  __int64 v207; // [rsp+90h] [rbp-150h]
  _QWORD **v208; // [rsp+90h] [rbp-150h]
  _QWORD *v209; // [rsp+90h] [rbp-150h]
  unsigned __int64 v211; // [rsp+A8h] [rbp-138h] BYREF
  __int64 v212; // [rsp+B0h] [rbp-130h] BYREF
  char *v213; // [rsp+B8h] [rbp-128h]
  __int64 v214; // [rsp+C0h] [rbp-120h]
  int v215; // [rsp+C8h] [rbp-118h]
  char v216; // [rsp+CCh] [rbp-114h]
  char v217; // [rsp+D0h] [rbp-110h] BYREF
  char *v218; // [rsp+E0h] [rbp-100h] BYREF
  size_t n; // [rsp+E8h] [rbp-F8h]
  _QWORD src[2]; // [rsp+F0h] [rbp-F0h] BYREF
  __int16 v221; // [rsp+100h] [rbp-E0h]
  unsigned __int64 *v222; // [rsp+110h] [rbp-D0h] BYREF
  __int64 v223; // [rsp+118h] [rbp-C8h]
  _QWORD v224[8]; // [rsp+120h] [rbp-C0h] BYREF
  _QWORD *v225; // [rsp+160h] [rbp-80h] BYREF
  __int64 v226; // [rsp+168h] [rbp-78h]
  _QWORD v227[2]; // [rsp+170h] [rbp-70h] BYREF
  __int16 v228; // [rsp+180h] [rbp-60h]

  v5 = a2;
  v7 = *(_BYTE *)a2 == 85;
  v212 = 0;
  v213 = &v217;
  v214 = 1;
  v215 = 0;
  v216 = 1;
  if ( v7 )
  {
    v8 = *(_QWORD *)(a1 + 200);
    a2 = *(_QWORD *)(v8 + 8);
    v9 = *(_DWORD *)(v8 + 24);
    if ( v9 )
    {
      v10 = v9 - 1;
      v11 = (v9 - 1) & (((unsigned int)v5 >> 9) ^ ((unsigned int)v5 >> 4));
      v12 = *(_QWORD *)(a2 + 16LL * v11);
      if ( v5 == v12 )
      {
LABEL_4:
        *(_DWORD *)(a1 + 212) |= 1 << a3;
        return;
      }
      v131 = 1;
      while ( v12 != -4096 )
      {
        v11 = v10 & (v131 + v11);
        v12 = *(_QWORD *)(a2 + 16LL * v11);
        if ( v5 == v12 )
          goto LABEL_4;
        ++v131;
      }
    }
  }
  if ( !(unsigned __int8)sub_3108D00(a3, a2)
    || ((*(_BYTE *)(v5 + 7) & 0x40) != 0
      ? (v57 = *(unsigned __int8 ***)(v5 - 8))
      : (v57 = (unsigned __int8 **)(v5 - 32LL * (*(_DWORD *)(v5 + 4) & 0x7FFFFFF))),
        a2 = (__int64)&v212,
        !(unsigned __int8)sub_270EB40(*v57, (__int64)&v212)) )
  {
    switch ( a3 )
    {
      case 1u:
        for ( i = *(unsigned __int8 **)(v5 - 32LL * (*(_DWORD *)(v5 + 4) & 0x7FFFFFF));
              ;
              i = *(unsigned __int8 **)&v72[-32 * (*((_DWORD *)v72 + 1) & 0x7FFFFFF)] )
        {
          v70 = sub_BD3990(i, a2);
          v69 = 23;
          v72 = v70;
          v73 = *v70;
          if ( v73 > 0x1Cu )
          {
            if ( v73 == 85 )
            {
              v74 = *((_QWORD *)v72 - 4);
              v69 = 21;
              if ( v74 && !*(_BYTE *)v74 && *(_QWORD *)(v74 + 24) == *((_QWORD *)v72 + 10) )
                v69 = (unsigned int)sub_3108960(*((_QWORD *)v72 - 4), a2, v71);
            }
            else
            {
              v69 = 2 * (unsigned int)(v73 != 34) + 21;
            }
          }
          if ( !(unsigned __int8)sub_3108CA0(v69) )
            break;
        }
        v13 = *v72;
        if ( (unsigned __int8)v13 <= 0x1Cu )
          goto LABEL_19;
        if ( (unsigned __int8)(v13 - 34) > 0x33u )
          goto LABEL_19;
        v14 = 0x8000000000041LL;
        if ( !_bittest64(&v14, (unsigned int)(v13 - 34)) )
          goto LABEL_19;
        v15 = *(_QWORD *)(v5 + 40);
        if ( *((_QWORD *)v72 + 5) == v15 )
        {
          for ( j = *((_QWORD *)v72 + 4); ; j = *(_QWORD *)(j + 8) )
          {
            if ( !j )
              BUG();
            v133 = *(_BYTE *)(j - 24);
            v18 = j - 24;
            if ( v133 != 78 && (v133 != 63 || !(unsigned __int8)sub_B4DCF0(j - 24)) )
              break;
          }
        }
        else
        {
          if ( (_BYTE)v13 != 34 || v15 != *((_QWORD *)v72 - 12) )
          {
LABEL_19:
            *(_BYTE *)a1 = 1;
            v19 = *(_QWORD *)(a1 + 104);
            if ( !v19 )
            {
              a2 = 268;
              v19 = sub_B6E160(*(__int64 **)(a1 + 80), 0x10Cu, 0, 0);
              *(_QWORD *)(a1 + 104) = v19;
            }
            v7 = *(_QWORD *)(v5 - 32) == 0;
            *(_QWORD *)(v5 + 80) = *(_QWORD *)(v19 + 24);
            if ( !v7 )
            {
              v20 = *(_QWORD *)(v5 - 24);
              **(_QWORD **)(v5 - 16) = v20;
              if ( v20 )
                *(_QWORD *)(v20 + 16) = *(_QWORD *)(v5 - 16);
            }
            *(_QWORD *)(v5 - 32) = v19;
            v21 = *(_QWORD *)(v19 + 16);
            *(_QWORD *)(v5 - 24) = v21;
            if ( v21 )
            {
              a2 = v5 - 24;
              *(_QWORD *)(v21 + 16) = v5 - 24;
            }
            *(_QWORD *)(v5 - 16) = v19 + 16;
            *(_QWORD *)(v19 + 16) = v5 - 32;
            goto LABEL_27;
          }
          for ( k = *(_QWORD *)(v15 + 56); ; k = *(_QWORD *)(k + 8) )
          {
            if ( !k )
              BUG();
            v17 = *(_BYTE *)(k - 24);
            v18 = k - 24;
            if ( v17 != 78 && (v17 != 63 || !(unsigned __int8)sub_B4DCF0(k - 24)) )
              break;
          }
        }
        if ( v5 == v18 )
          goto LABEL_27;
        goto LABEL_19;
      case 6u:
        for ( m = *(unsigned __int8 **)(v5 - 32LL * (*(_DWORD *)(v5 + 4) & 0x7FFFFFF));
              ;
              m = *(unsigned __int8 **)&v79[-32 * (*((_DWORD *)v79 + 1) & 0x7FFFFFF)] )
        {
          v77 = sub_BD3990(m, a2);
          v76 = 23;
          v79 = v77;
          v80 = *v77;
          if ( v80 > 0x1Cu )
          {
            if ( v80 == 85 )
            {
              v81 = *((_QWORD *)v79 - 4);
              v76 = 21;
              if ( v81 && !*(_BYTE *)v81 && *(_QWORD *)(v81 + 24) == *((_QWORD *)v79 + 10) )
                v76 = (unsigned int)sub_3108960(*((_QWORD *)v79 - 4), a2, v78);
            }
            else
            {
              v76 = 2 * (unsigned int)(v80 != 34) + 21;
            }
          }
          if ( !(unsigned __int8)sub_3108CA0(v76) )
            break;
        }
        if ( (unsigned int)*v79 - 12 <= 9 )
          goto LABEL_27;
        v87 = v227;
        v227[0] = v79;
        v226 = 0x200000001LL;
        v88 = v227;
        v89 = 1;
        v90 = &v225;
        v225 = v227;
        if ( *v79 == 84 )
        {
          a2 = (__int64)&v225;
          sub_270F680((__int64)v79, (__int64)&v225);
          v88 = v225;
          v89 = v226;
          v90 = &v225;
          v87 = v227;
        }
LABEL_130:
        v91 = v89--;
        v92 = v88[v91 - 1];
        LODWORD(v226) = v89;
        v93 = *(_QWORD *)(v92 + 16);
        if ( !v93 )
          goto LABEL_140;
        break;
      case 9u:
        goto LABEL_77;
      case 0xCu:
      case 0xDu:
      case 0xEu:
      case 0xFu:
      case 0x12u:
        v58 = -(__int64)(*(_DWORD *)(v5 + 4) & 0x7FFFFFF);
        goto LABEL_85;
      case 0x10u:
      case 0x11u:
        v67 = **(unsigned __int8 **)(v5 - 32LL * (*(_DWORD *)(v5 + 4) & 0x7FFFFFF));
        if ( (_BYTE)v67 == 20 || (unsigned int)(v67 - 12) <= 1 )
          goto LABEL_87;
        v58 = 1LL - (*(_DWORD *)(v5 + 4) & 0x7FFFFFF);
LABEL_85:
        v59 = **(unsigned __int8 **)(v5 + 32 * v58);
        if ( (_BYTE)v59 != 20 && (unsigned int)(v59 - 12) > 1 )
          goto LABEL_27;
LABEL_87:
        *(_BYTE *)a1 = 1;
        v60 = (__int64 *)sub_BD5C60(v5);
        v61 = sub_ACD6D0(v60);
        v62 = (__int64 *)sub_BD5C60(v5);
        v63 = (__int64 **)sub_BCE3C0(v62, 0);
        v64 = sub_ACADE0(v63);
        v65 = sub_BD2C40(80, unk_3F10A10);
        if ( v65 )
          sub_B4D460((__int64)v65, v61, v64, v5 + 24, 0);
        v66 = sub_ACADE0(*(__int64 ***)(v5 + 8));
        sub_BD84D0(v5, v66);
        sub_B43D60((_QWORD *)v5);
        goto LABEL_90;
      default:
        goto LABEL_27;
    }
    while ( 1 )
    {
      v94 = *(char **)(v93 + 24);
      v95 = *v94;
      if ( (unsigned __int8)*v94 > 0x1Cu )
      {
        if ( v95 == 30 )
          goto LABEL_142;
        if ( v95 != 85 )
          goto LABEL_134;
        v98 = *((_QWORD *)v94 - 4);
        if ( v98 )
        {
          if ( !*(_BYTE *)v98 && *(_QWORD *)(v98 + 24) == *((_QWORD *)v94 + 10) )
            break;
        }
      }
LABEL_138:
      v93 = *(_QWORD *)(v93 + 8);
      if ( !v93 )
      {
        v89 = v226;
LABEL_140:
        if ( v89 )
        {
          v88 = v225;
          goto LABEL_130;
        }
        *(_BYTE *)a1 = 1;
        v180 = *(_QWORD *)(a1 + 120);
        if ( !v180 )
        {
          v209 = v87;
          v180 = sub_B6E160(*(__int64 **)(a1 + 80), 0xFFu, 0, 0);
          v87 = v209;
          *(_QWORD *)(a1 + 120) = v180;
        }
        v7 = *(_QWORD *)(v5 - 32) == 0;
        *(_QWORD *)(v5 + 80) = *(_QWORD *)(v180 + 24);
        if ( !v7 )
        {
          v181 = *(_QWORD *)(v5 - 24);
          **(_QWORD **)(v5 - 16) = v181;
          if ( v181 )
            *(_QWORD *)(v181 + 16) = *(_QWORD *)(v5 - 16);
        }
        *(_QWORD *)(v5 - 32) = v180;
        v182 = *(_QWORD *)(v180 + 16);
        a2 = v180 + 16;
        *(_QWORD *)(v5 - 24) = v182;
        if ( v182 )
          *(_QWORD *)(v182 + 16) = v5 - 24;
        *(_QWORD *)(v5 - 16) = a2;
        *(_QWORD *)(v180 + 16) = v5 - 32;
        v183 = (unsigned __int64)v225;
        *(_WORD *)(v5 + 2) &= 0xFFFCu;
        if ( (_QWORD *)v183 != v87 )
          _libc_free(v183);
        a3 = 5;
LABEL_27:
        if ( !(unsigned __int8)sub_3108C80(a3) )
          goto LABEL_46;
        if ( *(_QWORD *)(v5 + 16) )
          goto LABEL_46;
        v23 = *(unsigned __int8 **)(v5 - 32LL * (*(_DWORD *)(v5 + 4) & 0x7FFFFFF));
        v22 = *v23;
        if ( (unsigned int)(v22 - 12) <= 9 )
          goto LABEL_46;
        while ( 2 )
        {
          v24 = *((_QWORD *)v23 + 2);
          if ( v24 && !*(_QWORD *)(v24 + 8) )
          {
            if ( (unsigned __int8)v22 > 0x1Cu )
            {
              if ( (_BYTE)v22 == 78 )
              {
                v23 = (unsigned __int8 *)*((_QWORD *)v23 - 4);
LABEL_272:
                v22 = *v23;
                if ( (unsigned int)(v22 - 12) <= 9 )
                  goto LABEL_46;
                continue;
              }
              if ( (_BYTE)v22 == 63 && (unsigned __int8)sub_B4DCF0((__int64)v23) )
              {
                v23 = *(unsigned __int8 **)&v23[-32 * (*((_DWORD *)v23 + 1) & 0x7FFFFFF)];
                goto LABEL_272;
              }
            }
            v169 = *v23;
            v170 = 23;
            if ( *v23 > 0x1Cu )
            {
              if ( v169 == 85 )
              {
                v185 = *((_QWORD *)v23 - 4);
                v170 = 21;
                if ( v185 && !*(_BYTE *)v185 && *(_QWORD *)(v185 + 24) == *((_QWORD *)v23 + 10) )
                  v170 = (unsigned int)sub_3108960(*((_QWORD *)v23 - 4), a2, v22);
              }
              else
              {
                v170 = 2 * (unsigned int)(v169 != 34) + 21;
              }
            }
            if ( !(unsigned __int8)sub_3108CA0(v170) )
            {
              if ( !(unsigned __int8)sub_270F130(v23, a2) )
                goto LABEL_46;
LABEL_188:
              *(_BYTE *)a1 = 1;
              v118 = sub_BD5C60(v5);
              v119 = v5 + 24;
              v202 = (__int64 *)v118;
              v207 = *(_QWORD *)(a1 + 96);
              if ( v207 )
              {
                v228 = 257;
                v222 = *(unsigned __int64 **)(v5 - 32LL * (*(_DWORD *)(v5 + 4) & 0x7FFFFFF));
                goto LABEL_190;
              }
              v172 = sub_B6E160(*(__int64 **)(a1 + 80), 0x10Bu, 0, 0);
              *(_QWORD *)(a1 + 96) = v172;
              v120 = v172;
              LODWORD(v172) = *(_DWORD *)(v5 + 4);
              v228 = 257;
              v119 = v5 + 24;
              v222 = *(unsigned __int64 **)(v5 - 32 * (v172 & 0x7FFFFFF));
              if ( v120 )
              {
                v207 = v120;
LABEL_190:
                v120 = *(_QWORD *)(v207 + 24);
              }
              v197 = v119;
              v121 = sub_BD2C40(88, 2u);
              v122 = (__int64)v121;
              if ( v121 )
              {
                v123 = (__int64)v121;
                sub_B44260((__int64)v121, **(_QWORD **)(v120 + 16), 56, 2u, v197, 0);
                *(_QWORD *)(v122 + 72) = 0;
                sub_B4A290(v122, v120, v207, (__int64 *)&v222, 1, (__int64)&v225, 0, 0);
              }
              else
              {
                v123 = 0;
              }
              v124 = sub_B9C770(v202, 0, 0, 0, 1);
              if ( *(_BYTE *)(a1 + 180) )
              {
                v125 = *(_DWORD *)(a1 + 176);
              }
              else
              {
                v125 = sub_B6ED60(**(__int64 ***)(a1 + 168), "clang.imprecise_release", 0x17u);
                *(_DWORD *)(a1 + 176) = v125;
                *(_BYTE *)(a1 + 180) = 1;
              }
              sub_B99FD0(v123, v125, v124);
              v126 = *(char **)(v5 - 32LL * (*(_DWORD *)(v5 + 4) & 0x7FFFFFF));
              if ( *(_QWORD *)(v5 + 16) )
              {
                a2 = *(_QWORD *)(v5 - 32LL * (*(_DWORD *)(v5 + 4) & 0x7FFFFFF));
                a3 = 4;
                sub_BD84D0(v5, a2);
                v127 = (_QWORD *)v5;
                v5 = v122;
                sub_B43D60(v127);
              }
              else
              {
                sub_B43D60((_QWORD *)v5);
                a2 = 0;
                v227[0] = 0;
                sub_F5CAB0(v126, 0, 0, (__int64)&v225);
                if ( v227[0] )
                {
                  a2 = (__int64)&v225;
                  ((void (__fastcall *)(_QWORD **, _QWORD **, __int64))v227[0])(&v225, &v225, 3);
                }
                v5 = v122;
                a3 = 4;
              }
              goto LABEL_46;
            }
            v23 = *(unsigned __int8 **)&v23[-32 * (*((_DWORD *)v23 + 1) & 0x7FFFFFF)];
            goto LABEL_272;
          }
          break;
        }
        if ( !(unsigned __int8)sub_270F130(v23, a2) )
          goto LABEL_46;
        v25 = v23;
        v26 = *((_QWORD *)v23 + 2);
        if ( !v26 )
          goto LABEL_188;
        v204 = a3;
        while ( 1 )
        {
          v27 = *(_QWORD *)(v26 + 24);
          if ( *(_QWORD *)(v27 + 16) )
            break;
          while ( 1 )
          {
            v29 = sub_BD3990((unsigned __int8 *)v27, a2);
            v28 = 23;
            v31 = v29;
            v32 = *v29;
            if ( v32 > 0x1Cu )
            {
              if ( v32 == 85 )
              {
                v33 = *((_QWORD *)v31 - 4);
                v28 = 21;
                if ( v33 && !*(_BYTE *)v33 && *(_QWORD *)(v33 + 24) == *((_QWORD *)v31 + 10) )
                  v28 = (unsigned int)sub_3108960(*((_QWORD *)v31 - 4), a2, v30);
              }
              else
              {
                v28 = 2 * (unsigned int)(v32 != 34) + 21;
              }
            }
            if ( !(unsigned __int8)sub_3108CA0(v28) )
              break;
            v27 = *(_QWORD *)&v31[-32 * (*((_DWORD *)v31 + 1) & 0x7FFFFFF)];
          }
          if ( v25 != v31 )
            break;
          v26 = *(_QWORD *)(v26 + 8);
          if ( !v26 )
            goto LABEL_188;
        }
        a3 = v204;
LABEL_46:
        if ( (unsigned __int8)sub_3108D30(a3, a2, v22) && (*(_WORD *)(v5 + 2) & 3) != 3 )
        {
          *(_BYTE *)a1 = 1;
          *(_WORD *)(v5 + 2) = *(_WORD *)(v5 + 2) & 0xFFFC | 1;
        }
        if ( (unsigned __int8)sub_3108D60(a3) )
        {
          *(_BYTE *)a1 = 1;
          *(_WORD *)(v5 + 2) &= 0xFFFCu;
          if ( (unsigned __int8)sub_3108D90(a3) )
            goto LABEL_93;
        }
        else
        {
          if ( !(unsigned __int8)sub_3108D90(a3) )
            goto LABEL_51;
LABEL_93:
          *(_BYTE *)a1 = 1;
          a2 = sub_BD5C60(v5);
          *(_QWORD *)(v5 + 72) = sub_A7A090((__int64 *)(v5 + 72), (__int64 *)a2, -1, 41);
        }
LABEL_51:
        v205 = sub_3108CD0(a3);
        if ( !v205 )
        {
          *(_DWORD *)(a1 + 212) |= 1 << a3;
          goto LABEL_90;
        }
        if ( !a4 )
        {
          for ( ii = *(unsigned __int8 **)(v5 - 32LL * (*(_DWORD *)(v5 + 4) & 0x7FFFFFF));
                ;
                ii = *(unsigned __int8 **)&a4[-32 * (*((_DWORD *)a4 + 1) & 0x7FFFFFF)] )
          {
            v103 = sub_BD3990(ii, a2);
            v102 = 23;
            a4 = v103;
            v105 = *v103;
            if ( v105 > 0x1Cu )
            {
              if ( v105 == 85 )
              {
                v106 = *((_QWORD *)a4 - 4);
                v102 = 21;
                if ( v106 && !*(_BYTE *)v106 && *(_QWORD *)(v106 + 24) == *((_QWORD *)a4 + 10) )
                  v102 = (unsigned int)sub_3108960(*((_QWORD *)a4 - 4), a2, v104);
              }
              else
              {
                v102 = 2 * (unsigned int)(v105 != 34) + 21;
              }
            }
            if ( !(unsigned __int8)sub_3108CA0(v102) )
              break;
          }
        }
        v34 = *a4;
        if ( (_BYTE)v34 == 20 || (unsigned int)(v34 - 12) <= 1 )
        {
LABEL_77:
          *(_BYTE *)a1 = 1;
          v56 = *(char **)(v5 - 32LL * (*(_DWORD *)(v5 + 4) & 0x7FFFFFF));
          if ( *(_QWORD *)(v5 + 16) )
          {
            sub_BD84D0(v5, *(_QWORD *)(v5 - 32LL * (*(_DWORD *)(v5 + 4) & 0x7FFFFFF)));
            sub_B43D60((_QWORD *)v5);
          }
          else
          {
            sub_B43D60((_QWORD *)v5);
            v227[0] = 0;
            sub_F5CAB0(v56, 0, 0, (__int64)&v225);
            if ( v227[0] )
              ((void (__fastcall *)(_QWORD **, _QWORD **, __int64))v227[0])(&v225, &v225, 3);
          }
          goto LABEL_90;
        }
        v35 = a1;
        *(_DWORD *)(a1 + 212) |= 1 << a3;
        if ( a3 == 4 )
        {
          if ( *(_BYTE *)(a1 + 180) )
          {
            v35 = *(unsigned int *)(a1 + 176);
          }
          else
          {
            v179 = sub_B6ED60(**(__int64 ***)(a1 + 168), "clang.imprecise_release", 0x17u);
            *(_BYTE *)(a1 + 180) = 1;
            *(_DWORD *)(a1 + 176) = v179;
            v35 = v179;
          }
          if ( (_DWORD)v35 )
          {
            if ( (*(_BYTE *)(v5 + 7) & 0x20) == 0 )
              goto LABEL_90;
            v107 = sub_B91C10(v5, v35);
          }
          else
          {
            v107 = *(_QWORD *)(v5 + 48);
          }
          if ( !v107 )
            goto LABEL_90;
        }
        v36 = v227;
        v227[0] = v5;
        v226 = 0x400000001LL;
        v37 = 1;
        v225 = v227;
        v227[1] = a4;
        v195 = a3;
        while ( 1 )
        {
          v38 = v37--;
          v39 = &v36[2 * v38 - 2];
          v40 = v39[1];
          v41 = *v39;
          LODWORD(v226) = v37;
          if ( *(_BYTE *)v40 == 84 && (*(_DWORD *)(v40 + 4) & 0x7FFFFFF) != 0 )
            break;
LABEL_57:
          if ( !v37 )
          {
            if ( v36 != v227 )
              _libc_free((unsigned __int64)v36);
            goto LABEL_90;
          }
        }
        v199 = v41;
        v42 = 0;
        v43 = 8LL * (*(_DWORD *)(v40 + 4) & 0x7FFFFFF);
        v44 = 0;
        while ( 2 )
        {
          v45 = *(unsigned __int8 **)(*(_QWORD *)(v40 - 8) + 4 * v42);
LABEL_65:
          v47 = sub_BD3990(v45, v35);
          v46 = 23;
          v49 = v47;
          v50 = *v47;
          if ( v50 > 0x1Cu )
          {
            if ( v50 == 85 )
            {
              v51 = *((_QWORD *)v49 - 4);
              v46 = 21;
              if ( v51 && !*(_BYTE *)v51 && *(_QWORD *)(v51 + 24) == *((_QWORD *)v49 + 10) )
              {
                v52 = sub_3108960(*((_QWORD *)v49 - 4), v35, v48);
                if ( !(unsigned __int8)sub_3108CA0(v52) )
                {
LABEL_71:
                  v53 = *v49;
                  if ( (_BYTE)v53 == 20 || (unsigned int)(v53 - 12) <= 1 )
                  {
                    v44 = v205;
                    goto LABEL_74;
                  }
                  v82 = *(_QWORD *)(*(_QWORD *)(v40 - 8) + 32LL * *(unsigned int *)(v40 + 72) + v42);
                  v83 = *(_QWORD *)(v82 + 48) & 0xFFFFFFFFFFFFFFF8LL;
                  if ( v83 == v82 + 48 )
                  {
                    v85 = 0;
                  }
                  else
                  {
                    if ( !v83 )
                      BUG();
                    v84 = *(unsigned __int8 *)(v83 - 24);
                    v85 = 0;
                    v86 = v83 - 24;
                    if ( (unsigned int)(v84 - 30) < 0xB )
                      v85 = v86;
                  }
                  if ( (unsigned int)sub_B46E30(v85) != 1 )
                  {
LABEL_125:
                    v37 = v226;
                    v36 = v225;
                    goto LABEL_57;
                  }
LABEL_74:
                  v42 += 8;
                  if ( v43 != v42 )
                    continue;
                  v54 = v44;
                  v55 = v199;
                  if ( !v54 )
                    goto LABEL_125;
                  switch ( v195 )
                  {
                    case 0u:
                    case 3u:
                      v108 = 0;
                      goto LABEL_171;
                    case 1u:
                    case 2u:
                    case 6u:
                      goto LABEL_125;
                    case 4u:
                      v35 = v40;
                      v108 = sub_3181950(0, v40, *(_QWORD *)(v199 + 40), v199, a1 + 8);
                      goto LABEL_171;
                    case 5u:
                      v35 = v40;
                      v108 = sub_3181950(1, v40, *(_QWORD *)(v199 + 40), v199, a1 + 8);
LABEL_171:
                      if ( v108 != v40 )
                        goto LABEL_125;
                      v201 = 0;
                      *(_BYTE *)a1 = 1;
                      v109 = *(_DWORD *)(v55 + 4);
                      v190 = *(_QWORD *)(*(_QWORD *)(v55 - 32LL * (v109 & 0x7FFFFFF)) + 8LL);
                      v192 = 8LL * (*(_DWORD *)(v40 + 4) & 0x7FFFFFF);
                      v110 = v224;
                      if ( (*(_DWORD *)(v40 + 4) & 0x7FFFFFF) == 0 )
                        goto LABEL_203;
                      v194 = v40;
                      break;
                    default:
                      BUG();
                  }
                  while ( 2 )
                  {
                    for ( jj = *(unsigned __int8 **)(*(_QWORD *)(v194 - 8) + 4 * v201);
                          ;
                          jj = *(unsigned __int8 **)&v115[-32 * (*((_DWORD *)v115 + 1) & 0x7FFFFFF)] )
                    {
                      v113 = sub_BD3990(jj, (__int64)v110);
                      v112 = 23;
                      v115 = v113;
                      v116 = *v113;
                      if ( v116 > 0x1Cu )
                      {
                        if ( v116 == 85 )
                        {
                          v117 = *((_QWORD *)v115 - 4);
                          v112 = 21;
                          if ( v117 && !*(_BYTE *)v117 && *(_QWORD *)(v117 + 24) == *((_QWORD *)v115 + 10) )
                            v112 = (unsigned int)sub_3108960(*((_QWORD *)v115 - 4), v110, v114);
                        }
                        else
                        {
                          v112 = 2 * (unsigned int)(v116 != 34) + 21;
                        }
                      }
                      if ( !(unsigned __int8)sub_3108CA0(v112) )
                        break;
                    }
                    v128 = *v115;
                    if ( (_BYTE)v128 == 20 || (unsigned int)(v128 - 12) <= 1 )
                    {
LABEL_201:
                      v201 += 8;
                      if ( v192 == v201 )
                      {
                        v109 = *(_DWORD *)(v55 + 4);
LABEL_203:
                        v129 = -32LL * (v109 & 0x7FFFFFF);
                        v130 = *(char **)(v55 + v129);
                        if ( *(_QWORD *)(v55 + 16) )
                        {
                          v35 = *(_QWORD *)(v55 + v129);
                          sub_BD84D0(v55, v35);
                          sub_B43D60((_QWORD *)v55);
                        }
                        else
                        {
                          sub_B43D60((_QWORD *)v55);
                          v35 = 0;
                          v224[0] = 0;
                          sub_F5CAB0(v130, 0, 0, (__int64)&v222);
                          if ( v224[0] )
                          {
                            v35 = (__int64)&v222;
                            ((void (__fastcall *)(unsigned __int64 **, unsigned __int64 **, __int64))v224[0])(
                              &v222,
                              &v222,
                              3);
                          }
                        }
                        goto LABEL_125;
                      }
                      continue;
                    }
                    break;
                  }
                  v134 = *(_QWORD *)(v194 - 8);
                  v191 = *(_QWORD *)(v134 + 4 * v201);
                  v135 = *(_QWORD *)(*(_QWORD *)(32LL * *(unsigned int *)(v194 + 72) + v134 + v201) + 48LL)
                       & 0xFFFFFFFFFFFFFFF8LL;
                  v136 = v135 - 24;
                  if ( !v135 )
                    v136 = 0;
                  v189 = v136;
                  v188 = (unsigned __int64 *)(v136 + 24);
                  v222 = v224;
                  v223 = 0x100000000LL;
                  if ( *(char *)(v55 + 7) < 0 )
                  {
                    v137 = sub_BD2BC0(v55);
                    v140 = v137 + v139;
                    if ( *(char *)(v55 + 7) >= 0 )
                      v141 = v140 >> 4;
                    else
                      LODWORD(v141) = (v140 - sub_BD2BC0(v55)) >> 4;
                    v198 = 16LL * (unsigned int)v141;
                    if ( (_DWORD)v141 )
                    {
                      v187 = v115;
                      v142 = 0;
                      v143 = v55;
                      while ( 1 )
                      {
                        v144 = 0;
                        if ( *(char *)(v143 + 7) < 0 )
                          v144 = sub_BD2BC0(v143);
                        v145 = (unsigned int *)(v142 + v144);
                        v146 = *(_QWORD *)v145;
                        v147 = v145[3];
                        if ( *(_DWORD *)(*(_QWORD *)v145 + 8LL) == 1 )
                          goto LABEL_238;
                        v148 = 32LL * v145[2];
                        v149 = v223;
                        v196 = 32LL * v147 - v148;
                        v150 = (char *)(v143 + v148 - 32LL * (*(_DWORD *)(v143 + 4) & 0x7FFFFFF));
                        if ( HIDWORD(v223) <= (unsigned int)v223 )
                        {
                          v186 = v146;
                          v193 = (__m128i *)sub_C8D7D0((__int64)&v222, (__int64)v224, 0, 0x38u, &v211, v138);
                          v173 = &v193->m128i_i8[56 * (unsigned int)v223];
                          if ( v173 )
                          {
                            *((_QWORD *)v173 + 1) = 0;
                            *(_QWORD *)v173 = v173 + 16;
                            v173[16] = 0;
                            *((_QWORD *)v173 + 4) = 0;
                            *((_QWORD *)v173 + 5) = 0;
                            *((_QWORD *)v173 + 6) = 0;
                            v174 = v186 + 16 + *(_QWORD *)v186;
                            v218 = (char *)src;
                            sub_270E4F0((__int64 *)&v218, (_BYTE *)(v186 + 16), v174);
                            v175 = *(char **)v173;
                            v176 = *(char **)v173;
                            if ( v218 == (char *)src )
                            {
                              v184 = n;
                              if ( n )
                              {
                                if ( n == 1 )
                                  *v175 = src[0];
                                else
                                  memcpy(v175, src, n);
                                v175 = *(char **)v173;
                                v184 = n;
                              }
                              *((_QWORD *)v173 + 1) = v184;
                              v175[v184] = 0;
                              v176 = v218;
                            }
                            else
                            {
                              if ( v173 + 16 == v175 )
                              {
                                *(_QWORD *)v173 = v218;
                                *((_QWORD *)v173 + 1) = n;
                                *((_QWORD *)v173 + 2) = src[0];
                              }
                              else
                              {
                                *(_QWORD *)v173 = v218;
                                v177 = *((_QWORD *)v173 + 2);
                                *((_QWORD *)v173 + 1) = n;
                                *((_QWORD *)v173 + 2) = src[0];
                                if ( v175 )
                                {
                                  v218 = v175;
                                  src[0] = v177;
                                  goto LABEL_292;
                                }
                              }
                              v218 = (char *)src;
                              v176 = (char *)src;
                            }
LABEL_292:
                            n = 0;
                            *v176 = 0;
                            if ( v218 != (char *)src )
                              j_j___libc_free_0((unsigned __int64)v218);
                            sub_270E1D0((__int64)(v173 + 32), *((char **)v173 + 5), v150, &v150[v196]);
                          }
                          sub_B56820((__int64)&v222, v193);
                          v178 = v211;
                          if ( v222 != v224 )
                            _libc_free((unsigned __int64)v222);
                          LODWORD(v223) = v223 + 1;
                          HIDWORD(v223) = v178;
                          v222 = (unsigned __int64 *)v193;
                          goto LABEL_238;
                        }
                        v151 = &v222[7 * (unsigned int)v223];
                        if ( v151 )
                          break;
LABEL_237:
                        LODWORD(v223) = v149 + 1;
LABEL_238:
                        v142 += 16;
                        if ( v142 == v198 )
                        {
                          v115 = v187;
                          v55 = v143;
                          goto LABEL_240;
                        }
                      }
                      v151[1] = 0;
                      *v151 = (unsigned __int64)(v151 + 2);
                      *((_BYTE *)v151 + 16) = 0;
                      v151[4] = 0;
                      v151[5] = 0;
                      v151[6] = 0;
                      v152 = v146 + 16 + *(_QWORD *)v146;
                      v218 = (char *)src;
                      sub_270E4F0((__int64 *)&v218, (_BYTE *)(v146 + 16), v152);
                      v153 = (unsigned __int64 *)*v151;
                      if ( v218 == (char *)src )
                      {
                        v171 = n;
                        if ( n )
                        {
                          if ( n == 1 )
                            *(_BYTE *)v153 = src[0];
                          else
                            memcpy(v153, src, n);
                          v171 = n;
                          v153 = (unsigned __int64 *)*v151;
                        }
                        v151[1] = v171;
                        *((_BYTE *)v153 + v171) = 0;
                        v153 = (unsigned __int64 *)v218;
                        goto LABEL_234;
                      }
                      if ( v151 + 2 == v153 )
                      {
                        *v151 = (unsigned __int64)v218;
                        v151[1] = n;
                        v151[2] = src[0];
                      }
                      else
                      {
                        *v151 = (unsigned __int64)v218;
                        v154 = v151[2];
                        v151[1] = n;
                        v151[2] = src[0];
                        if ( v153 )
                        {
                          v218 = (char *)v153;
                          src[0] = v154;
LABEL_234:
                          n = 0;
                          *(_BYTE *)v153 = 0;
                          if ( v218 != (char *)src )
                            j_j___libc_free_0((unsigned __int64)v218);
                          sub_270E1D0((__int64)(v151 + 4), (char *)v151[5], v150, &v150[v196]);
                          v149 = v223;
                          goto LABEL_237;
                        }
                      }
                      v218 = (char *)src;
                      v153 = src;
                      goto LABEL_234;
                    }
                  }
LABEL_240:
                  if ( *(_DWORD *)(a1 + 232) )
                    sub_2710050(a1, *(_QWORD *)(v189 + 40), (__int64)&v222);
                  v155 = sub_B4A5D0((unsigned __int8 *)v55, (__int64)v222, (unsigned int)v223, 0, 0);
                  if ( v190 != *(_QWORD *)(v191 + 8) )
                  {
                    v221 = 257;
                    v156 = sub_BD2C40(72, unk_3F10A14);
                    v157 = v156;
                    if ( v156 )
                      sub_B51BF0((__int64)v156, v191, v190, (__int64)&v218, (__int64)v188, 0);
                    v158 = v155 - 32LL * (*(_DWORD *)(v155 + 4) & 0x7FFFFFF);
                    if ( *(_QWORD *)v158 )
                    {
                      v159 = *(_QWORD *)(v158 + 8);
                      **(_QWORD **)(v158 + 16) = v159;
                      if ( v159 )
LABEL_247:
                        *(_QWORD *)(v159 + 16) = *(_QWORD *)(v158 + 16);
                    }
                    *(_QWORD *)v158 = v157;
                    if ( v157 )
                    {
LABEL_249:
                      v160 = v157[2];
                      *(_QWORD *)(v158 + 8) = v160;
                      if ( v160 )
                        *(_QWORD *)(v160 + 16) = v158 + 8;
                      *(_QWORD *)(v158 + 16) = v157 + 2;
                      v157[2] = v158;
                    }
                    v110 = *(_QWORD **)(v189 + 40);
                    sub_B44150((_QWORD *)v155, (__int64)v110, v188, 0);
                    v163 = (unsigned int)v226;
                    v164 = (unsigned int)v226 + 1LL;
                    if ( v164 > HIDWORD(v226) )
                    {
                      v110 = v227;
                      sub_C8D5F0((__int64)&v225, v227, v164, 0x10u, v161, v162);
                      v163 = (unsigned int)v226;
                    }
                    v165 = &v225[2 * v163];
                    *v165 = v155;
                    v165[1] = (__int64)v115;
                    v166 = (__int64)v222;
                    LODWORD(v226) = v226 + 1;
                    v167 = &v222[7 * (unsigned int)v223];
                    if ( v222 != v167 )
                    {
                      do
                      {
                        v168 = *(v167 - 3);
                        v167 -= 7;
                        if ( v168 )
                        {
                          v110 = (_QWORD *)(v167[6] - v168);
                          j_j___libc_free_0(v168);
                        }
                        if ( (unsigned __int64 *)*v167 != v167 + 2 )
                        {
                          v110 = (_QWORD *)(v167[2] + 1);
                          j_j___libc_free_0(*v167);
                        }
                      }
                      while ( (unsigned __int64 *)v166 != v167 );
                      v167 = v222;
                    }
                    if ( v167 != v224 )
                      _libc_free((unsigned __int64)v167);
                    goto LABEL_201;
                  }
                  v158 = v155 - 32LL * (*(_DWORD *)(v155 + 4) & 0x7FFFFFF);
                  if ( *(_QWORD *)v158 )
                  {
                    v159 = *(_QWORD *)(v158 + 8);
                    v157 = (_QWORD *)v191;
                    **(_QWORD **)(v158 + 16) = v159;
                    if ( v159 )
                      goto LABEL_247;
                    *(_QWORD *)v158 = v191;
                  }
                  else
                  {
                    *(_QWORD *)v158 = v191;
                    v157 = (_QWORD *)v191;
                  }
                  goto LABEL_249;
                }
LABEL_64:
                v45 = *(unsigned __int8 **)&v49[-32 * (*((_DWORD *)v49 + 1) & 0x7FFFFFF)];
                goto LABEL_65;
              }
            }
            else
            {
              v46 = 2 * (unsigned int)(v50 != 34) + 21;
            }
          }
          break;
        }
        if ( !(unsigned __int8)sub_3108CA0(v46) )
          goto LABEL_71;
        goto LABEL_64;
      }
    }
    v200 = v87;
    v206 = v90;
    v99 = sub_3108960(v98, a2, v92);
    v90 = v206;
    v87 = v200;
    if ( v99 == 1 )
    {
LABEL_142:
      if ( v225 != v87 )
        _libc_free((unsigned __int64)v225);
      goto LABEL_27;
    }
    v95 = *v94;
LABEL_134:
    if ( v95 == 78 )
    {
      v96 = (unsigned int)v226;
      v97 = (unsigned int)v226 + 1LL;
      if ( v97 > HIDWORD(v226) )
      {
        a2 = (__int64)v87;
        v203 = v87;
        v208 = v90;
        sub_C8D5F0((__int64)v90, v87, v97, 8u, (__int64)v90, (__int64)v87);
        v96 = (unsigned int)v226;
        v87 = v203;
        v90 = v208;
      }
      v92 = (unsigned __int64)v225;
      v225[v96] = v94;
      LODWORD(v226) = v226 + 1;
    }
    goto LABEL_138;
  }
  if ( *(_BYTE *)(*(_QWORD *)(v5 + 8) + 8LL) != 7 )
  {
    if ( (*(_BYTE *)(v5 + 7) & 0x40) != 0 )
      v100 = *(__int64 **)(v5 - 8);
    else
      v100 = (__int64 *)(v5 - 32LL * (*(_DWORD *)(v5 + 4) & 0x7FFFFFF));
    sub_BD84D0(v5, *v100);
  }
  sub_B43D60((_QWORD *)v5);
  *(_BYTE *)a1 = 1;
LABEL_90:
  if ( !v216 )
    _libc_free((unsigned __int64)v213);
}

// Function: sub_3928080
// Address: 0x3928080
//
__int64 __fastcall sub_3928080(__int64 a1, __int64 a2, _QWORD *a3)
{
  __int64 v3; // r15
  _QWORD *v4; // rbx
  __int64 v5; // rax
  __int64 *v6; // r9
  __int64 *v7; // rax
  __int64 v8; // rdx
  __int64 v9; // rcx
  __int64 v10; // rsi
  __int64 *v11; // rax
  __int64 *i; // r9
  __int64 v13; // rcx
  __int64 v14; // rsi
  _QWORD *v15; // r13
  unsigned __int64 v16; // r12
  unsigned int v17; // ebx
  __int64 v18; // rax
  int v19; // r9d
  unsigned int v20; // r8d
  unsigned __int64 v21; // rcx
  __int64 v22; // r14
  _DWORD *v23; // rdx
  _DWORD *v24; // r14
  __int64 v25; // rax
  unsigned int v26; // r10d
  _DWORD *v27; // rcx
  __int64 v28; // r9
  char *v29; // rdx
  unsigned __int64 v30; // rdi
  char *v31; // rax
  __int64 v32; // rsi
  char *v33; // rdx
  unsigned int v34; // eax
  unsigned int v35; // esi
  __int64 v36; // r8
  _DWORD *v37; // rdi
  char *v38; // r9
  __int64 *v39; // rsi
  __int64 *v40; // rax
  __int64 v41; // rdx
  __int64 v42; // rcx
  int v43; // ecx
  __int64 v44; // rdx
  __int64 v45; // rdx
  __int64 v46; // rbx
  __int64 v47; // r13
  unsigned __int64 v48; // r12
  _QWORD *v49; // r15
  __int64 v50; // rsi
  unsigned __int64 v51; // rax
  __int64 v52; // r13
  __int64 v53; // rbx
  unsigned __int64 v54; // r12
  _QWORD *v55; // r15
  __int64 v56; // rsi
  unsigned __int64 v57; // rax
  char *v58; // r8
  int v59; // r9d
  char **v60; // rbx
  char **v61; // r13
  char *v62; // r15
  size_t v63; // rdx
  char *v64; // r14
  unsigned __int64 v65; // rax
  unsigned __int64 v66; // rax
  char *v67; // rdx
  char v68; // cl
  const void ***v69; // r13
  const void ***v70; // rbx
  char *v71; // r14
  __int64 v72; // rsi
  unsigned __int64 v73; // rax
  int v74; // eax
  const void **v75; // r12
  size_t v76; // r15
  __int64 v77; // rdx
  __int64 v78; // rax
  __int64 k; // rsi
  __int64 v80; // rdx
  __int64 *v81; // r12
  __int64 *m; // rbx
  __int64 v83; // r13
  __int64 v84; // rax
  int v85; // eax
  __int64 v86; // rdx
  _DWORD *v87; // rbx
  int v88; // r12d
  __int64 v89; // rax
  __int64 v90; // r14
  __int64 *v91; // r15
  __int64 v92; // r10
  unsigned int v93; // r9d
  __int64 *v94; // rax
  __int64 v95; // r8
  __int64 v96; // rbx
  int v97; // eax
  int v98; // esi
  unsigned int v99; // r12d
  __int64 v100; // rdi
  __int64 v101; // rax
  __int64 v102; // rax
  unsigned int v103; // esi
  __int64 v104; // r13
  int v105; // esi
  int v106; // esi
  __int64 v107; // r9
  __int64 v108; // rcx
  int v109; // eax
  __int64 *v110; // rdi
  __int64 v111; // r8
  __int64 v112; // rsi
  _DWORD *v113; // rcx
  unsigned __int64 v114; // rdx
  unsigned __int64 v115; // rdx
  signed __int64 v116; // r9
  unsigned int v117; // esi
  __int64 v118; // r8
  const void *v119; // rsi
  char *v120; // rdi
  __int64 v121; // rdx
  __int64 v122; // rdi
  __int16 v123; // ax
  __int16 v124; // cx
  int v125; // eax
  __int64 v126; // rdi
  __int16 v127; // cx
  unsigned int v128; // eax
  __int64 v129; // rdi
  unsigned __int32 v130; // ecx
  unsigned int v131; // eax
  __int64 v132; // rdi
  unsigned __int32 v133; // ecx
  unsigned int v134; // eax
  __int64 v135; // rdi
  unsigned __int32 v136; // ecx
  __int16 v137; // ax
  __int64 v138; // rdi
  __int16 v139; // cx
  __int16 v140; // ax
  __int64 v141; // rdi
  __int64 v142; // rsi
  __int16 v143; // cx
  __int64 *v144; // r9
  char *v145; // r14
  __int64 *v146; // r12
  char *v147; // r8
  char *v148; // r15
  __int64 *v149; // rbx
  __int64 v150; // rdx
  signed __int64 v151; // r11
  __int64 v152; // rax
  bool v153; // cf
  unsigned __int64 v154; // rax
  unsigned __int64 v155; // r13
  __int64 v156; // rax
  char *v157; // r10
  unsigned __int64 v158; // r13
  char *v159; // rcx
  char *v160; // r13
  __int64 v161; // r12
  unsigned __int64 v162; // rax
  char *v163; // r12
  __int64 v164; // rdx
  __int64 v165; // rcx
  __int64 v166; // rax
  __int64 v167; // r12
  unsigned int v168; // eax
  __int64 v169; // rdi
  unsigned __int32 v170; // esi
  unsigned int v171; // eax
  __int64 v172; // rdi
  unsigned __int32 v173; // esi
  unsigned int v174; // eax
  __int64 v175; // rdi
  unsigned __int32 v176; // esi
  unsigned int v177; // eax
  __int64 v178; // rdi
  unsigned __int32 v179; // esi
  unsigned int v180; // eax
  __int64 v181; // rdi
  unsigned __int32 v182; // esi
  unsigned int v183; // eax
  __int64 v184; // rdi
  unsigned __int32 v185; // esi
  __int16 v186; // ax
  __int64 v187; // rdi
  __int16 v188; // si
  __int16 v189; // ax
  __int64 v190; // rdi
  __int16 v191; // si
  unsigned int v192; // eax
  __int64 v193; // rdi
  unsigned __int32 v194; // esi
  __int64 *v195; // r14
  __int64 v196; // r9
  int v197; // r13d
  __int64 v198; // r13
  __int64 v199; // r12
  unsigned int v200; // eax
  __int64 v201; // rdi
  unsigned __int32 v202; // ecx
  unsigned int v203; // eax
  __int64 v204; // rdi
  unsigned __int32 v205; // ecx
  __int16 v206; // ax
  __int64 v207; // rdi
  __int16 v208; // cx
  char *v209; // r13
  unsigned int v210; // eax
  __int64 v211; // rdi
  unsigned __int32 v212; // ecx
  unsigned int v213; // eax
  __int64 v214; // rdi
  unsigned __int32 v215; // ecx
  __int16 v216; // ax
  __int64 v217; // rdi
  __int16 v218; // cx
  __int64 v219; // rdi
  char v220; // si
  char *v221; // rax
  __int64 v222; // rdi
  char v223; // si
  char *v224; // rax
  __int64 v225; // rcx
  __int64 v226; // r13
  __int64 v227; // r14
  __int64 v228; // rdi
  int v229; // ebx
  int v230; // eax
  int v231; // esi
  int v232; // esi
  __int64 *v233; // r10
  __int64 v234; // r9
  int v235; // edx
  __int64 v236; // rcx
  __int64 v237; // r8
  __int64 v238; // rdi
  __int64 v239; // rdi
  __int16 v240; // ax
  __int64 v241; // rdi
  __int16 v242; // cx
  unsigned int v243; // eax
  __int64 v244; // rdi
  unsigned __int32 v245; // ecx
  __int64 v246; // rdi
  __int64 v247; // rdi
  __int64 v248; // rdi
  __int64 v249; // rdi
  unsigned int v250; // eax
  __int64 v251; // rdi
  unsigned __int32 v252; // ecx
  unsigned int v253; // eax
  __int64 v254; // rdi
  unsigned __int32 v255; // ecx
  unsigned int v256; // eax
  __int64 v257; // rdi
  unsigned __int32 v258; // ecx
  __int64 v259; // rax
  unsigned int v260; // eax
  unsigned __int32 v261; // esi
  unsigned int v262; // eax
  __int64 v263; // rdi
  unsigned __int32 v264; // esi
  _QWORD *v265; // rbx
  __int16 v267; // ax
  __int64 v268; // rdi
  __int16 v269; // si
  unsigned int v270; // eax
  __int64 v271; // rdi
  unsigned int v272; // edx
  unsigned __int32 v273; // esi
  unsigned int v274; // eax
  unsigned __int32 v275; // esi
  unsigned int v276; // eax
  __int64 v277; // rdi
  unsigned __int32 v278; // esi
  unsigned int v279; // eax
  __int64 v280; // rdi
  unsigned __int32 v281; // esi
  unsigned int v282; // eax
  unsigned __int32 v283; // esi
  __int16 v284; // ax
  __int64 v285; // rdi
  __int16 v286; // si
  __int16 v287; // ax
  __int64 v288; // rdi
  __int16 v289; // si
  unsigned int v290; // eax
  __int64 v291; // rdi
  unsigned __int32 v292; // esi
  int v293; // eax
  __int64 v294; // rdi
  __int16 v295; // si
  __int64 v296; // rdi
  char v297; // si
  char *v298; // rax
  __int16 v299; // ax
  __int64 v300; // rdi
  __int16 v301; // si
  __int64 v302; // r12
  int v303; // eax
  int v304; // r13d
  __int64 v305; // r10
  __int64 v306; // rcx
  _QWORD *v307; // rax
  __int64 v308; // rdi
  __int64 v309; // rax
  int v310; // eax
  __int64 v311; // rdi
  __int16 v312; // cx
  __int64 v313; // rdi
  unsigned int v314; // eax
  unsigned __int32 v315; // ecx
  __int64 v316; // rdi
  __int64 v317; // rdi
  char *v318; // rax
  time_t v319; // rax
  __int64 *v320; // rdx
  _QWORD *v321; // rdx
  int v322; // eax
  int v323; // eax
  int v324; // eax
  int v325; // r11d
  __int64 v326; // r8
  unsigned int v327; // ecx
  __int64 v328; // r10
  int v329; // edi
  int v330; // eax
  int v331; // r11d
  unsigned int v332; // ecx
  int v333; // edi
  __int64 v334; // r10
  int v335; // edx
  __int64 v336; // rax
  char *v337; // rdx
  int v338; // [rsp+Ch] [rbp-184h]
  unsigned int v339; // [rsp+Ch] [rbp-184h]
  __int64 v340; // [rsp+10h] [rbp-180h]
  __int64 v341; // [rsp+18h] [rbp-178h]
  __int64 v342; // [rsp+20h] [rbp-170h]
  __int64 v343; // [rsp+20h] [rbp-170h]
  __int64 v344; // [rsp+20h] [rbp-170h]
  __int64 *v345; // [rsp+20h] [rbp-170h]
  _DWORD *v346; // [rsp+28h] [rbp-168h]
  __int64 v347; // [rsp+28h] [rbp-168h]
  __int64 v348; // [rsp+28h] [rbp-168h]
  __int64 v349; // [rsp+28h] [rbp-168h]
  char *v350; // [rsp+30h] [rbp-160h]
  size_t v352; // [rsp+40h] [rbp-150h]
  __int64 v354; // [rsp+50h] [rbp-140h]
  __int64 v355; // [rsp+50h] [rbp-140h]
  __int64 *v356; // [rsp+50h] [rbp-140h]
  unsigned int v357; // [rsp+50h] [rbp-140h]
  char *v358; // [rsp+50h] [rbp-140h]
  char *v359; // [rsp+50h] [rbp-140h]
  __int64 v360; // [rsp+58h] [rbp-138h]
  __int64 v361; // [rsp+58h] [rbp-138h]
  __int64 *v362; // [rsp+58h] [rbp-138h]
  char **v363; // [rsp+58h] [rbp-138h]
  unsigned int v364; // [rsp+58h] [rbp-138h]
  _QWORD *j; // [rsp+60h] [rbp-130h]
  __int64 v366; // [rsp+60h] [rbp-130h]
  unsigned __int64 v367; // [rsp+68h] [rbp-128h]
  __int64 v368; // [rsp+68h] [rbp-128h]
  __int64 v369; // [rsp+68h] [rbp-128h]
  __int64 v370; // [rsp+68h] [rbp-128h]
  __int64 v371; // [rsp+68h] [rbp-128h]
  __int64 *v372; // [rsp+68h] [rbp-128h]
  _BYTE *v373; // [rsp+68h] [rbp-128h]
  __int64 v374; // [rsp+68h] [rbp-128h]
  char *v375; // [rsp+68h] [rbp-128h]
  __int64 *v376; // [rsp+68h] [rbp-128h]
  char **ii; // [rsp+68h] [rbp-128h]
  __int64 v378; // [rsp+68h] [rbp-128h]
  unsigned __int64 v379; // [rsp+78h] [rbp-118h] BYREF
  void *src; // [rsp+80h] [rbp-110h] BYREF
  size_t n; // [rsp+88h] [rbp-108h]
  _BYTE v382[16]; // [rsp+90h] [rbp-100h] BYREF
  char *v383; // [rsp+A0h] [rbp-F0h] BYREF
  __int64 v384; // [rsp+A8h] [rbp-E8h]
  __int64 v385; // [rsp+B0h] [rbp-E0h]
  __int64 v386; // [rsp+B8h] [rbp-D8h]
  int v387; // [rsp+C0h] [rbp-D0h]
  char **v388; // [rsp+C8h] [rbp-C8h]
  char *v389; // [rsp+D0h] [rbp-C0h] BYREF
  __int64 v390; // [rsp+D8h] [rbp-B8h]
  _WORD v391[88]; // [rsp+E0h] [rbp-B0h] BYREF

  v3 = a1;
  v4 = *(_QWORD **)(a1 + 8);
  v5 = (*(__int64 (__fastcall **)(_QWORD *))(*v4 + 64LL))(v4);
  v6 = *(__int64 **)(a1 + 64);
  v341 = v5;
  v340 = v4[3] - v4[1];
  v7 = *(__int64 **)(a1 + 56);
  if ( (unsigned __int64)((char *)v6 - (char *)v7) > 0x3FFFFFFF8LL )
    sub_16BD130("PE COFF object files can't have more than 2147483647 sections", 1u);
  *(_DWORD *)(a1 + 36) = v6 - v7;
  *(_DWORD *)(a1 + 48) = 0;
  *(_BYTE *)(a1 + 224) = (unsigned __int64)((char *)v6 - (char *)v7) > 0x7F7F8;
  if ( v7 != v6 )
  {
    v8 = 1;
    do
    {
      v9 = *v7;
      v10 = *(_QWORD *)(*v7 + 88);
      if ( *(_BYTE *)(*(_QWORD *)(v10 + 56) + 20LL) != 5 )
      {
        *(_DWORD *)(v9 + 72) = v8;
        *(_DWORD *)(v10 + 12) = v8;
        *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v9 + 88) + 56LL) + 16LL) = v8++;
      }
      ++v7;
    }
    while ( v6 != v7 );
    v11 = *(__int64 **)(a1 + 56);
    for ( i = *(__int64 **)(a1 + 64); i != v11; ++v8 )
    {
      while ( 1 )
      {
        v13 = *v11;
        v14 = *(_QWORD *)(*v11 + 88);
        if ( *(_BYTE *)(*(_QWORD *)(v14 + 56) + 20LL) == 5 )
          break;
        if ( i == ++v11 )
          goto LABEL_12;
      }
      *(_DWORD *)(v13 + 72) = v8;
      ++v11;
      *(_DWORD *)(v14 + 12) = v8;
      *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v13 + 88) + 56LL) + 16LL) = v8;
    }
  }
LABEL_12:
  v15 = *(_QWORD **)(a2 + 152);
  for ( j = *(_QWORD **)(a2 + 160); j != v15; v15 += 4 )
  {
    v16 = (-(__int64)(*(_BYTE *)(v3 + 224) == 0) & 0xFFFFFFFFFFFFFFFELL) + 20;
    v17 = *(_BYTE *)(v3 + 224) == 0 ? 18 : 20;
    v367 = (v16 + v15[1] - 1) / v16;
    v18 = sub_3925260((_QWORD *)v3, ".file", 5u);
    v20 = v367;
    v21 = *(unsigned int *)(v18 + 64);
    *(_DWORD *)(v18 + 12) = -2;
    v22 = (unsigned int)v367;
    *(_BYTE *)(v18 + 18) = 103;
    if ( (unsigned int)v367 >= v21 )
    {
      if ( (unsigned int)v367 > v21 )
      {
        if ( (unsigned int)v367 > (unsigned __int64)*(unsigned int *)(v18 + 68) )
        {
          v364 = v367;
          v378 = v18;
          sub_16CD150(v18 + 56, (const void *)(v18 + 72), v20, 24, v20, v19);
          v18 = v378;
          v20 = v364;
          v21 = *(unsigned int *)(v378 + 64);
        }
        v23 = *(_DWORD **)(v18 + 56);
        v112 = 6 * v22;
        v113 = &v23[6 * v21];
        v24 = &v23[6 * v22];
        if ( v113 != v24 )
        {
          do
          {
            if ( v113 )
            {
              *((_QWORD *)v113 + 2) = 0;
              *(_OWORD *)v113 = 0;
            }
            v113 += 6;
          }
          while ( v24 != v113 );
          v23 = *(_DWORD **)(v18 + 56);
          v24 = &v23[v112];
        }
        *(_DWORD *)(v18 + 64) = v20;
      }
      else
      {
        v23 = *(_DWORD **)(v18 + 56);
        v24 = &v23[6 * v21];
      }
    }
    else
    {
      v23 = *(_DWORD **)(v18 + 56);
      *(_DWORD *)(v18 + 64) = v367;
      v24 = &v23[6 * (unsigned int)v367];
    }
    v25 = v15[1];
    v26 = v25;
    if ( v24 != v23 )
    {
      *v23 = 3;
      v27 = v23 + 6;
      LODWORD(v28) = 0;
      if ( v17 >= (unsigned int)v25 )
      {
        v28 = 0;
LABEL_21:
        v37 = v23 + 1;
        v38 = (char *)(*v15 + v28);
        if ( v26 >= 8 )
        {
          v114 = (unsigned __int64)(v23 + 3);
          *(_QWORD *)(v114 - 8) = *(_QWORD *)v38;
          v115 = v114 & 0xFFFFFFFFFFFFFFF8LL;
          *(_QWORD *)((char *)v37 + v26 - 8) = *(_QWORD *)&v38[v26 - 8];
          v116 = v38 - ((char *)v37 - v115);
          if ( ((v26 + (_DWORD)v37 - (_DWORD)v115) & 0xFFFFFFF8) >= 8 )
          {
            v117 = 0;
            do
            {
              v118 = v117;
              v117 += 8;
              *(_QWORD *)(v115 + v118) = *(_QWORD *)(v116 + v118);
            }
            while ( v117 < ((v26 + (_DWORD)v37 - (_DWORD)v115) & 0xFFFFFFF8) );
          }
        }
        else if ( (v26 & 4) != 0 )
        {
          *v37 = *(_DWORD *)v38;
          *(_DWORD *)((char *)v23 + v26) = *(_DWORD *)&v38[v26 - 4];
        }
        else if ( v26 )
        {
          *(_BYTE *)v37 = *v38;
          if ( (v26 & 2) != 0 )
            *(_WORD *)((char *)v37 + v26 - 2) = *(_WORD *)&v38[v26 - 2];
        }
        memset((char *)v37 + v26, 0, v17 - v26);
      }
      else
      {
        while ( 1 )
        {
          v29 = (char *)(*v15 + (unsigned int)v28);
          v30 = (unsigned __int64)(v27 - 3) & 0xFFFFFFFFFFFFFFF8LL;
          v31 = (char *)v27 - v30 - 20;
          *(_QWORD *)(v27 - 5) = *(_QWORD *)v29;
          v32 = *(_QWORD *)&v29[(unsigned int)v16 - 8];
          v33 = (char *)(v29 - v31);
          v34 = (v16 + (_DWORD)v31) & 0xFFFFFFF8;
          *(_QWORD *)((char *)v27 + (unsigned int)v16 - 28) = v32;
          v35 = 0;
          do
          {
            v36 = v35;
            v35 += 8;
            *(_QWORD *)(v30 + v36) = *(_QWORD *)&v33[v36];
          }
          while ( v35 < v34 );
          v26 -= v17;
          v28 = v17 + (unsigned int)v28;
          v23 = v27;
          if ( v27 == v24 )
            break;
          *v27 = 3;
          v27 += 6;
          if ( v17 >= v26 )
            goto LABEL_21;
        }
      }
    }
  }
  v39 = *(__int64 **)(v3 + 88);
  v366 = v3 + 104;
  v40 = *(__int64 **)(v3 + 80);
  if ( v40 != v39 )
  {
    do
    {
      v41 = *v40;
      v42 = *(_QWORD *)(*v40 + 104);
      if ( v42 )
      {
        *(_DWORD *)(v41 + 12) = *(_DWORD *)(v42 + 72);
        v41 = *v40;
      }
      v43 = *(_DWORD *)(v3 + 48);
      *(_DWORD *)(v3 + 48) = v43 + 1;
      *(_DWORD *)(v41 + 48) = v43;
      v44 = *(_QWORD *)(v41 + 120);
      if ( v44 )
        *(_DWORD *)(v44 + 16) = v43;
      v45 = *v40++;
      *(_BYTE *)(v45 + 19) = *(_DWORD *)(v45 + 64);
      *(_DWORD *)(v3 + 48) += *(unsigned __int8 *)(*(v40 - 1) + 19);
    }
    while ( v39 != v40 );
    v46 = *(_QWORD *)(v3 + 56);
    v47 = *(_QWORD *)(v3 + 64);
    if ( v46 == v47 )
    {
LABEL_40:
      v52 = *(_QWORD *)(v3 + 88);
      v53 = *(_QWORD *)(v3 + 80);
      if ( v52 != v53 )
      {
        v369 = v3;
        do
        {
          while ( 1 )
          {
            v54 = *(unsigned int *)(*(_QWORD *)v53 + 32LL);
            if ( v54 > 8 )
              break;
            v53 += 8;
            if ( v52 == v53 )
              goto LABEL_45;
          }
          v55 = *(_QWORD **)(*(_QWORD *)v53 + 24LL);
          v56 = *(unsigned int *)(*(_QWORD *)v53 + 32LL);
          v53 += 8;
          v57 = sub_16D3930(v55, v56);
          sub_1680880(v366, (__int64)v55, v54 | (v57 << 32));
        }
        while ( v52 != v53 );
LABEL_45:
        v3 = v369;
      }
      goto LABEL_46;
    }
LABEL_35:
    v368 = v3;
    do
    {
      while ( 1 )
      {
        v48 = *(_QWORD *)(*(_QWORD *)v46 + 48LL);
        if ( v48 > 8 )
          break;
        v46 += 8;
        if ( v47 == v46 )
          goto LABEL_39;
      }
      v49 = *(_QWORD **)(*(_QWORD *)v46 + 40LL);
      v50 = *(_QWORD *)(*(_QWORD *)v46 + 48LL);
      v46 += 8;
      v51 = sub_16D3930(v49, v50);
      sub_1680880(v366, (__int64)v49, (v51 << 32) | (unsigned int)v48);
    }
    while ( v47 != v46 );
LABEL_39:
    v3 = v368;
    goto LABEL_40;
  }
  v46 = *(_QWORD *)(v3 + 56);
  v47 = *(_QWORD *)(v3 + 64);
  if ( v47 != v46 )
    goto LABEL_35;
LABEL_46:
  sub_1680590(v366);
  v60 = *(char ***)(v3 + 64);
  v61 = *(char ***)(v3 + 56);
  if ( v60 == v61 )
  {
    v69 = *(const void ****)(v3 + 80);
    v70 = *(const void ****)(v3 + 88);
    if ( v70 != v69 )
      goto LABEL_55;
    goto LABEL_72;
  }
  v354 = v3;
  do
  {
    while ( 1 )
    {
      while ( 1 )
      {
        v62 = *v61;
        v63 = *((_QWORD *)*v61 + 6);
        v64 = (char *)*((_QWORD *)*v61 + 5);
        if ( v63 > 8 )
          break;
        v119 = (const void *)*((_QWORD *)*v61 + 5);
        v120 = *v61++;
        memcpy(v120, v119, v63);
        if ( v60 == v61 )
          goto LABEL_54;
      }
      v370 = *((_QWORD *)*v61 + 6);
      v65 = sub_16D3930(*((_QWORD **)*v61 + 5), v370);
      v66 = sub_167FE60(v366, v64, (v65 << 32) | (unsigned int)v370);
      v379 = v66;
      if ( v66 > (unsigned __int64)&loc_98967F )
      {
        if ( v66 > 0xFFFFFFFFFLL )
          sub_16BD130("COFF string table is greater than 64 GB.", 1u);
        v67 = v62 + 7;
        v58 = v62 + 1;
        *(_WORD *)v62 = 12079;
        do
        {
          v68 = v66;
          --v67;
          v66 >>= 6;
          v67[1] = aAbcdefghijklmn_1[v68 & 0x3F];
        }
        while ( v67 != v58 );
        goto LABEL_53;
      }
      LOBYTE(v383) = 47;
      n = 0x800000000LL;
      src = v382;
      v389 = v383;
      v390 = (__int64)&v379;
      v391[0] = 2824;
      sub_16E2F40((__int64)&v389, (__int64)&src);
      v373 = src;
      memcpy(v62, src, (unsigned int)n);
      v59 = (int)v373;
      if ( v373 != v382 )
        break;
LABEL_53:
      if ( v60 == ++v61 )
        goto LABEL_54;
    }
    ++v61;
    _libc_free((unsigned __int64)v373);
  }
  while ( v60 != v61 );
LABEL_54:
  v3 = v354;
  v69 = *(const void ****)(v354 + 80);
  v70 = *(const void ****)(v354 + 88);
  if ( v70 != v69 )
  {
LABEL_55:
    v371 = v3;
    do
    {
      while ( 1 )
      {
        v75 = *v69;
        v76 = *((unsigned int *)*v69 + 8);
        if ( (unsigned int)v76 <= 8 )
          break;
        v71 = (char *)v75[3];
        v72 = *((unsigned int *)*v69++ + 8);
        v73 = sub_16D3930(v71, v72);
        v74 = sub_167FE60(v366, v71, v76 | (v73 << 32));
        *(_DWORD *)v75 = 0;
        *((_DWORD *)v75 + 1) = v74;
        if ( v70 == v69 )
          goto LABEL_61;
      }
      v77 = *((unsigned int *)*v69 + 8);
      if ( (unsigned int)v76 >= *((_DWORD *)v75 + 9) )
      {
        sub_16CD150((__int64)(v75 + 3), v75 + 5, 0, 1, (int)v58, v59);
        v77 = *((unsigned int *)v75 + 8);
      }
      ++v69;
      *((_BYTE *)v75[3] + v77) = 0;
      memcpy(v75, v75[3], v76);
    }
    while ( v70 != v69 );
LABEL_61:
    v3 = v371;
    v78 = *(_QWORD *)(v371 + 80);
    for ( k = *(_QWORD *)(v371 + 88); k != v78; v78 += 8 )
    {
      v80 = *(_QWORD *)(*(_QWORD *)v78 + 96LL);
      if ( v80 )
        *(_DWORD *)(*(_QWORD *)(*(_QWORD *)v78 + 56LL) + 4LL) = *(_DWORD *)(v80 + 48);
    }
  }
  v81 = *(__int64 **)(v3 + 64);
  for ( m = *(__int64 **)(v3 + 56); v81 != m; *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v86 + 88) + 56LL) + 16LL) = v85 )
  {
    while ( 1 )
    {
      if ( *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(*m + 88) + 56LL) + 20LL) == 5 )
      {
        v83 = *(_QWORD *)(*m + 80);
        v84 = *(_QWORD *)(sub_3925EE0(v3, *(_BYTE **)(v83 + 176)) + 104);
        if ( !v84 )
        {
          v336 = *(_QWORD *)(v83 + 160);
          v337 = *(char **)(v83 + 152);
          v391[0] = 1283;
          v384 = v336;
          v389 = "Missing associated COMDAT section for section ";
          v383 = v337;
          v390 = (__int64)&v383;
          sub_16BCFB0((__int64)&v389, 1u);
        }
        v85 = *(_DWORD *)(v84 + 72);
        if ( v85 != -1 )
          break;
      }
      if ( v81 == ++m )
        goto LABEL_72;
    }
    v86 = *m++;
  }
LABEL_72:
  v87 = *(_DWORD **)(v3 + 8);
  v88 = (*(_BYTE *)(v3 + 224) == 0 ? 0xFFFFFFDC : 0)
      + (*(__int64 (__fastcall **)(_DWORD *))(*(_QWORD *)v87 + 64LL))(v87)
      + v87[6]
      - v87[2]
      + 40 * *(_DWORD *)(v3 + 36)
      + 56;
  v372 = *(__int64 **)(a2 + 40);
  if ( *(__int64 **)(a2 + 32) == v372 )
    goto LABEL_115;
  v89 = v3 + 160;
  v90 = v3;
  v91 = *(__int64 **)(a2 + 32);
  v360 = v89;
  while ( 2 )
  {
    v103 = *(_DWORD *)(v90 + 184);
    v104 = *v91;
    if ( !v103 )
    {
      ++*(_QWORD *)(v90 + 160);
      goto LABEL_84;
    }
    v92 = *(_QWORD *)(v90 + 168);
    v93 = (v103 - 1) & (((unsigned int)v104 >> 9) ^ ((unsigned int)v104 >> 4));
    v94 = (__int64 *)(v92 + 16LL * v93);
    v95 = *v94;
    if ( v104 == *v94 )
    {
      v96 = v94[1];
      goto LABEL_76;
    }
    v229 = 1;
    v110 = 0;
    while ( v95 != -8 )
    {
      if ( v110 || v95 != -16 )
        v94 = v110;
      v93 = (v103 - 1) & (v229 + v93);
      v320 = (__int64 *)(v92 + 16LL * v93);
      v95 = *v320;
      if ( v104 == *v320 )
      {
        v96 = v320[1];
        goto LABEL_76;
      }
      ++v229;
      v110 = v94;
      v94 = (__int64 *)(v92 + 16LL * v93);
    }
    if ( !v110 )
      v110 = v94;
    v230 = *(_DWORD *)(v90 + 176);
    ++*(_QWORD *)(v90 + 160);
    v109 = v230 + 1;
    if ( 4 * v109 >= 3 * v103 )
    {
LABEL_84:
      sub_3925B80(v360, 2 * v103);
      v105 = *(_DWORD *)(v90 + 184);
      if ( !v105 )
        goto LABEL_374;
      v106 = v105 - 1;
      v107 = *(_QWORD *)(v90 + 168);
      LODWORD(v108) = v106 & (((unsigned int)v104 >> 9) ^ ((unsigned int)v104 >> 4));
      v109 = *(_DWORD *)(v90 + 176) + 1;
      v110 = (__int64 *)(v107 + 16LL * (unsigned int)v108);
      v111 = *v110;
      if ( v104 != *v110 )
      {
        v335 = 1;
        v233 = 0;
        while ( v111 != -8 )
        {
          if ( !v233 && v111 == -16 )
            v233 = v110;
          v108 = v106 & (unsigned int)(v108 + v335);
          v110 = (__int64 *)(v107 + 16 * v108);
          v111 = *v110;
          if ( v104 == *v110 )
            goto LABEL_86;
          ++v335;
        }
        goto LABEL_227;
      }
    }
    else if ( v103 - *(_DWORD *)(v90 + 180) - v109 <= v103 >> 3 )
    {
      v357 = ((unsigned int)v104 >> 9) ^ ((unsigned int)v104 >> 4);
      sub_3925B80(v360, v103);
      v231 = *(_DWORD *)(v90 + 184);
      if ( !v231 )
      {
LABEL_374:
        ++*(_DWORD *)(v90 + 176);
        BUG();
      }
      v232 = v231 - 1;
      v233 = 0;
      v234 = *(_QWORD *)(v90 + 168);
      v235 = 1;
      LODWORD(v236) = v232 & v357;
      v109 = *(_DWORD *)(v90 + 176) + 1;
      v110 = (__int64 *)(v234 + 16LL * (v232 & v357));
      v237 = *v110;
      if ( v104 != *v110 )
      {
        while ( v237 != -8 )
        {
          if ( !v233 && v237 == -16 )
            v233 = v110;
          v236 = v232 & (unsigned int)(v236 + v235);
          v110 = (__int64 *)(v234 + 16 * v236);
          v237 = *v110;
          if ( v104 == *v110 )
            goto LABEL_86;
          ++v235;
        }
LABEL_227:
        if ( v233 )
          v110 = v233;
      }
    }
LABEL_86:
    *(_DWORD *)(v90 + 176) = v109;
    if ( *v110 != -8 )
      --*(_DWORD *)(v90 + 180);
    *v110 = v104;
    v96 = 0;
    v110[1] = 0;
LABEL_76:
    if ( *(_DWORD *)(v96 + 72) != -1 )
    {
      v97 = sub_38D04A0(a3, v104);
      *(_DWORD *)(v96 + 16) = v97;
      v98 = v97;
      if ( *(char *)(v96 + 36) >= 0 )
      {
        v99 = (v88 + 3) & 0xFFFFFFFC;
        *(_DWORD *)(v96 + 20) = v99;
        v88 = v97 + v99;
      }
      v100 = *(_QWORD *)(v96 + 104);
      v101 = *(_QWORD *)(v96 + 96);
      if ( v100 != v101 )
      {
        if ( (unsigned __int64)(v100 - v101) <= 0x17FFD0 )
        {
          *(_WORD *)(v96 + 32) = -21845 * ((v100 - v101) >> 3);
          *(_DWORD *)(v96 + 24) = v88;
        }
        else
        {
          *(_DWORD *)(v96 + 24) = v88;
          v88 += 10;
          *(_WORD *)(v96 + 32) = -1;
        }
        v88 -= 1431655762 * ((v100 - v101) >> 3);
        do
        {
          v121 = *(_QWORD *)(v101 + 16);
          v101 += 24;
          *(_DWORD *)(v101 - 20) = *(_DWORD *)(v121 + 48);
        }
        while ( v100 != v101 );
        v98 = *(_DWORD *)(v96 + 16);
      }
      v102 = *(_QWORD *)(*(_QWORD *)(v96 + 88) + 56LL);
      *(_DWORD *)(v102 + 4) = v98;
      *(_WORD *)(v102 + 8) = *(_WORD *)(v96 + 32);
      *(_WORD *)(v102 + 10) = *(_WORD *)(v96 + 34);
    }
    if ( v372 != ++v91 )
      continue;
    break;
  }
  v3 = v90;
LABEL_115:
  *(_DWORD *)(v3 + 44) = v88;
  if ( (*(_BYTE *)(a2 + 484) & 4) != 0 )
  {
    v319 = time(0);
    if ( v319 < 0 )
    {
      LODWORD(v319) = -1;
    }
    else if ( v319 != (unsigned int)v319 )
    {
      LODWORD(v319) = -1;
    }
    *(_DWORD *)(v3 + 40) = v319;
  }
  else
  {
    *(_DWORD *)(v3 + 40) = 0;
  }
  v122 = *(_QWORD *)(v3 + 8);
  if ( *(_BYTE *)(v3 + 224) )
  {
    LOWORD(v389) = 0;
    sub_16E7EE0(v122, (char *)&v389, 2u);
    v238 = *(_QWORD *)(v3 + 8);
    LOWORD(v389) = -1;
    sub_16E7EE0(v238, (char *)&v389, 2u);
    v239 = *(_QWORD *)(v3 + 8);
    LOWORD(v389) = (unsigned int)(*(_DWORD *)(v3 + 16) - 1) < 2 ? 2 : 512;
    sub_16E7EE0(v239, (char *)&v389, 2u);
    v240 = *(_WORD *)(v3 + 32);
    v241 = *(_QWORD *)(v3 + 8);
    v242 = __ROL2__(v240, 8);
    if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
      v240 = v242;
    LOWORD(v389) = v240;
    sub_16E7EE0(v241, (char *)&v389, 2u);
    v243 = *(_DWORD *)(v3 + 40);
    v244 = *(_QWORD *)(v3 + 8);
    v245 = _byteswap_ulong(v243);
    if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
      v243 = v245;
    LODWORD(v389) = v243;
    sub_16E7EE0(v244, (char *)&v389, 4u);
    sub_16E7EE0(*(_QWORD *)(v3 + 8), byte_4530310, 0x10u);
    v246 = *(_QWORD *)(v3 + 8);
    LODWORD(v389) = 0;
    sub_16E7EE0(v246, (char *)&v389, 4u);
    v247 = *(_QWORD *)(v3 + 8);
    LODWORD(v389) = 0;
    sub_16E7EE0(v247, (char *)&v389, 4u);
    v248 = *(_QWORD *)(v3 + 8);
    LODWORD(v389) = 0;
    sub_16E7EE0(v248, (char *)&v389, 4u);
    v249 = *(_QWORD *)(v3 + 8);
    LODWORD(v389) = 0;
    sub_16E7EE0(v249, (char *)&v389, 4u);
    v250 = *(_DWORD *)(v3 + 36);
    v251 = *(_QWORD *)(v3 + 8);
    v252 = _byteswap_ulong(v250);
    if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
      v250 = v252;
    LODWORD(v389) = v250;
    sub_16E7EE0(v251, (char *)&v389, 4u);
    v253 = *(_DWORD *)(v3 + 44);
    v254 = *(_QWORD *)(v3 + 8);
    v255 = _byteswap_ulong(v253);
    if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
      v253 = v255;
    LODWORD(v389) = v253;
    sub_16E7EE0(v254, (char *)&v389, 4u);
    v256 = *(_DWORD *)(v3 + 48);
    v257 = *(_QWORD *)(v3 + 8);
    v142 = (__int64)&v389;
    v258 = _byteswap_ulong(v256);
    if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
      v256 = v258;
    LODWORD(v389) = v256;
    sub_16E7EE0(v257, (char *)&v389, 4u);
  }
  else
  {
    v123 = *(_WORD *)(v3 + 32);
    v124 = __ROL2__(v123, 8);
    if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
      v123 = v124;
    LOWORD(v389) = v123;
    sub_16E7EE0(v122, (char *)&v389, 2u);
    v125 = *(_DWORD *)(v3 + 36);
    v126 = *(_QWORD *)(v3 + 8);
    v127 = __ROL2__(v125, 8);
    if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
      LOWORD(v125) = v127;
    LOWORD(v389) = v125;
    sub_16E7EE0(v126, (char *)&v389, 2u);
    v128 = *(_DWORD *)(v3 + 40);
    v129 = *(_QWORD *)(v3 + 8);
    v130 = _byteswap_ulong(v128);
    if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
      v128 = v130;
    LODWORD(v389) = v128;
    sub_16E7EE0(v129, (char *)&v389, 4u);
    v131 = *(_DWORD *)(v3 + 44);
    v132 = *(_QWORD *)(v3 + 8);
    v133 = _byteswap_ulong(v131);
    if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
      v131 = v133;
    LODWORD(v389) = v131;
    sub_16E7EE0(v132, (char *)&v389, 4u);
    v134 = *(_DWORD *)(v3 + 48);
    v135 = *(_QWORD *)(v3 + 8);
    v136 = _byteswap_ulong(v134);
    if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
      v134 = v136;
    LODWORD(v389) = v134;
    sub_16E7EE0(v135, (char *)&v389, 4u);
    v137 = *(_WORD *)(v3 + 52);
    v138 = *(_QWORD *)(v3 + 8);
    v139 = __ROL2__(v137, 8);
    if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
      v137 = v139;
    LOWORD(v389) = v137;
    sub_16E7EE0(v138, (char *)&v389, 2u);
    v140 = *(_WORD *)(v3 + 54);
    v141 = *(_QWORD *)(v3 + 8);
    v142 = (__int64)&v389;
    v143 = __ROL2__(v140, 8);
    if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
      v140 = v143;
    LOWORD(v389) = v140;
    sub_16E7EE0(v141, (char *)&v389, 2u);
  }
  v144 = *(__int64 **)(v3 + 64);
  if ( *(__int64 **)(v3 + 56) == v144 )
    goto LABEL_186;
  v374 = v3;
  v145 = 0;
  v146 = *(__int64 **)(v3 + 56);
  v147 = 0;
  v148 = 0;
  v149 = v144;
  while ( 2 )
  {
    while ( 2 )
    {
      v150 = *v146;
      if ( v148 == v145 )
      {
        v151 = v148 - v147;
        v152 = (v148 - v147) >> 3;
        if ( v152 == 0xFFFFFFFFFFFFFFFLL )
          sub_4262D8((__int64)"vector::_M_realloc_insert");
        v142 = 1;
        if ( v152 )
          v142 = (v148 - v147) >> 3;
        v153 = __CFADD__(v142, v152);
        v154 = v142 + v152;
        if ( v153 )
        {
          v155 = 0x7FFFFFFFFFFFFFF8LL;
          goto LABEL_147;
        }
        if ( v154 )
        {
          if ( v154 > 0xFFFFFFFFFFFFFFFLL )
            v154 = 0xFFFFFFFFFFFFFFFLL;
          v155 = 8 * v154;
LABEL_147:
          v350 = v147;
          v352 = v148 - v147;
          v355 = *v146;
          v156 = sub_22077B0(v155);
          v150 = v355;
          v151 = v352;
          v147 = v350;
          v157 = (char *)v156;
          v158 = v156 + v155;
        }
        else
        {
          v158 = 0;
          v157 = 0;
        }
        if ( &v157[v151] )
          *(_QWORD *)&v157[v151] = v150;
        v145 = &v157[v151 + 8];
        if ( v151 > 0 )
        {
          v358 = v147;
          v318 = (char *)memmove(v157, v147, v151);
          v147 = v358;
          v157 = v318;
        }
        else if ( !v147 )
        {
          goto LABEL_152;
        }
        v359 = v157;
        v142 = v148 - v147;
        j_j___libc_free_0((unsigned __int64)v147);
        v157 = v359;
LABEL_152:
        ++v146;
        v148 = (char *)v158;
        v147 = v157;
        if ( v149 == v146 )
          goto LABEL_153;
        continue;
      }
      break;
    }
    if ( v145 )
      *(_QWORD *)v145 = v150;
    ++v146;
    v145 += 8;
    if ( v149 != v146 )
      continue;
    break;
  }
LABEL_153:
  v159 = v148;
  v160 = v147;
  v3 = v374;
  v361 = v159 - v147;
  if ( v147 != v145 )
  {
    v161 = v145 - v147;
    _BitScanReverse64(&v162, (v145 - v147) >> 3);
    sub_3925090(v147, v145, 2LL * (int)(63 - (v162 ^ 0x3F)));
    if ( v161 <= 128 )
    {
      v142 = (__int64)v145;
      sub_3924FD0(v160, v145);
    }
    else
    {
      v163 = v160 + 128;
      v142 = (__int64)(v160 + 128);
      sub_3924FD0(v160, v160 + 128);
      if ( v160 + 128 != v145 )
      {
        do
        {
          while ( 1 )
          {
            v164 = *((_QWORD *)v163 - 1);
            v165 = *(_QWORD *)v163;
            v166 = (__int64)(v163 - 8);
            if ( *(_DWORD *)(*(_QWORD *)v163 + 72LL) < *(_DWORD *)(v164 + 72) )
              break;
            v142 = (__int64)v163;
            v163 += 8;
            *(_QWORD *)v142 = v165;
            if ( v163 == v145 )
              goto LABEL_159;
          }
          do
          {
            *(_QWORD *)(v166 + 8) = v164;
            v142 = v166;
            v164 = *(_QWORD *)(v166 - 8);
            v166 -= 8;
          }
          while ( *(_DWORD *)(v165 + 72) < *(_DWORD *)(v164 + 72) );
          v163 += 8;
          *(_QWORD *)v142 = v165;
        }
        while ( v163 != v145 );
      }
    }
LABEL_159:
    v375 = v160;
    do
    {
      v167 = *(_QWORD *)v160;
      if ( *(_DWORD *)(*(_QWORD *)v160 + 72LL) != -1 )
      {
        if ( *(_QWORD *)(v167 + 104) - *(_QWORD *)(v167 + 96) > 0x17FFD0u )
          *(_DWORD *)(v167 + 36) |= 0x1000000u;
        sub_16E7EE0(*(_QWORD *)(v3 + 8), (char *)v167, 8u);
        v168 = *(_DWORD *)(v167 + 8);
        v169 = *(_QWORD *)(v3 + 8);
        v170 = _byteswap_ulong(v168);
        if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
          v168 = v170;
        LODWORD(v389) = v168;
        sub_16E7EE0(v169, (char *)&v389, 4u);
        v171 = *(_DWORD *)(v167 + 12);
        v172 = *(_QWORD *)(v3 + 8);
        v173 = _byteswap_ulong(v171);
        if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
          v171 = v173;
        LODWORD(v389) = v171;
        sub_16E7EE0(v172, (char *)&v389, 4u);
        v174 = *(_DWORD *)(v167 + 16);
        v175 = *(_QWORD *)(v3 + 8);
        v176 = _byteswap_ulong(v174);
        if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
          v174 = v176;
        LODWORD(v389) = v174;
        sub_16E7EE0(v175, (char *)&v389, 4u);
        v177 = *(_DWORD *)(v167 + 20);
        v178 = *(_QWORD *)(v3 + 8);
        v179 = _byteswap_ulong(v177);
        if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
          v177 = v179;
        LODWORD(v389) = v177;
        sub_16E7EE0(v178, (char *)&v389, 4u);
        v180 = *(_DWORD *)(v167 + 24);
        v181 = *(_QWORD *)(v3 + 8);
        v182 = _byteswap_ulong(v180);
        if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
          v180 = v182;
        LODWORD(v389) = v180;
        sub_16E7EE0(v181, (char *)&v389, 4u);
        v183 = *(_DWORD *)(v167 + 28);
        v184 = *(_QWORD *)(v3 + 8);
        v185 = _byteswap_ulong(v183);
        if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
          v183 = v185;
        LODWORD(v389) = v183;
        sub_16E7EE0(v184, (char *)&v389, 4u);
        v186 = *(_WORD *)(v167 + 32);
        v187 = *(_QWORD *)(v3 + 8);
        v188 = __ROL2__(v186, 8);
        if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
          v186 = v188;
        LOWORD(v389) = v186;
        sub_16E7EE0(v187, (char *)&v389, 2u);
        v189 = *(_WORD *)(v167 + 34);
        v190 = *(_QWORD *)(v3 + 8);
        v191 = __ROL2__(v189, 8);
        if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
          v189 = v191;
        LOWORD(v389) = v189;
        sub_16E7EE0(v190, (char *)&v389, 2u);
        v192 = *(_DWORD *)(v167 + 36);
        v193 = *(_QWORD *)(v3 + 8);
        v194 = _byteswap_ulong(v192);
        if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
          v192 = v194;
        v142 = (__int64)&v389;
        LODWORD(v389) = v192;
        sub_16E7EE0(v193, (char *)&v389, 4u);
      }
      v160 += 8;
    }
    while ( v145 != v160 );
    v160 = v375;
  }
  if ( v160 )
  {
    v142 = v361;
    j_j___libc_free_0((unsigned __int64)v160);
  }
LABEL_186:
  v195 = *(__int64 **)(v3 + 56);
  v362 = *(__int64 **)(v3 + 64);
  v376 = *(__int64 **)(a2 + 32);
  v356 = *(__int64 **)(a2 + 40);
  if ( v356 != v376 && *(__int64 **)(v3 + 64) != v195 )
  {
    while ( 2 )
    {
      v196 = *v195;
      if ( *(_DWORD *)(*v195 + 72) != -1 )
      {
        v197 = *(_DWORD *)(v196 + 20);
        if ( !v197 )
          goto LABEL_190;
        v342 = *v195;
        v302 = *v376;
        v346 = *(_DWORD **)(v3 + 8);
        v303 = (*(__int64 (__fastcall **)(_DWORD *, __int64))(*(_QWORD *)v346 + 64LL))(v346, v142);
        sub_16E8900(*(_QWORD *)(v3 + 8), v197 - (v303 + v346[6] - v346[2]));
        v387 = 1;
        v389 = (char *)v391;
        v390 = 0x8000000000LL;
        v386 = 0;
        v383 = (char *)&unk_49EFC48;
        v385 = 0;
        v384 = 0;
        v388 = &v389;
        sub_16E7A40((__int64)&v383, 0, 0, 0);
        sub_390B9B0(a2, &v383, v302, a3);
        sub_16E7EE0(*(_QWORD *)(v3 + 8), v389, (unsigned int)v390);
        LODWORD(src) = 0;
        sub_3946250(&src, v389, (unsigned int)v390);
        v304 = (int)src;
        v383 = (char *)&unk_49EFD28;
        sub_16E7960((__int64)&v383);
        v196 = v342;
        if ( v389 != (char *)v391 )
        {
          _libc_free((unsigned __int64)v389);
          v196 = v342;
        }
        v142 = *(unsigned int *)(v3 + 184);
        v347 = v3 + 160;
        if ( (_DWORD)v142 )
        {
          v305 = *(_QWORD *)(v3 + 168);
          v306 = ((_DWORD)v142 - 1) & (((unsigned int)v302 >> 9) ^ ((unsigned int)v302 >> 4));
          v307 = (_QWORD *)(v305 + 16 * v306);
          v308 = *v307;
          if ( v302 == *v307 )
          {
            v309 = v307[1];
            goto LABEL_287;
          }
          v338 = 1;
          v321 = 0;
          while ( v308 != -8 )
          {
            if ( v321 || v308 != -16 )
              v307 = v321;
            LODWORD(v306) = (v142 - 1) & (v338 + v306);
            v345 = (__int64 *)(v305 + 16LL * (unsigned int)v306);
            v308 = *v345;
            if ( v302 == *v345 )
            {
              v309 = v345[1];
              goto LABEL_287;
            }
            ++v338;
            v321 = v307;
            v307 = (_QWORD *)(v305 + 16LL * (unsigned int)v306);
          }
          if ( !v321 )
            v321 = v307;
          v322 = *(_DWORD *)(v3 + 176);
          ++*(_QWORD *)(v3 + 160);
          v323 = v322 + 1;
          if ( 4 * v323 < (unsigned int)(3 * v142) )
          {
            if ( (int)v142 - *(_DWORD *)(v3 + 180) - v323 <= (unsigned int)v142 >> 3 )
            {
              v339 = ((unsigned int)v302 >> 9) ^ ((unsigned int)v302 >> 4);
              v344 = v196;
              sub_3925B80(v347, v142);
              v330 = *(_DWORD *)(v3 + 184);
              if ( !v330 )
              {
LABEL_375:
                ++*(_DWORD *)(v3 + 176);
                BUG();
              }
              v331 = v330 - 1;
              v142 = 0;
              v196 = v344;
              v349 = *(_QWORD *)(v3 + 168);
              v332 = v331 & v339;
              v323 = *(_DWORD *)(v3 + 176) + 1;
              v321 = (_QWORD *)(v349 + 16LL * (v331 & v339));
              v333 = 1;
              v334 = *v321;
              if ( v302 != *v321 )
              {
                while ( v334 != -8 )
                {
                  if ( v334 == -16 && !v142 )
                    v142 = (__int64)v321;
                  v332 = v331 & (v333 + v332);
                  v321 = (_QWORD *)(v349 + 16LL * v332);
                  v334 = *v321;
                  if ( v302 == *v321 )
                    goto LABEL_320;
                  ++v333;
                }
                goto LABEL_340;
              }
            }
            goto LABEL_320;
          }
        }
        else
        {
          ++*(_QWORD *)(v3 + 160);
        }
        v142 = (unsigned int)(2 * v142);
        v343 = v196;
        sub_3925B80(v347, v142);
        v324 = *(_DWORD *)(v3 + 184);
        if ( !v324 )
          goto LABEL_375;
        v325 = v324 - 1;
        v326 = *(_QWORD *)(v3 + 168);
        v196 = v343;
        v327 = (v324 - 1) & (((unsigned int)v302 >> 9) ^ ((unsigned int)v302 >> 4));
        v323 = *(_DWORD *)(v3 + 176) + 1;
        v321 = (_QWORD *)(v326 + 16LL * v327);
        v328 = *v321;
        if ( v302 != *v321 )
        {
          v329 = 1;
          v142 = 0;
          while ( v328 != -8 )
          {
            if ( v328 == -16 && !v142 )
              v142 = (__int64)v321;
            v327 = v325 & (v329 + v327);
            v321 = (_QWORD *)(v326 + 16LL * v327);
            v328 = *v321;
            if ( v302 == *v321 )
              goto LABEL_320;
            ++v329;
          }
LABEL_340:
          if ( v142 )
            v321 = (_QWORD *)v142;
        }
LABEL_320:
        *(_DWORD *)(v3 + 176) = v323;
        if ( *v321 != -8 )
          --*(_DWORD *)(v3 + 180);
        *v321 = v302;
        v309 = 0;
        v321[1] = 0;
LABEL_287:
        *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v309 + 88) + 56LL) + 12LL) = v304;
LABEL_190:
        v198 = *(_QWORD *)(v196 + 104);
        v199 = *(_QWORD *)(v196 + 96);
        if ( v198 != v199 )
        {
          if ( (unsigned __int64)(v198 - v199) <= 0x17FFD0 )
            goto LABEL_378;
          v348 = v196;
          v313 = *(_QWORD *)(v3 + 8);
          v314 = -1431655765 * ((v198 - v199) >> 3) + 1;
          v315 = _byteswap_ulong(v314);
          if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
            v314 = v315;
          LODWORD(v389) = v314;
          sub_16E7EE0(v313, (char *)&v389, 4u);
          v316 = *(_QWORD *)(v3 + 8);
          LODWORD(v389) = 0;
          sub_16E7EE0(v316, (char *)&v389, 4u);
          v317 = *(_QWORD *)(v3 + 8);
          v142 = (__int64)&v389;
          LOWORD(v389) = 0;
          sub_16E7EE0(v317, (char *)&v389, 2u);
          v199 = *(_QWORD *)(v348 + 96);
          v198 = *(_QWORD *)(v348 + 104);
          if ( v199 != v198 )
          {
LABEL_378:
            do
            {
              v200 = *(_DWORD *)v199;
              v201 = *(_QWORD *)(v3 + 8);
              v202 = _byteswap_ulong(*(_DWORD *)v199);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                v200 = v202;
              LODWORD(v389) = v200;
              sub_16E7EE0(v201, (char *)&v389, 4u);
              v203 = *(_DWORD *)(v199 + 4);
              v204 = *(_QWORD *)(v3 + 8);
              v205 = _byteswap_ulong(v203);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                v203 = v205;
              LODWORD(v389) = v203;
              sub_16E7EE0(v204, (char *)&v389, 4u);
              v206 = *(_WORD *)(v199 + 8);
              v207 = *(_QWORD *)(v3 + 8);
              v142 = (__int64)&v389;
              v208 = __ROL2__(v206, 8);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                v206 = v208;
              v199 += 24;
              LOWORD(v389) = v206;
              sub_16E7EE0(v207, (char *)&v389, 2u);
            }
            while ( v198 != v199 );
          }
        }
      }
      ++v376;
      if ( v362 == ++v195 || v356 == v376 )
        break;
      continue;
    }
  }
  v363 = *(char ***)(v3 + 88);
  for ( ii = *(char ***)(v3 + 80); v363 != ii; ++ii )
  {
    v209 = *ii;
    if ( *((_DWORD *)*ii + 12) != -1 )
    {
      sub_16E7EE0(*(_QWORD *)(v3 + 8), *ii, 8u);
      v210 = *((_DWORD *)v209 + 2);
      v211 = *(_QWORD *)(v3 + 8);
      v212 = _byteswap_ulong(v210);
      if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
        v210 = v212;
      LODWORD(v389) = v210;
      sub_16E7EE0(v211, (char *)&v389, 4u);
      if ( *(_BYTE *)(v3 + 224) )
      {
        v213 = *((_DWORD *)v209 + 3);
        v214 = *(_QWORD *)(v3 + 8);
        v215 = _byteswap_ulong(v213);
        if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
          v213 = v215;
        LODWORD(v389) = v213;
        sub_16E7EE0(v214, (char *)&v389, 4u);
      }
      else
      {
        v310 = *((_DWORD *)v209 + 3);
        v311 = *(_QWORD *)(v3 + 8);
        v312 = __ROL2__(v310, 8);
        if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
          LOWORD(v310) = v312;
        LOWORD(v389) = v310;
        sub_16E7EE0(v311, (char *)&v389, 2u);
      }
      v216 = *((_WORD *)v209 + 8);
      v217 = *(_QWORD *)(v3 + 8);
      v218 = __ROL2__(v216, 8);
      if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
        v216 = v218;
      LOWORD(v389) = v216;
      sub_16E7EE0(v217, (char *)&v389, 2u);
      v219 = *(_QWORD *)(v3 + 8);
      v220 = v209[18];
      v221 = *(char **)(v219 + 24);
      if ( (unsigned __int64)v221 >= *(_QWORD *)(v219 + 16) )
      {
        sub_16E7DE0(v219, v220);
      }
      else
      {
        *(_QWORD *)(v219 + 24) = v221 + 1;
        *v221 = v220;
      }
      v222 = *(_QWORD *)(v3 + 8);
      v223 = v209[19];
      v224 = *(char **)(v222 + 24);
      if ( (unsigned __int64)v224 >= *(_QWORD *)(v222 + 16) )
      {
        sub_16E7DE0(v222, v223);
      }
      else
      {
        *(_QWORD *)(v222 + 24) = v224 + 1;
        *v224 = v223;
      }
      v225 = *((_QWORD *)v209 + 7);
      v226 = v225 + 24LL * *((unsigned int *)v209 + 16);
      if ( v225 != v226 )
      {
        v227 = v225 + 4;
        while ( 1 )
        {
          v228 = *(_QWORD *)(v3 + 8);
          switch ( *(_DWORD *)(v227 - 4) )
          {
            case 0:
              v274 = *(_DWORD *)v227;
              v275 = _byteswap_ulong(*(_DWORD *)v227);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                v274 = v275;
              LODWORD(v389) = v274;
              sub_16E7EE0(v228, (char *)&v389, 4u);
              v276 = *(_DWORD *)(v227 + 4);
              v277 = *(_QWORD *)(v3 + 8);
              v278 = _byteswap_ulong(v276);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                v276 = v278;
              LODWORD(v389) = v276;
              sub_16E7EE0(v277, (char *)&v389, 4u);
              v279 = *(_DWORD *)(v227 + 8);
              v280 = *(_QWORD *)(v3 + 8);
              v281 = _byteswap_ulong(v279);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                v279 = v281;
              LODWORD(v389) = v279;
              sub_16E7EE0(v280, (char *)&v389, 4u);
              v270 = *(_DWORD *)(v227 + 12);
              v271 = *(_QWORD *)(v3 + 8);
              v272 = *(_DWORD *)(v3 + 16) - 1;
              goto LABEL_255;
            case 1:
              sub_16E8900(v228, 4u);
              v267 = *(_WORD *)(v227 + 4);
              v268 = *(_QWORD *)(v3 + 8);
              v269 = __ROL2__(v267, 8);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                v267 = v269;
              LOWORD(v389) = v267;
              sub_16E7EE0(v268, (char *)&v389, 2u);
              sub_16E8900(*(_QWORD *)(v3 + 8), 6u);
              v270 = *(_DWORD *)(v227 + 12);
              v271 = *(_QWORD *)(v3 + 8);
              v272 = *(_DWORD *)(v3 + 16) - 1;
LABEL_255:
              v273 = _byteswap_ulong(v270);
              if ( v272 > 1 )
                v270 = v273;
              LODWORD(v389) = v270;
              sub_16E7EE0(v271, (char *)&v389, 4u);
              sub_16E8900(*(_QWORD *)(v3 + 8), 2u);
              if ( *(_BYTE *)(v3 + 224) )
                goto LABEL_249;
              goto LABEL_242;
            case 2:
              v260 = *(_DWORD *)v227;
              v261 = _byteswap_ulong(*(_DWORD *)v227);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                v260 = v261;
              LODWORD(v389) = v260;
              sub_16E7EE0(v228, (char *)&v389, 4u);
              v262 = *(_DWORD *)(v227 + 4);
              v263 = *(_QWORD *)(v3 + 8);
              v264 = _byteswap_ulong(v262);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                v262 = v264;
              LODWORD(v389) = v262;
              sub_16E7EE0(v263, (char *)&v389, 4u);
              sub_16E8900(*(_QWORD *)(v3 + 8), 0xAu);
              if ( *(_BYTE *)(v3 + 224) )
                goto LABEL_249;
              goto LABEL_242;
            case 3:
              sub_16E7EE0(v228, (char *)v227, (-(__int64)(*(_BYTE *)(v3 + 224) == 0) & 0xFFFFFFFFFFFFFFFELL) + 20);
              goto LABEL_242;
            case 4:
              v282 = *(_DWORD *)v227;
              v283 = _byteswap_ulong(*(_DWORD *)v227);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                v282 = v283;
              LODWORD(v389) = v282;
              sub_16E7EE0(v228, (char *)&v389, 4u);
              v284 = *(_WORD *)(v227 + 4);
              v285 = *(_QWORD *)(v3 + 8);
              v286 = __ROL2__(v284, 8);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                v284 = v286;
              LOWORD(v389) = v284;
              sub_16E7EE0(v285, (char *)&v389, 2u);
              v287 = *(_WORD *)(v227 + 6);
              v288 = *(_QWORD *)(v3 + 8);
              v289 = __ROL2__(v287, 8);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                v287 = v289;
              LOWORD(v389) = v287;
              sub_16E7EE0(v288, (char *)&v389, 2u);
              v290 = *(_DWORD *)(v227 + 8);
              v291 = *(_QWORD *)(v3 + 8);
              v292 = _byteswap_ulong(v290);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                v290 = v292;
              LODWORD(v389) = v290;
              sub_16E7EE0(v291, (char *)&v389, 4u);
              v293 = *(_DWORD *)(v227 + 12);
              v294 = *(_QWORD *)(v3 + 8);
              v295 = __ROL2__(v293, 8);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                LOWORD(v293) = v295;
              LOWORD(v389) = v293;
              sub_16E7EE0(v294, (char *)&v389, 2u);
              v296 = *(_QWORD *)(v3 + 8);
              v297 = *(_BYTE *)(v227 + 16);
              v298 = *(char **)(v296 + 24);
              if ( (unsigned __int64)v298 >= *(_QWORD *)(v296 + 16) )
              {
                sub_16E7DE0(v296, v297);
              }
              else
              {
                *(_QWORD *)(v296 + 24) = v298 + 1;
                *v298 = v297;
              }
              sub_16E8900(*(_QWORD *)(v3 + 8), 1u);
              v299 = *(_WORD *)(v227 + 14);
              v300 = *(_QWORD *)(v3 + 8);
              v301 = __ROL2__(v299, 8);
              if ( (unsigned int)(*(_DWORD *)(v3 + 16) - 1) > 1 )
                v299 = v301;
              LOWORD(v389) = v299;
              sub_16E7EE0(v300, (char *)&v389, 2u);
              if ( !*(_BYTE *)(v3 + 224) )
                goto LABEL_242;
LABEL_249:
              sub_16E8900(*(_QWORD *)(v3 + 8), 2u);
              v259 = v227 + 24;
              if ( v226 == v227 + 20 )
                goto LABEL_250;
              goto LABEL_243;
            default:
LABEL_242:
              v259 = v227 + 24;
              if ( v226 == v227 + 20 )
                goto LABEL_250;
LABEL_243:
              v227 = v259;
              break;
          }
        }
      }
    }
LABEL_250:
    ;
  }
  sub_167FBC0(v366, *(_QWORD *)(v3 + 8));
  v265 = *(_QWORD **)(v3 + 8);
  return (*(__int64 (__fastcall **)(_QWORD *))(*v265 + 64LL))(v265) + v265[3] - v265[1] - v340 - v341;
}

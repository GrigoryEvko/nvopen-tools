// Function: sub_2F86AD0
// Address: 0x2f86ad0
//
__int64 __fastcall sub_2F86AD0(__int64 *a1, __int64 a2, __int64 a3, __int64 a4, unsigned __int64 a5, __int64 a6)
{
  __int64 v6; // r12
  _QWORD *v7; // r13
  __int64 v8; // r15
  __int64 v9; // rcx
  _QWORD *v10; // r14
  __int64 v11; // r13
  __int64 v12; // rbx
  __int64 v13; // r15
  __int64 v14; // rax
  __int64 v15; // rax
  __int64 v16; // rdx
  __int64 v17; // rax
  __int64 v18; // rcx
  __int64 v19; // r8
  __int64 v20; // r9
  __int64 v21; // r8
  __int64 v22; // r9
  __int64 v23; // rax
  unsigned __int64 v24; // rdx
  __int64 v25; // rdi
  __int16 v26; // dx
  __int64 v27; // r14
  char v28; // r12
  char v29; // bl
  __int64 v30; // r13
  __int64 *v31; // rax
  __int64 v32; // rdi
  unsigned int *v33; // rsi
  __int64 v34; // r8
  __int64 v35; // r9
  unsigned int *v36; // r12
  unsigned int *v37; // rax
  int v38; // ecx
  unsigned int *v39; // rdx
  char v40; // al
  _QWORD *v41; // rbx
  __int64 v42; // rax
  __int64 v43; // rcx
  __int64 v44; // r8
  __int64 v45; // r9
  __int64 v46; // rax
  unsigned __int64 v47; // rdx
  _QWORD *v48; // rax
  __int64 v49; // rdx
  __int64 v50; // rcx
  unsigned __int64 v51; // rax
  __int64 v52; // rdx
  __int64 v53; // rax
  __int64 v54; // rax
  unsigned __int64 v55; // rdx
  __int64 v56; // rax
  unsigned int *v57; // rdx
  __int64 v58; // rcx
  int v59; // esi
  __int64 v60; // rax
  __int64 *v61; // rdi
  _QWORD *v62; // rax
  __int64 v63; // r8
  __int64 v64; // r9
  unsigned int *v65; // r12
  unsigned int *v66; // rax
  __int64 v67; // rax
  __int64 v68; // r12
  __int64 v69; // r13
  __int64 v70; // rax
  char v71; // bl
  _QWORD *v72; // rax
  unsigned int *v73; // r12
  unsigned int *v74; // rbx
  __int64 v75; // rdx
  unsigned int v76; // esi
  __int64 v77; // rax
  __int64 *v78; // r12
  __int64 v79; // rbx
  unsigned __int8 v80; // al
  unsigned int v81; // r15d
  unsigned __int8 v82; // r13
  _QWORD *v83; // rax
  __int64 v84; // r14
  unsigned int *v85; // r12
  unsigned int *v86; // rbx
  __int64 v87; // rdx
  unsigned int v88; // esi
  __int64 v89; // rax
  char v90; // bl
  _QWORD *v91; // rax
  __int64 v92; // r9
  __int64 v93; // r12
  unsigned int *v94; // r13
  unsigned int *v95; // rbx
  __int64 v96; // rdx
  unsigned int v97; // esi
  __int64 v98; // r15
  __int64 v99; // rbx
  __int64 v100; // r12
  __int64 v101; // rax
  char v102; // al
  char v103; // r14
  unsigned __int8 *v104; // rax
  unsigned __int8 *v105; // rbx
  __int64 v106; // r14
  char *v107; // r12
  __int64 v108; // rdx
  unsigned int v109; // esi
  __int64 (__fastcall *v110)(__int64, unsigned int, _BYTE *, unsigned __int8 *); // rax
  __int64 v111; // r12
  unsigned int v112; // r14d
  unsigned int v113; // ebx
  __int64 v114; // rax
  unsigned __int64 v115; // r12
  __int64 v116; // r12
  __int64 *v117; // rax
  unsigned __int64 v118; // rax
  unsigned __int64 v119; // r12
  int v120; // edx
  int v121; // r14d
  __int64 v122; // rax
  __int64 v123; // r13
  __int64 v124; // r14
  unsigned int v125; // eax
  unsigned __int64 v126; // rcx
  unsigned __int64 v127; // r13
  __int64 v128; // rsi
  __int64 v129; // rsi
  __int64 v130; // r15
  __int64 v131; // r12
  __int64 v132; // rax
  char v133; // al
  __int16 v134; // cx
  _QWORD *v135; // rax
  unsigned int *v136; // r12
  unsigned int *v137; // rbx
  __int64 v138; // rdx
  unsigned int v139; // esi
  __int64 v140; // rbx
  __int64 v141; // rax
  char v142; // r14
  _QWORD *v143; // rax
  __int64 v144; // r9
  __int64 v145; // r12
  unsigned int *v146; // r15
  unsigned int *v147; // rbx
  __int64 v148; // rdx
  unsigned int v149; // esi
  __int64 v150; // r15
  unsigned __int64 v151; // rbx
  __int64 *v152; // rsi
  __int64 v153; // r12
  unsigned __int64 v154; // r15
  __int64 **v155; // r13
  unsigned int v156; // ebx
  unsigned int v157; // eax
  __int64 v158; // r14
  __int64 v159; // r13
  char v160; // bl
  __int64 v161; // rax
  __int64 v162; // rdx
  __int64 v163; // rax
  unsigned __int8 *v164; // r14
  __int64 (__fastcall *v165)(__int64, unsigned int, _BYTE *, unsigned __int8 *, unsigned __int8, char); // rax
  unsigned __int8 *v166; // r13
  __int64 **v167; // rcx
  __int64 v168; // r14
  __int64 v169; // rax
  char v170; // al
  char v171; // bl
  _QWORD *v172; // rax
  unsigned __int64 v173; // r15
  __int64 v174; // r14
  char *v175; // rbx
  __int64 v176; // rdx
  unsigned int v177; // esi
  unsigned __int8 *v178; // rbx
  __int64 (__fastcall *v179)(__int64, unsigned int, unsigned __int8 *, unsigned __int8 *, unsigned __int8, char); // rax
  unsigned __int8 *v180; // r15
  unsigned __int64 v181; // rbx
  unsigned __int8 v182; // al
  unsigned __int8 v183; // cl
  __int64 v184; // rdi
  __int64 v185; // rsi
  unsigned __int8 *v186; // r14
  __int64 (__fastcall *v187)(__int64, unsigned int, unsigned __int8 *, unsigned __int8 *); // rax
  __int64 v188; // r13
  __int64 v189; // r13
  __int64 v190; // rax
  char v191; // al
  char v192; // bl
  _QWORD *v193; // rax
  __int64 v194; // r9
  __int64 v195; // r14
  __int64 v196; // r15
  char *v197; // rbx
  __int64 v198; // rdx
  unsigned int v199; // esi
  __int64 v200; // rax
  char v201; // al
  char v202; // bl
  _QWORD *v203; // rax
  __int64 v204; // r9
  __int64 v205; // r14
  __int64 v206; // r15
  char *v207; // rbx
  __int64 v208; // rdx
  unsigned int v209; // esi
  __int64 v210; // rsi
  __int64 (__fastcall *v211)(__int64, __int64, __int64); // rax
  __int64 v212; // r14
  char *v213; // rbx
  __int64 v214; // rdx
  unsigned int v215; // esi
  __int64 *v216; // r13
  __int64 v217; // r14
  __int64 v218; // rax
  char v219; // r15
  _QWORD *v220; // rax
  __int64 v221; // r9
  __int64 v222; // r12
  unsigned int *v223; // r14
  unsigned int *v224; // rbx
  __int64 v225; // rdx
  unsigned int v226; // esi
  __int64 v227; // r13
  unsigned int v228; // r12d
  __int64 v230; // r14
  char *v231; // rbx
  __int64 v232; // rdx
  unsigned int v233; // esi
  __int64 v234; // r13
  char *v235; // rbx
  __int64 v236; // rdx
  unsigned int v237; // esi
  __int64 v238; // r15
  char *v239; // rbx
  __int64 v240; // rdx
  unsigned int v241; // esi
  _QWORD **v242; // rdx
  int v243; // ecx
  __int64 *v244; // rax
  __int64 v245; // rsi
  __int64 v246; // rbx
  char *v247; // r14
  __int64 v248; // rdx
  unsigned int v249; // esi
  __int64 v250; // r14
  char *v251; // rbx
  __int64 v252; // rdx
  unsigned int v253; // esi
  __int64 v254; // rax
  unsigned __int64 v255; // rdx
  __int64 v256; // rax
  unsigned __int64 v257; // rdx
  __int64 v258; // r14
  __int64 v259; // r13
  __int64 v260; // rbx
  __int64 i; // r12
  __int64 v262; // rax
  __int64 v263; // rax
  int v264; // eax
  __int64 v265; // rbx
  __int64 v266; // rax
  char v267; // al
  __int16 v268; // cx
  unsigned __int8 *v269; // rax
  __int64 v270; // r9
  unsigned __int8 *v271; // r15
  __int64 v272; // rbx
  char *v273; // rbx
  __int64 v274; // r12
  __int64 v275; // rdx
  unsigned int v276; // esi
  unsigned __int8 *v277; // rbx
  __int64 v278; // r12
  __int64 *v279; // rax
  unsigned __int64 v280; // rax
  unsigned __int64 v281; // r12
  int v282; // edx
  int v283; // r13d
  __int64 *v284; // r12
  __int64 v285; // rbx
  unsigned __int8 v286; // al
  unsigned int v287; // ebx
  unsigned __int8 v288; // r15
  _QWORD *v289; // rax
  unsigned int *v290; // r12
  unsigned int *v291; // rbx
  __int64 v292; // rdx
  unsigned int v293; // esi
  __int64 v294; // rax
  char v295; // bl
  _QWORD *v296; // rax
  __int64 v297; // r9
  __int64 v298; // r12
  unsigned int *v299; // r15
  unsigned int *v300; // rbx
  __int64 v301; // rdx
  unsigned int v302; // esi
  __int64 v303; // rbx
  __int64 v304; // rax
  char v305; // al
  __int16 v306; // cx
  unsigned __int8 *v307; // rax
  unsigned __int8 *v308; // r15
  __int64 v309; // rbx
  char *v310; // rbx
  __int64 v311; // r12
  __int64 v312; // rdx
  unsigned int v313; // esi
  __int64 v314; // rdi
  __int64 v315; // r14
  void **v316; // r13
  void **v317; // r14
  __int64 v318; // rax
  unsigned __int64 v319; // rsi
  unsigned __int64 v320; // rsi
  __int16 v321; // [rsp+Ah] [rbp-606h]
  __int16 v322; // [rsp+Ch] [rbp-604h]
  __int64 *v323; // [rsp+58h] [rbp-5B8h]
  __int64 v324; // [rsp+58h] [rbp-5B8h]
  __int64 v325; // [rsp+60h] [rbp-5B0h]
  __int64 v326; // [rsp+60h] [rbp-5B0h]
  __int16 v327; // [rsp+68h] [rbp-5A8h]
  unsigned __int64 v328; // [rsp+70h] [rbp-5A0h]
  __int64 *v329; // [rsp+78h] [rbp-598h]
  __int64 v330; // [rsp+80h] [rbp-590h]
  __int64 **v331; // [rsp+90h] [rbp-580h]
  __int64 v332; // [rsp+98h] [rbp-578h]
  __int64 **v333; // [rsp+98h] [rbp-578h]
  __int64 v334; // [rsp+A8h] [rbp-568h]
  __int64 v335; // [rsp+B8h] [rbp-558h]
  __int64 v336; // [rsp+B8h] [rbp-558h]
  __int64 v337; // [rsp+C0h] [rbp-550h]
  __int64 v338; // [rsp+C0h] [rbp-550h]
  __int64 v339; // [rsp+D0h] [rbp-540h]
  __int64 v340; // [rsp+D0h] [rbp-540h]
  __int64 *v341; // [rsp+E8h] [rbp-528h]
  __int64 v342; // [rsp+E8h] [rbp-528h]
  __int64 *v343; // [rsp+E8h] [rbp-528h]
  unsigned __int64 v344; // [rsp+F8h] [rbp-518h]
  unsigned __int64 v345; // [rsp+100h] [rbp-510h]
  unsigned __int64 v346; // [rsp+100h] [rbp-510h]
  __int64 *v347; // [rsp+100h] [rbp-510h]
  unsigned __int8 *v348; // [rsp+100h] [rbp-510h]
  __int64 v350; // [rsp+128h] [rbp-4E8h]
  _BYTE v351[32]; // [rsp+130h] [rbp-4E0h] BYREF
  __int16 v352; // [rsp+150h] [rbp-4C0h]
  int v353[8]; // [rsp+160h] [rbp-4B0h] BYREF
  __int16 v354; // [rsp+180h] [rbp-490h]
  unsigned __int64 v355; // [rsp+190h] [rbp-480h] BYREF
  __int64 v356; // [rsp+198h] [rbp-478h]
  _BYTE v357[16]; // [rsp+1A0h] [rbp-470h] BYREF
  __int16 v358; // [rsp+1B0h] [rbp-460h]
  _BYTE *v359; // [rsp+1C0h] [rbp-450h] BYREF
  __int64 v360; // [rsp+1C8h] [rbp-448h]
  _BYTE v361[32]; // [rsp+1D0h] [rbp-440h] BYREF
  __int64 *v362; // [rsp+1F0h] [rbp-420h] BYREF
  __int64 v363; // [rsp+1F8h] [rbp-418h]
  _BYTE v364[32]; // [rsp+200h] [rbp-410h] BYREF
  __int64 *v365; // [rsp+220h] [rbp-3F0h] BYREF
  __int64 v366; // [rsp+228h] [rbp-3E8h]
  _BYTE v367[32]; // [rsp+230h] [rbp-3E0h] BYREF
  _BYTE *v368; // [rsp+250h] [rbp-3C0h] BYREF
  __int64 v369; // [rsp+258h] [rbp-3B8h]
  _BYTE v370[32]; // [rsp+260h] [rbp-3B0h] BYREF
  _BYTE *v371; // [rsp+280h] [rbp-390h] BYREF
  __int64 v372; // [rsp+288h] [rbp-388h]
  _BYTE v373[128]; // [rsp+290h] [rbp-380h] BYREF
  unsigned int *v374; // [rsp+310h] [rbp-300h] BYREF
  __int64 v375; // [rsp+318h] [rbp-2F8h]
  _BYTE v376[32]; // [rsp+320h] [rbp-2F0h] BYREF
  __int64 v377; // [rsp+340h] [rbp-2D0h]
  __int64 v378; // [rsp+348h] [rbp-2C8h]
  __int64 v379; // [rsp+350h] [rbp-2C0h]
  __int64 *v380; // [rsp+358h] [rbp-2B8h]
  void **v381; // [rsp+360h] [rbp-2B0h]
  void **v382; // [rsp+368h] [rbp-2A8h]
  __int64 v383; // [rsp+370h] [rbp-2A0h]
  int v384; // [rsp+378h] [rbp-298h]
  __int16 v385; // [rsp+37Ch] [rbp-294h]
  char v386; // [rsp+37Eh] [rbp-292h]
  __int64 v387; // [rsp+380h] [rbp-290h]
  __int64 v388; // [rsp+388h] [rbp-288h]
  void *v389; // [rsp+390h] [rbp-280h] BYREF
  void *v390; // [rsp+398h] [rbp-278h] BYREF
  char *v391; // [rsp+3A0h] [rbp-270h] BYREF
  __int64 v392; // [rsp+3A8h] [rbp-268h]
  _BYTE v393[16]; // [rsp+3B0h] [rbp-260h] BYREF
  __int16 v394; // [rsp+3C0h] [rbp-250h]
  __int64 v395; // [rsp+3D0h] [rbp-240h]
  __int64 v396; // [rsp+3D8h] [rbp-238h]
  __int64 v397; // [rsp+3E0h] [rbp-230h]
  _QWORD *v398; // [rsp+3E8h] [rbp-228h]
  void **v399; // [rsp+3F0h] [rbp-220h]
  void **v400; // [rsp+3F8h] [rbp-218h]
  __int64 v401; // [rsp+400h] [rbp-210h]
  int v402; // [rsp+408h] [rbp-208h]
  __int16 v403; // [rsp+40Ch] [rbp-204h]
  char v404; // [rsp+40Eh] [rbp-202h]
  __int64 v405; // [rsp+410h] [rbp-200h]
  __int64 v406; // [rsp+418h] [rbp-1F8h]
  void *v407; // [rsp+420h] [rbp-1F0h] BYREF
  void *v408; // [rsp+428h] [rbp-1E8h] BYREF
  unsigned int *v409; // [rsp+430h] [rbp-1E0h] BYREF
  __int64 v410; // [rsp+438h] [rbp-1D8h]
  _QWORD v411[2]; // [rsp+440h] [rbp-1D0h] BYREF
  __int64 v412; // [rsp+450h] [rbp-1C0h]
  __int64 *v413; // [rsp+458h] [rbp-1B8h]
  __int64 v414; // [rsp+460h] [rbp-1B0h]
  __int64 v415; // [rsp+468h] [rbp-1A8h] BYREF
  __int16 v416; // [rsp+470h] [rbp-1A0h]
  __int64 v417; // [rsp+478h] [rbp-198h]
  void **v418; // [rsp+480h] [rbp-190h]
  void **v419; // [rsp+488h] [rbp-188h]
  __int64 v420; // [rsp+490h] [rbp-180h]
  int v421; // [rsp+498h] [rbp-178h] BYREF
  __int16 v422; // [rsp+49Ch] [rbp-174h]
  char v423; // [rsp+49Eh] [rbp-172h]
  __int64 v424; // [rsp+4A0h] [rbp-170h]
  __int64 v425; // [rsp+4A8h] [rbp-168h]
  void *v426; // [rsp+4B0h] [rbp-160h] BYREF
  void *v427; // [rsp+4B8h] [rbp-158h] BYREF
  _BYTE *v428; // [rsp+558h] [rbp-B8h]
  __int64 v429; // [rsp+560h] [rbp-B0h]
  _BYTE v430[168]; // [rsp+568h] [rbp-A8h] BYREF

  v6 = *a1;
  v371 = v373;
  v372 = 0x1000000000LL;
  v7 = *(_QWORD **)(v6 + 80);
  v8 = v6 + 72;
  v362 = (__int64 *)v364;
  v359 = v361;
  v365 = (__int64 *)v367;
  v9 = (__int64)v370;
  v360 = 0x400000000LL;
  v363 = 0x400000000LL;
  v366 = 0x400000000LL;
  v368 = v370;
  v369 = 0x400000000LL;
  if ( (_QWORD *)(v6 + 72) == v7 )
  {
    v10 = 0;
  }
  else
  {
    if ( !v7 )
      BUG();
    while ( 1 )
    {
      v10 = (_QWORD *)v7[4];
      if ( v10 != v7 + 3 )
        break;
      v7 = (_QWORD *)v7[1];
      if ( (_QWORD *)v8 == v7 )
        goto LABEL_7;
      if ( !v7 )
        BUG();
    }
  }
  if ( (_QWORD *)v8 == v7 )
  {
LABEL_7:
    if ( (*(_BYTE *)(v6 + 2) & 1) == 0 )
      goto LABEL_8;
LABEL_52:
    sub_B2C6D0(v6, a2, a3, v9);
    v11 = *(_QWORD *)(v6 + 96);
    v12 = v11 + 40LL * *(_QWORD *)(v6 + 104);
    if ( (*(_BYTE *)(v6 + 2) & 1) != 0 )
    {
      sub_B2C6D0(v6, a2, v49, v50);
      v11 = *(_QWORD *)(v6 + 96);
    }
    goto LABEL_9;
  }
  do
  {
    if ( !v10 )
      BUG();
    v40 = *((_BYTE *)v10 - 24);
    v41 = v10 - 3;
    switch ( v40 )
    {
      case 60:
        v42 = sub_2F83750(a1[2], (__int64)(v10 - 3));
        a2 = (__int64)(v10 - 3);
        if ( !(unsigned __int8)sub_2F83810((__int64)a1, (__int64)(v10 - 3), v42, v43, v44, v45) )
        {
          if ( sub_B4D040((__int64)(v10 - 3)) )
          {
            v46 = (unsigned int)v372;
            v9 = HIDWORD(v372);
            v47 = (unsigned int)v372 + 1LL;
            if ( v47 > HIDWORD(v372) )
            {
              a2 = (__int64)v373;
              sub_C8D5F0((__int64)&v371, v373, v47, 8u, a5, a6);
              v46 = (unsigned int)v372;
            }
            *(_QWORD *)&v371[8 * v46] = v41;
            LODWORD(v372) = v372 + 1;
          }
          else
          {
            v54 = (unsigned int)v360;
            v9 = HIDWORD(v360);
            v55 = (unsigned int)v360 + 1LL;
            if ( v55 > HIDWORD(v360) )
            {
              a2 = (__int64)v361;
              sub_C8D5F0((__int64)&v359, v361, v55, 8u, a5, a6);
              v54 = (unsigned int)v360;
            }
            *(_QWORD *)&v359[8 * v54] = v41;
            LODWORD(v360) = v360 + 1;
          }
        }
        break;
      case 30:
        v51 = sub_AA4E50(v10[2]);
        if ( v51 )
        {
          v52 = (unsigned int)v366;
          a5 = (unsigned int)v366 + 1LL;
          if ( a5 > HIDWORD(v366) )
          {
            a2 = (__int64)v367;
            v344 = v51;
            sub_C8D5F0((__int64)&v365, v367, (unsigned int)v366 + 1LL, 8u, a5, a6);
            v52 = (unsigned int)v366;
            v51 = v344;
          }
          v9 = (__int64)v365;
          v365[v52] = v51;
          LODWORD(v366) = v366 + 1;
        }
        else
        {
          v256 = (unsigned int)v366;
          v9 = HIDWORD(v366);
          v257 = (unsigned int)v366 + 1LL;
          if ( v257 > HIDWORD(v366) )
          {
            a2 = (__int64)v367;
            sub_C8D5F0((__int64)&v365, v367, v257, 8u, a5, a6);
            v256 = (unsigned int)v366;
          }
          v365[v256] = (__int64)v41;
          LODWORD(v366) = v366 + 1;
        }
        break;
      case 85:
        v53 = *(v10 - 7);
        if ( v53 )
        {
          if ( !*(_BYTE *)v53 )
          {
            v9 = v10[7];
            if ( *(_QWORD *)(v53 + 24) == v9 )
            {
              a2 = 53;
              if ( (unsigned __int8)sub_A73ED0(v10 + 6, 53)
                || (a2 = 53, (unsigned __int8)sub_B49560((__int64)(v10 - 3), 53)) )
              {
LABEL_245:
                v254 = (unsigned int)v369;
                v9 = HIDWORD(v369);
                v255 = (unsigned int)v369 + 1LL;
                if ( v255 > HIDWORD(v369) )
                {
                  a2 = (__int64)v370;
                  sub_C8D5F0((__int64)&v368, v370, v255, 8u, a5, a6);
                  v254 = (unsigned int)v369;
                }
                *(_QWORD *)&v368[8 * v254] = v41;
                LODWORD(v369) = v369 + 1;
              }
            }
          }
        }
        break;
      case 95:
        goto LABEL_245;
    }
    v10 = (_QWORD *)v10[1];
    a3 = 0;
    while ( 1 )
    {
      v48 = v7 - 3;
      if ( !v7 )
        v48 = 0;
      if ( v10 != v48 + 6 )
        break;
      v7 = (_QWORD *)v7[1];
      if ( (_QWORD *)v8 == v7 )
        goto LABEL_7;
      if ( !v7 )
        BUG();
      v10 = (_QWORD *)v7[4];
    }
  }
  while ( (_QWORD *)v8 != v7 );
  if ( (*(_BYTE *)(v6 + 2) & 1) != 0 )
    goto LABEL_52;
LABEL_8:
  v11 = *(_QWORD *)(v6 + 96);
  v12 = v11 + 40LL * *(_QWORD *)(v6 + 104);
LABEL_9:
  while ( v12 != v11 )
  {
    if ( (unsigned __int8)sub_B2D680(v11) )
    {
      v13 = a1[2];
      v14 = sub_B2BD20(v11);
      v15 = sub_9208B0(v13, v14);
      v410 = v16;
      v409 = (unsigned int *)((unsigned __int64)(v15 + 7) >> 3);
      v17 = sub_CA1930(&v409);
      if ( !(unsigned __int8)sub_2F83810((__int64)a1, v11, v17, v18, v19, v20) )
      {
        v23 = (unsigned int)v363;
        v24 = (unsigned int)v363 + 1LL;
        if ( v24 > HIDWORD(v363) )
        {
          sub_C8D5F0((__int64)&v362, v364, v24, 8u, v21, v22);
          v23 = (unsigned int)v363;
        }
        v362[v23] = v11;
        LODWORD(v363) = v363 + 1;
      }
    }
    v11 += 40;
  }
  if ( !((unsigned int)v369 | (unsigned int)v363 | (unsigned int)v372 | (unsigned int)v360) )
  {
    v228 = 0;
    goto LABEL_200;
  }
  v25 = *(_QWORD *)(*a1 + 80);
  if ( v25 )
    v25 -= 24;
  v27 = sub_AA5190(v25);
  if ( v27 )
  {
    v28 = v26;
    v29 = HIBYTE(v26);
  }
  else
  {
    v29 = 0;
    v28 = 0;
  }
  v30 = *(_QWORD *)(*a1 + 80);
  if ( v30 )
    v30 -= 24;
  v31 = (__int64 *)sub_AA48A0(v30);
  v377 = v30;
  v380 = v31;
  v381 = &v389;
  v382 = &v390;
  v374 = (unsigned int *)v376;
  v389 = &unk_49DA100;
  v375 = 0x200000000LL;
  v385 = 512;
  v390 = &unk_49DA0B0;
  LOBYTE(v31) = v28;
  v386 = 7;
  BYTE1(v31) = v29;
  v383 = 0;
  v384 = 0;
  v387 = 0;
  v388 = 0;
  v378 = v27;
  LOWORD(v379) = (_WORD)v31;
  if ( v27 == v30 + 48 )
    goto LABEL_71;
  v32 = v27 - 24;
  if ( !v27 )
    v32 = 0;
  v33 = *(unsigned int **)sub_B46C60(v32);
  v409 = v33;
  if ( !v33 || (sub_B96E90((__int64)&v409, (__int64)v33, 1), (v36 = v409) == 0) )
  {
    sub_93FB40((__int64)&v374, 0);
    v36 = v409;
    goto LABEL_70;
  }
  v37 = v374;
  v38 = v375;
  v39 = &v374[4 * (unsigned int)v375];
  if ( v374 != v39 )
  {
    while ( *v37 )
    {
      v37 += 4;
      if ( v39 == v37 )
        goto LABEL_288;
    }
    *((_QWORD *)v37 + 1) = v409;
LABEL_33:
    sub_B91220((__int64)&v409, (__int64)v36);
    goto LABEL_71;
  }
LABEL_288:
  if ( (unsigned int)v375 >= (unsigned __int64)HIDWORD(v375) )
  {
    v319 = (unsigned int)v375 + 1LL;
    if ( HIDWORD(v375) < v319 )
    {
      sub_C8D5F0((__int64)&v374, v376, v319, 0x10u, v34, v35);
      v39 = &v374[4 * (unsigned int)v375];
    }
    *(_QWORD *)v39 = 0;
    *((_QWORD *)v39 + 1) = v36;
    v36 = v409;
    LODWORD(v375) = v375 + 1;
  }
  else
  {
    if ( v39 )
    {
      *v39 = 0;
      *((_QWORD *)v39 + 1) = v36;
      v38 = v375;
      v36 = v409;
    }
    LODWORD(v375) = v38 + 1;
  }
LABEL_70:
  if ( v36 )
    goto LABEL_33;
LABEL_71:
  v56 = sub_B92180(*a1);
  v58 = v56;
  if ( v56 )
  {
    v59 = *(_DWORD *)(v56 + 20);
    v60 = *(_QWORD *)(v56 + 8);
    v61 = (__int64 *)(v60 & 0xFFFFFFFFFFFFFFF8LL);
    if ( (v60 & 4) != 0 )
      v61 = (__int64 *)*v61;
    v62 = sub_B01860(v61, v59, 0, v58, 0, 0, 0, 1);
    sub_B10CB0(&v409, (__int64)v62);
    v65 = v409;
    if ( !v409 )
    {
      sub_93FB40((__int64)&v374, 0);
      v65 = v409;
      goto LABEL_296;
    }
    v66 = v374;
    v58 = (unsigned int)v375;
    v57 = &v374[4 * (unsigned int)v375];
    if ( v374 != v57 )
    {
      while ( *v66 )
      {
        v66 += 4;
        if ( v57 == v66 )
          goto LABEL_292;
      }
      *((_QWORD *)v66 + 1) = v409;
      goto LABEL_80;
    }
LABEL_292:
    if ( (unsigned int)v375 >= (unsigned __int64)HIDWORD(v375) )
    {
      v320 = (unsigned int)v375 + 1LL;
      if ( HIDWORD(v375) < v320 )
      {
        sub_C8D5F0((__int64)&v374, v376, v320, 0x10u, v63, v64);
        v57 = &v374[4 * (unsigned int)v375];
      }
      *(_QWORD *)v57 = 0;
      *((_QWORD *)v57 + 1) = v65;
      v65 = v409;
      LODWORD(v375) = v375 + 1;
    }
    else
    {
      if ( v57 )
      {
        *v57 = 0;
        *((_QWORD *)v57 + 1) = v65;
        LODWORD(v58) = v375;
        v65 = v409;
      }
      v58 = (unsigned int)(v58 + 1);
      LODWORD(v375) = v58;
    }
LABEL_296:
    if ( v65 )
LABEL_80:
      sub_B91220((__int64)&v409, (__int64)v65);
  }
  if ( (_BYTE)qword_5025148 )
  {
    v278 = *(_QWORD *)(*a1 + 40);
    v279 = (__int64 *)sub_BCE3C0(v380, 0);
    v409 = (unsigned int *)v411;
    v410 = 0;
    v280 = sub_BCF480(v279, v411, 0, 0);
    v281 = sub_BA8C10(v278, (__int64)"__safestack_pointer_address", 0x1Bu, v280, 0);
    v283 = v282;
    if ( v409 != (unsigned int *)v411 )
      _libc_free((unsigned __int64)v409);
    LOWORD(v412) = 257;
    v68 = sub_921880(&v374, v281, v283, 0, 0, (__int64)&v409, 0);
    a1[8] = v68;
  }
  else
  {
    v67 = (*(__int64 (__fastcall **)(__int64, unsigned int **, unsigned int *, __int64))(*(_QWORD *)a1[1] + 960LL))(
            a1[1],
            &v374,
            v57,
            v58);
    a1[8] = v67;
    v68 = v67;
  }
  v391 = "unsafe_stack_ptr";
  v394 = 259;
  v69 = a1[5];
  v70 = sub_AA4E30(v377);
  v71 = sub_AE5020(v70, v69);
  LOWORD(v412) = 257;
  v72 = sub_BD2C40(80, 1u);
  v328 = (unsigned __int64)v72;
  if ( v72 )
    sub_B4D190((__int64)v72, v69, v68, (__int64)&v409, 0, v71, 0, 0);
  (*((void (__fastcall **)(void **, unsigned __int64, char **, __int64, __int64))*v382 + 2))(
    v382,
    v328,
    &v391,
    v378,
    v379);
  v73 = v374;
  v74 = &v374[4 * (unsigned int)v375];
  if ( v374 != v74 )
  {
    do
    {
      v75 = *((_QWORD *)v73 + 1);
      v76 = *v73;
      v73 += 4;
      sub_B99FD0(v328, v76, v75);
    }
    while ( v74 != v73 );
  }
  if ( (unsigned __int8)sub_B2D610(*a1, 69)
    || (unsigned __int8)sub_B2D610(*a1, 71)
    || (v84 = 0, (unsigned __int8)sub_B2D610(*a1, 70)) )
  {
    v77 = sub_2F835F0((__int64)a1, (__int64)&v374, *a1);
    v78 = (__int64 *)a1[5];
    v394 = 257;
    v335 = v77;
    v79 = sub_AA4E30(v377);
    v80 = sub_AE5260(v79, (__int64)v78);
    v81 = *(_DWORD *)(v79 + 4);
    v82 = v80;
    LOWORD(v412) = 257;
    v83 = sub_BD2C40(80, 1u);
    v84 = (__int64)v83;
    if ( v83 )
      sub_B4CCA0((__int64)v83, v78, v81, 0, v82, (__int64)&v409, 0, 0);
    (*((void (__fastcall **)(void **, __int64, char **, __int64, __int64))*v382 + 2))(v382, v84, &v391, v378, v379);
    v85 = v374;
    v86 = &v374[4 * (unsigned int)v375];
    if ( v374 != v86 )
    {
      do
      {
        v87 = *((_QWORD *)v85 + 1);
        v88 = *v85;
        v85 += 4;
        sub_B99FD0(v84, v88, v87);
      }
      while ( v86 != v85 );
    }
    v89 = sub_AA4E30(v377);
    v90 = sub_AE5020(v89, *(_QWORD *)(v335 + 8));
    LOWORD(v412) = 257;
    v91 = sub_BD2C40(80, unk_3F10A10);
    v93 = (__int64)v91;
    if ( v91 )
      sub_B4D3C0((__int64)v91, v335, v84, 0, v90, v92, 0, 0);
    (*((void (__fastcall **)(void **, __int64, unsigned int **, __int64, __int64))*v382 + 2))(
      v382,
      v93,
      &v409,
      v378,
      v379);
    v94 = v374;
    v95 = &v374[4 * (unsigned int)v375];
    if ( v374 != v95 )
    {
      do
      {
        v96 = *((_QWORD *)v94 + 1);
        v97 = *v94;
        v94 += 4;
        sub_B99FD0(v93, v97, v96);
      }
      while ( v95 != v94 );
    }
    v323 = &v365[(unsigned int)v366];
    if ( v323 != v365 )
    {
      v341 = v365;
      v98 = v337;
      v325 = v84;
      while ( 1 )
      {
        v99 = *v341;
        v330 = *v341;
        v398 = (_QWORD *)sub_BD5C60(*v341);
        v391 = v393;
        v399 = &v407;
        v403 = 512;
        v400 = &v408;
        LOWORD(v397) = 0;
        v407 = &unk_49DA100;
        v392 = 0x200000000LL;
        v408 = &unk_49DA0B0;
        v401 = 0;
        v402 = 0;
        v404 = 7;
        v405 = 0;
        v406 = 0;
        v395 = 0;
        v396 = 0;
        sub_D5F1F0((__int64)&v391, v99);
        v358 = 257;
        v100 = a1[5];
        v338 = *a1;
        v101 = sub_AA4E30(v395);
        v102 = sub_AE5020(v101, v100);
        LOWORD(v412) = 257;
        v103 = v102;
        v104 = (unsigned __int8 *)sub_BD2C40(80, 1u);
        v105 = v104;
        if ( v104 )
          sub_B4D190((__int64)v104, v100, v325, (__int64)&v409, 0, v103, 0, 0);
        (*((void (__fastcall **)(void **, unsigned __int8 *, unsigned __int64 *, __int64, __int64))*v400 + 2))(
          v400,
          v105,
          &v355,
          v396,
          v397);
        v106 = (__int64)v391;
        v107 = &v391[16 * (unsigned int)v392];
        if ( v391 != v107 )
        {
          do
          {
            v108 = *(_QWORD *)(v106 + 8);
            v109 = *(_DWORD *)v106;
            v106 += 16;
            sub_B99FD0((__int64)v105, v109, v108);
          }
          while ( v107 != (char *)v106 );
        }
        v358 = 257;
        v110 = (__int64 (__fastcall *)(__int64, unsigned int, _BYTE *, unsigned __int8 *))*((_QWORD *)*v399 + 7);
        if ( v110 == sub_928890 )
        {
          if ( *(_BYTE *)v335 > 0x15u || *v105 > 0x15u )
            goto LABEL_220;
          v111 = sub_AAB310(0x21u, (unsigned __int8 *)v335, v105);
        }
        else
        {
          v111 = v110((__int64)v399, 33u, (_BYTE *)v335, v105);
        }
        if ( v111 )
          goto LABEL_108;
LABEL_220:
        LOWORD(v412) = 257;
        v111 = (__int64)sub_BD2C40(72, unk_3F10FD0);
        if ( v111 )
        {
          v242 = *(_QWORD ***)(v335 + 8);
          v243 = *((unsigned __int8 *)v242 + 8);
          if ( (unsigned int)(v243 - 17) > 1 )
          {
            v245 = sub_BCB2A0(*v242);
          }
          else
          {
            BYTE4(v350) = (_BYTE)v243 == 18;
            LODWORD(v350) = *((_DWORD *)v242 + 8);
            v244 = (__int64 *)sub_BCB2A0(*v242);
            v245 = sub_BCE1B0(v244, v350);
          }
          sub_B523C0(v111, v245, 53, 33, v335, (__int64)v105, (__int64)&v409, 0, 0, 0);
        }
        (*((void (__fastcall **)(void **, __int64, unsigned __int64 *, __int64, __int64))*v400 + 2))(
          v400,
          v111,
          &v355,
          v396,
          v397);
        v246 = (__int64)v391;
        v247 = &v391[16 * (unsigned int)v392];
        if ( v391 == v247 )
        {
LABEL_108:
          if ( !byte_5025188[0] )
            goto LABEL_227;
          goto LABEL_109;
        }
        do
        {
          v248 = *(_QWORD *)(v246 + 8);
          v249 = *(_DWORD *)v246;
          v246 += 16;
          sub_B99FD0(v111, v249, v248);
        }
        while ( v247 != (char *)v246 );
        if ( !byte_5025188[0] )
        {
LABEL_227:
          if ( (unsigned int)sub_2207590((__int64)byte_5025188) )
          {
            sub_F02DB0(dword_5025190, 0xFFFFFu, 0x100000u);
            sub_2207640((__int64)byte_5025188);
          }
        }
LABEL_109:
        v112 = dword_5025190[0];
        if ( !byte_5025188[0] && (unsigned int)sub_2207590((__int64)byte_5025188) )
        {
          sub_F02DB0(dword_5025190, 0xFFFFFu, 0x100000u);
          sub_2207640((__int64)byte_5025188);
        }
        LOWORD(v98) = 0;
        v113 = 0x80000000 - dword_5025190[0];
        v409 = (unsigned int *)sub_B2BE50(v338);
        v114 = sub_B8C2F0(&v409, v112, v113, 0);
        v115 = sub_F38250(v111, (__int64 *)(v330 + 24), v98, 1, v114, a1[3], 0, 0);
        v417 = sub_BD5C60(v115);
        v409 = (unsigned int *)v411;
        v410 = 0x200000000LL;
        v422 = 512;
        v418 = &v426;
        v416 = 0;
        v419 = &v427;
        v420 = 0;
        v426 = &unk_49DA100;
        v421 = 0;
        v427 = &unk_49DA0B0;
        v423 = 7;
        v424 = 0;
        v425 = 0;
        v414 = 0;
        v415 = 0;
        sub_D5F1F0((__int64)&v409, v115);
        v116 = *(_QWORD *)(v338 + 40);
        v117 = (__int64 *)sub_BCB120(v398);
        v356 = 0;
        v355 = (unsigned __int64)v357;
        v118 = sub_BCF480(v117, v357, 0, 0);
        v119 = sub_BA8C10(v116, (__int64)"__stack_chk_fail", 0x10u, v118, 0);
        v121 = v120;
        if ( (_BYTE *)v355 != v357 )
          _libc_free(v355);
        v358 = 257;
        sub_921880(&v409, v119, v121, 0, 0, (__int64)&v355, 0);
        nullsub_61();
        v426 = &unk_49DA100;
        nullsub_63();
        if ( v409 != (unsigned int *)v411 )
          _libc_free((unsigned __int64)v409);
        nullsub_61();
        v407 = &unk_49DA100;
        nullsub_63();
        if ( v391 != v393 )
          _libc_free((unsigned __int64)v391);
        if ( v323 == ++v341 )
        {
          v84 = v325;
          break;
        }
      }
    }
  }
  v122 = sub_2F849E0(a1, (__int64)&v374, *a1, (__int64)v371, (unsigned int)v372, v328, v362, (unsigned int)v363, v84);
  v123 = (unsigned int)v369;
  v124 = v122;
  v125 = v360;
  v345 = (unsigned __int64)v368;
  if ( (_DWORD)v369 )
  {
    if ( (_DWORD)v360 )
    {
      v391 = "unsafe_stack_dynamic_ptr";
      v394 = 259;
      v284 = (__int64 *)a1[5];
      v285 = sub_AA4E30(v377);
      v286 = sub_AE5260(v285, (__int64)v284);
      v287 = *(_DWORD *)(v285 + 4);
      v288 = v286;
      LOWORD(v412) = 257;
      v289 = sub_BD2C40(80, 1u);
      v336 = (__int64)v289;
      if ( v289 )
        sub_B4CCA0((__int64)v289, v284, v287, 0, v288, (__int64)&v409, 0, 0);
      (*((void (__fastcall **)(void **, __int64, char **, __int64, __int64))*v382 + 2))(v382, v336, &v391, v378, v379);
      v290 = v374;
      v291 = &v374[4 * (unsigned int)v375];
      if ( v374 != v291 )
      {
        do
        {
          v292 = *((_QWORD *)v290 + 1);
          v293 = *v290;
          v290 += 4;
          sub_B99FD0(v336, v293, v292);
        }
        while ( v291 != v290 );
      }
      v294 = sub_AA4E30(v377);
      v295 = sub_AE5020(v294, *(_QWORD *)(v124 + 8));
      LOWORD(v412) = 257;
      v296 = sub_BD2C40(80, unk_3F10A10);
      v298 = (__int64)v296;
      if ( v296 )
        sub_B4D3C0((__int64)v296, v124, v336, 0, v295, v297, 0, 0);
      (*((void (__fastcall **)(void **, __int64, unsigned int **, __int64, __int64))*v382 + 2))(
        v382,
        v298,
        &v409,
        v378,
        v379);
      v299 = v374;
      v300 = &v374[4 * (unsigned int)v375];
      if ( v374 != v300 )
      {
        do
        {
          v301 = *((_QWORD *)v299 + 1);
          v302 = *v299;
          v299 += 4;
          sub_B99FD0(v298, v302, v301);
        }
        while ( v300 != v299 );
      }
    }
    else
    {
      v336 = 0;
    }
    v342 = v124;
    v126 = v345 + 8 * v123;
    v127 = v345;
    v346 = v126;
    do
    {
      v128 = *(_QWORD *)(*(_QWORD *)v127 + 32LL);
      if ( v128 == *(_QWORD *)(*(_QWORD *)v127 + 40LL) + 48LL || !v128 )
        v129 = 0;
      else
        v129 = v128 - 24;
      sub_D5F1F0((__int64)&v374, v129);
      v130 = v342;
      if ( v336 )
      {
        v394 = 257;
        v131 = a1[5];
        v132 = sub_AA4E30(v377);
        v133 = sub_AE5020(v132, v131);
        HIBYTE(v134) = HIBYTE(v327);
        LOWORD(v412) = 257;
        LOBYTE(v134) = v133;
        v327 = v134;
        v135 = sub_BD2C40(80, 1u);
        v130 = (__int64)v135;
        if ( v135 )
          sub_B4D190((__int64)v135, v131, v336, (__int64)&v409, 0, v327, 0, 0);
        (*((void (__fastcall **)(void **, __int64, char **, __int64, __int64))*v382 + 2))(v382, v130, &v391, v378, v379);
        v136 = v374;
        v137 = &v374[4 * (unsigned int)v375];
        if ( v374 != v137 )
        {
          do
          {
            v138 = *((_QWORD *)v136 + 1);
            v139 = *v136;
            v136 += 4;
            sub_B99FD0(v130, v139, v138);
          }
          while ( v137 != v136 );
        }
      }
      v140 = a1[8];
      v141 = sub_AA4E30(v377);
      v142 = sub_AE5020(v141, *(_QWORD *)(v130 + 8));
      LOWORD(v412) = 257;
      v143 = sub_BD2C40(80, unk_3F10A10);
      v145 = (__int64)v143;
      if ( v143 )
        sub_B4D3C0((__int64)v143, v130, v140, 0, v142, v144, 0, 0);
      (*((void (__fastcall **)(void **, __int64, unsigned int **, __int64, __int64))*v382 + 2))(
        v382,
        v145,
        &v409,
        v378,
        v379);
      v146 = v374;
      v147 = &v374[4 * (unsigned int)v375];
      if ( v374 != v147 )
      {
        do
        {
          v148 = *((_QWORD *)v146 + 1);
          v149 = *v146;
          v146 += 4;
          sub_B99FD0(v145, v149, v148);
        }
        while ( v147 != v146 );
      }
      v127 += 8LL;
    }
    while ( v346 != v127 );
    v125 = v360;
  }
  else
  {
    v336 = 0;
  }
  v150 = v125;
  v151 = (unsigned __int64)v359;
  v326 = v125;
  v152 = *(__int64 **)(*a1 + 40);
  v334 = a1[8];
  v324 = *a1;
  sub_AE0470((__int64)&v409, v152, 1, 0);
  v329 = (__int64 *)(v151 + 8 * v150);
  if ( (__int64 *)v151 != v329 )
  {
    v343 = (__int64 *)v151;
    while ( 1 )
    {
      v153 = *v343;
      v398 = (_QWORD *)sub_BD5C60(*v343);
      v391 = v393;
      v399 = &v407;
      v392 = 0x200000000LL;
      v400 = &v408;
      LOWORD(v397) = 0;
      v407 = &unk_49DA100;
      v401 = 0;
      v408 = &unk_49DA0B0;
      v402 = 0;
      v403 = 512;
      v404 = 7;
      v405 = 0;
      v406 = 0;
      v395 = 0;
      v396 = 0;
      sub_D5F1F0((__int64)&v391, v153);
      v154 = *(_QWORD *)(v153 - 32);
      v155 = (__int64 **)a1[6];
      if ( *(__int64 ***)(v154 + 8) != v155 )
      {
        v358 = 257;
        v156 = sub_BCB060(*(_QWORD *)(v154 + 8));
        v157 = sub_BCB060((__int64)v155);
        v154 = sub_2F83F20(
                 (__int64 *)&v391,
                 (unsigned int)(v156 <= v157) + 38,
                 v154,
                 v155,
                 (__int64)&v355,
                 0,
                 v353[0],
                 0);
      }
      v158 = *(_QWORD *)(v153 + 72);
      v159 = a1[2];
      v332 = v158;
      v160 = sub_AE5020(v159, v158);
      v161 = sub_9208B0(v159, v158);
      v356 = v162;
      v355 = ((1LL << v160) + ((unsigned __int64)(v161 + 7) >> 3) - 1) >> v160 << v160;
      v163 = sub_CA1930(&v355);
      v354 = 257;
      v164 = (unsigned __int8 *)sub_AD64C0(a1[6], v163, 0);
      v165 = (__int64 (__fastcall *)(__int64, unsigned int, _BYTE *, unsigned __int8 *, unsigned __int8, char))*((_QWORD *)*v399 + 4);
      if ( v165 != sub_9201A0 )
        break;
      if ( *(_BYTE *)v154 <= 0x15u && *v164 <= 0x15u )
      {
        if ( (unsigned __int8)sub_AC47B0(17) )
          v166 = (unsigned __int8 *)sub_AD5570(17, v154, v164, 0, 0);
        else
          v166 = (unsigned __int8 *)sub_AABE40(0x11u, (unsigned __int8 *)v154, v164);
LABEL_145:
        if ( v166 )
          goto LABEL_146;
      }
      v358 = 257;
      v166 = (unsigned __int8 *)sub_B504D0(17, v154, (__int64)v164, (__int64)&v355, 0, 0);
      (*((void (__fastcall **)(void **, unsigned __int8 *, int *, __int64, __int64))*v400 + 2))(
        v400,
        v166,
        v353,
        v396,
        v397);
      v238 = (__int64)v391;
      v239 = &v391[16 * (unsigned int)v392];
      if ( v391 != v239 )
      {
        do
        {
          v240 = *(_QWORD *)(v238 + 8);
          v241 = *(_DWORD *)v238;
          v238 += 16;
          sub_B99FD0((__int64)v166, v241, v240);
        }
        while ( v239 != (char *)v238 );
      }
LABEL_146:
      v354 = 257;
      v167 = (__int64 **)a1[6];
      v168 = a1[5];
      v352 = 257;
      v331 = v167;
      v169 = sub_AA4E30(v395);
      v170 = sub_AE5020(v169, v168);
      v358 = 257;
      v171 = v170;
      v172 = sub_BD2C40(80, 1u);
      v173 = (unsigned __int64)v172;
      if ( v172 )
        sub_B4D190((__int64)v172, v168, v334, (__int64)&v355, 0, v171, 0, 0);
      (*((void (__fastcall **)(void **, unsigned __int64, _BYTE *, __int64, __int64))*v400 + 2))(
        v400,
        v173,
        v351,
        v396,
        v397);
      v174 = (__int64)v391;
      v175 = &v391[16 * (unsigned int)v392];
      if ( v391 != v175 )
      {
        do
        {
          v176 = *(_QWORD *)(v174 + 8);
          v177 = *(_DWORD *)v174;
          v174 += 16;
          sub_B99FD0(v173, v177, v176);
        }
        while ( v175 != (char *)v174 );
      }
      v178 = (unsigned __int8 *)sub_2F83F20((__int64 *)&v391, 0x2Fu, v173, v331, (__int64)v353, 0, v355, 0);
      v354 = 257;
      v179 = (__int64 (__fastcall *)(__int64, unsigned int, unsigned __int8 *, unsigned __int8 *, unsigned __int8, char))*((_QWORD *)*v399 + 4);
      if ( v179 != sub_9201A0 )
      {
        v180 = (unsigned __int8 *)v179((__int64)v399, 15u, v178, v166, 0, 0);
        goto LABEL_155;
      }
      if ( *v178 <= 0x15u && *v166 <= 0x15u )
      {
        if ( (unsigned __int8)sub_AC47B0(15) )
          v180 = (unsigned __int8 *)sub_AD5570(15, (__int64)v178, v166, 0, 0);
        else
          v180 = (unsigned __int8 *)sub_AABE40(0xFu, v178, v166);
LABEL_155:
        if ( v180 )
          goto LABEL_156;
      }
      v358 = 257;
      v180 = (unsigned __int8 *)sub_B504D0(15, (__int64)v178, (__int64)v166, (__int64)&v355, 0, 0);
      (*((void (__fastcall **)(void **, unsigned __int8 *, int *, __int64, __int64))*v400 + 2))(
        v400,
        v180,
        v353,
        v396,
        v397);
      v234 = (__int64)v391;
      v235 = &v391[16 * (unsigned int)v392];
      if ( v391 != v235 )
      {
        do
        {
          v236 = *(_QWORD *)(v234 + 8);
          v237 = *(_DWORD *)v234;
          v234 += 16;
          sub_B99FD0((__int64)v180, v237, v236);
        }
        while ( v235 != (char *)v234 );
      }
LABEL_156:
      _BitScanReverse64(&v181, 1LL << *(_WORD *)(v153 + 2));
      v182 = sub_AE5260(a1[2], v332);
      v183 = 63 - (v181 ^ 0x3F);
      v184 = a1[6];
      v354 = 257;
      if ( v182 > v183 )
        v183 = v182;
      v185 = -(1LL << v183);
      if ( v183 <= 3u )
        v185 = -16;
      v333 = (__int64 **)a1[5];
      v352 = 257;
      v186 = (unsigned __int8 *)sub_AD64C0(v184, v185, 0);
      v187 = (__int64 (__fastcall *)(__int64, unsigned int, unsigned __int8 *, unsigned __int8 *))*((_QWORD *)*v399 + 2);
      if ( v187 == sub_9202E0 )
      {
        if ( *v180 > 0x15u || *v186 > 0x15u )
        {
LABEL_211:
          v358 = 257;
          v188 = sub_B504D0(28, (__int64)v180, (__int64)v186, (__int64)&v355, 0, 0);
          (*((void (__fastcall **)(void **, __int64, _BYTE *, __int64, __int64))*v400 + 2))(
            v400,
            v188,
            v351,
            v396,
            v397);
          v230 = (__int64)v391;
          v231 = &v391[16 * (unsigned int)v392];
          if ( v391 != v231 )
          {
            do
            {
              v232 = *(_QWORD *)(v230 + 8);
              v233 = *(_DWORD *)v230;
              v230 += 16;
              sub_B99FD0(v188, v233, v232);
            }
            while ( v231 != (char *)v230 );
          }
          goto LABEL_166;
        }
        if ( (unsigned __int8)sub_AC47B0(28) )
          v188 = sub_AD5570(28, (__int64)v180, v186, 0, 0);
        else
          v188 = sub_AABE40(0x1Cu, v180, v186);
      }
      else
      {
        v188 = v187((__int64)v399, 28u, v180, v186);
      }
      if ( !v188 )
        goto LABEL_211;
LABEL_166:
      v189 = sub_2F83F20((__int64 *)&v391, 0x30u, v188, v333, (__int64)v353, 0, v355, 0);
      v190 = sub_AA4E30(v395);
      v191 = sub_AE5020(v190, *(_QWORD *)(v189 + 8));
      v358 = 257;
      v192 = v191;
      v193 = sub_BD2C40(80, unk_3F10A10);
      v195 = (__int64)v193;
      if ( v193 )
        sub_B4D3C0((__int64)v193, v189, v334, 0, v192, v194, 0, 0);
      (*((void (__fastcall **)(void **, __int64, unsigned __int64 *, __int64, __int64))*v400 + 2))(
        v400,
        v195,
        &v355,
        v396,
        v397);
      v196 = (__int64)v391;
      v197 = &v391[16 * (unsigned int)v392];
      if ( v391 != v197 )
      {
        do
        {
          v198 = *(_QWORD *)(v196 + 8);
          v199 = *(_DWORD *)v196;
          v196 += 16;
          sub_B99FD0(v195, v199, v198);
        }
        while ( v197 != (char *)v196 );
      }
      if ( v336 )
      {
        v200 = sub_AA4E30(v395);
        v201 = sub_AE5020(v200, *(_QWORD *)(v189 + 8));
        v358 = 257;
        v202 = v201;
        v203 = sub_BD2C40(80, unk_3F10A10);
        v205 = (__int64)v203;
        if ( v203 )
          sub_B4D3C0((__int64)v203, v189, v336, 0, v202, v204, 0, 0);
        (*((void (__fastcall **)(void **, __int64, unsigned __int64 *, __int64, __int64))*v400 + 2))(
          v400,
          v205,
          &v355,
          v396,
          v397);
        v206 = (__int64)v391;
        v207 = &v391[16 * (unsigned int)v392];
        if ( v391 != v207 )
        {
          do
          {
            v208 = *(_QWORD *)(v206 + 8);
            v209 = *(_DWORD *)v206;
            v206 += 16;
            sub_B99FD0(v205, v209, v208);
          }
          while ( v207 != (char *)v206 );
        }
      }
      v354 = 257;
      v210 = *(_QWORD *)(v153 + 8);
      if ( v210 != *(_QWORD *)(v189 + 8) )
      {
        if ( *(_BYTE *)v189 > 0x15u )
        {
          v358 = 257;
          v189 = sub_B52210(v189, v210, (__int64)&v355, 0, 0);
          (*((void (__fastcall **)(void **, __int64, int *, __int64, __int64))*v400 + 2))(v400, v189, v353, v396, v397);
          v250 = (__int64)v391;
          v251 = &v391[16 * (unsigned int)v392];
          if ( v391 != v251 )
          {
            do
            {
              v252 = *(_QWORD *)(v250 + 8);
              v253 = *(_DWORD *)v250;
              v250 += 16;
              sub_B99FD0(v189, v253, v252);
            }
            while ( v251 != (char *)v250 );
          }
        }
        else
        {
          v211 = (__int64 (__fastcall *)(__int64, __int64, __int64))*((_QWORD *)*v399 + 17);
          if ( v211 == sub_928970 )
            v189 = sub_ADAFB0(v189, v210);
          else
            v189 = v211((__int64)v399, v189, *(_QWORD *)(v153 + 8));
          if ( *(_BYTE *)v189 > 0x1Cu )
          {
            (*((void (__fastcall **)(void **, __int64, int *, __int64, __int64))*v400 + 2))(
              v400,
              v189,
              v353,
              v396,
              v397);
            v212 = (__int64)v391;
            v213 = &v391[16 * (unsigned int)v392];
            if ( v391 != v213 )
            {
              do
              {
                v214 = *(_QWORD *)(v212 + 8);
                v215 = *(_DWORD *)v212;
                v212 += 16;
                sub_B99FD0(v189, v215, v214);
              }
              while ( v213 != (char *)v212 );
            }
          }
        }
      }
      if ( (*(_BYTE *)(v153 + 7) & 0x10) != 0 && *(_BYTE *)v189 > 0x1Cu )
        sub_BD6B90((unsigned __int8 *)v189, (unsigned __int8 *)v153);
      sub_F52DE0((unsigned __int8 *)v153, (unsigned __int8 *)v189, (__int64)&v409, 0, 0);
      v152 = (__int64 *)v189;
      sub_BD84D0(v153, v189);
      sub_B43D60((_QWORD *)v153);
      nullsub_61();
      v407 = &unk_49DA100;
      nullsub_63();
      if ( v391 != v393 )
        _libc_free((unsigned __int64)v391);
      if ( v329 == ++v343 )
        goto LABEL_188;
    }
    v166 = (unsigned __int8 *)v165((__int64)v399, 17u, (_BYTE *)v154, v164, 0, 0);
    goto LABEL_145;
  }
LABEL_188:
  if ( v326 )
  {
    v258 = *(_QWORD *)(v324 + 80);
    v259 = v324 + 72;
    if ( v324 + 72 != v258 )
    {
      if ( !v258 )
        BUG();
      while ( 1 )
      {
        v260 = *(_QWORD *)(v258 + 32);
        if ( v260 != v258 + 24 )
          break;
        v258 = *(_QWORD *)(v258 + 8);
        if ( v259 == v258 )
          goto LABEL_189;
        if ( !v258 )
          BUG();
      }
      if ( v259 != v258 )
      {
        while ( 2 )
        {
          for ( i = *(_QWORD *)(v260 + 8); ; i = *(_QWORD *)(v258 + 32) )
          {
            v262 = v258 - 24;
            if ( !v258 )
              v262 = 0;
            if ( i != v262 + 48 )
              break;
            v258 = *(_QWORD *)(v258 + 8);
            if ( v259 == v258 )
            {
              if ( *(_BYTE *)(v260 - 24) == 85 )
              {
                v348 = (unsigned __int8 *)(v260 - 24);
                v263 = *(_QWORD *)(v260 - 56);
                if ( v263 )
                {
                  if ( !*(_BYTE *)v263 )
                    goto LABEL_272;
                }
              }
              goto LABEL_189;
            }
            if ( !v258 )
              BUG();
          }
          if ( *(_BYTE *)(v260 - 24) != 85
            || (v348 = (unsigned __int8 *)(v260 - 24), (v263 = *(_QWORD *)(v260 - 56)) == 0)
            || *(_BYTE *)v263 )
          {
LABEL_267:
            if ( v259 == v258 )
              goto LABEL_189;
            v260 = i;
            continue;
          }
          break;
        }
LABEL_272:
        if ( *(_QWORD *)(v263 + 24) != *(_QWORD *)(v260 + 56) || (*(_BYTE *)(v263 + 33) & 0x20) == 0 )
          goto LABEL_267;
        v264 = *(_DWORD *)(v263 + 36);
        if ( v264 == 343 )
        {
          v398 = (_QWORD *)sub_BD5C60((__int64)v348);
          v399 = &v407;
          v400 = &v408;
          LOWORD(v397) = 0;
          v391 = v393;
          v407 = &unk_49DA100;
          v392 = 0x200000000LL;
          v403 = 512;
          v408 = &unk_49DA0B0;
          v401 = 0;
          v402 = 0;
          v404 = 7;
          v405 = 0;
          v406 = 0;
          v395 = 0;
          v396 = 0;
          sub_D5F1F0((__int64)&v391, (__int64)v348);
          v354 = 257;
          v303 = a1[5];
          v304 = sub_AA4E30(v395);
          v305 = sub_AE5020(v304, v303);
          HIBYTE(v306) = HIBYTE(v322);
          LOBYTE(v306) = v305;
          v358 = 257;
          v322 = v306;
          v307 = (unsigned __int8 *)sub_BD2C40(80, 1u);
          v308 = v307;
          if ( v307 )
            sub_B4D190((__int64)v307, v303, v334, (__int64)&v355, 0, v322, 0, 0);
          (*((void (__fastcall **)(void **, unsigned __int8 *, int *, __int64, __int64))*v400 + 2))(
            v400,
            v308,
            v353,
            v396,
            v397);
          v309 = 16LL * (unsigned int)v392;
          if ( v391 != &v391[v309] )
          {
            v340 = i;
            v310 = &v391[v309];
            v311 = (__int64)v391;
            do
            {
              v312 = *(_QWORD *)(v311 + 8);
              v313 = *(_DWORD *)v311;
              v311 += 16;
              sub_B99FD0((__int64)v308, v313, v312);
            }
            while ( v310 != (char *)v311 );
            i = v340;
          }
          v277 = v348;
          sub_BD6B90(v308, v348);
          v152 = (__int64 *)v308;
          sub_BD84D0((__int64)v348, (__int64)v308);
        }
        else
        {
          if ( v264 != 342 )
            goto LABEL_267;
          v398 = (_QWORD *)sub_BD5C60((__int64)v348);
          v399 = &v407;
          v400 = &v408;
          v391 = v393;
          v407 = &unk_49DA100;
          v392 = 0x200000000LL;
          v403 = 512;
          LOWORD(v397) = 0;
          v408 = &unk_49DA0B0;
          v401 = 0;
          v402 = 0;
          v404 = 7;
          v405 = 0;
          v406 = 0;
          v395 = 0;
          v396 = 0;
          sub_D5F1F0((__int64)&v391, (__int64)v348);
          v265 = *(_QWORD *)&v348[-32 * (*(_DWORD *)(v260 - 20) & 0x7FFFFFF)];
          v266 = sub_AA4E30(v395);
          v267 = sub_AE5020(v266, *(_QWORD *)(v265 + 8));
          HIBYTE(v268) = HIBYTE(v321);
          v358 = 257;
          LOBYTE(v268) = v267;
          v321 = v268;
          v269 = (unsigned __int8 *)sub_BD2C40(80, unk_3F10A10);
          v271 = v269;
          if ( v269 )
            sub_B4D3C0((__int64)v269, v265, v334, 0, v321, v270, 0, 0);
          (*((void (__fastcall **)(void **, unsigned __int8 *, unsigned __int64 *, __int64, __int64))*v400 + 2))(
            v400,
            v271,
            &v355,
            v396,
            v397);
          v272 = 16LL * (unsigned int)v392;
          if ( v391 != &v391[v272] )
          {
            v339 = i;
            v273 = &v391[v272];
            v274 = (__int64)v391;
            do
            {
              v275 = *(_QWORD *)(v274 + 8);
              v276 = *(_DWORD *)v274;
              v274 += 16;
              sub_B99FD0((__int64)v271, v276, v275);
            }
            while ( v273 != (char *)v274 );
            i = v339;
          }
          v277 = v348;
          v152 = (__int64 *)v348;
          sub_BD6B90(v271, v348);
        }
        sub_B43D60(v277);
        nullsub_61();
        v407 = &unk_49DA100;
        nullsub_63();
        if ( v391 != v393 )
          _libc_free((unsigned __int64)v391);
        goto LABEL_267;
      }
    }
  }
LABEL_189:
  sub_AE9130((__int64)&v409, (__int64)v152);
  v216 = v365;
  if ( &v365[(unsigned int)v366] != v365 )
  {
    v347 = &v365[(unsigned int)v366];
    do
    {
      sub_D5F1F0((__int64)&v374, *v216);
      v217 = a1[8];
      v218 = sub_AA4E30(v377);
      v219 = sub_AE5020(v218, *(_QWORD *)(v328 + 8));
      LOWORD(v412) = 257;
      v220 = sub_BD2C40(80, unk_3F10A10);
      v222 = (__int64)v220;
      if ( v220 )
        sub_B4D3C0((__int64)v220, v328, v217, 0, v219, v221, 0, 0);
      (*((void (__fastcall **)(void **, __int64, unsigned int **, __int64, __int64))*v382 + 2))(
        v382,
        v222,
        &v409,
        v378,
        v379);
      v223 = v374;
      v224 = &v374[4 * (unsigned int)v375];
      if ( v374 != v224 )
      {
        do
        {
          v225 = *((_QWORD *)v223 + 1);
          v226 = *v223;
          v223 += 4;
          sub_B99FD0(v222, v226, v225);
        }
        while ( v224 != v223 );
      }
      ++v216;
    }
    while ( v347 != v216 );
  }
  v227 = a1[8];
  if ( *(_BYTE *)v227 == 85 && !(unsigned __int8)sub_B2D610(*a1, 48) )
  {
    v314 = *(_QWORD *)(v227 - 32);
    if ( v314 )
    {
      if ( !*(_BYTE *)v314 && *(_QWORD *)(v314 + 24) == *(_QWORD *)(v227 + 80) && !sub_B2FC80(v314) )
      {
        v315 = *(_QWORD *)(v227 - 32);
        if ( v315 )
        {
          if ( *(_BYTE *)v315 )
          {
            v315 = 0;
          }
          else if ( *(_QWORD *)(v315 + 24) != *(_QWORD *)(v227 + 80) )
          {
            v315 = 0;
          }
        }
        if ( ((unsigned __int8)sub_A73ED0((_QWORD *)(v227 + 72), 3) || (unsigned __int8)sub_B49560(v227, 3))
          && !sub_30D6380(v315)
          || !(unsigned __int8)sub_B2F6B0(v315)
          && !(unsigned __int8)sub_B2D610(v315, 31)
          && !(unsigned __int8)sub_A73ED0((_QWORD *)(v227 + 72), 31)
          && !(unsigned __int8)sub_B49560(v227, 31) )
        {
          v414 = 0x400000000LL;
          v409 = 0;
          v410 = 0;
          v411[0] = 0;
          v411[1] = 0;
          v412 = 0;
          v413 = &v415;
          v419 = (void **)&v421;
          v420 = 0x800000000LL;
          v428 = v430;
          v429 = 0x800000000LL;
          v430[64] = 1;
          sub_29F2700((unsigned __int8 *)v227, (__int64)&v409, 0, 0, 1, 0);
          if ( v428 != v430 )
            _libc_free((unsigned __int64)v428);
          v316 = v419;
          v317 = &v419[3 * (unsigned int)v420];
          if ( v419 != v317 )
          {
            do
            {
              v318 = (__int64)*(v317 - 1);
              v317 -= 3;
              if ( v318 != 0 && v318 != -4096 && v318 != -8192 )
                sub_BD60C0(v317);
            }
            while ( v316 != v317 );
            v316 = v419;
          }
          if ( v316 != (void **)&v421 )
            _libc_free((unsigned __int64)v316);
          if ( v413 != &v415 )
            _libc_free((unsigned __int64)v413);
        }
      }
    }
  }
  nullsub_61();
  v389 = &unk_49DA100;
  nullsub_63();
  if ( v374 != (unsigned int *)v376 )
    _libc_free((unsigned __int64)v374);
  v228 = 1;
LABEL_200:
  if ( v368 != v370 )
    _libc_free((unsigned __int64)v368);
  if ( v365 != (__int64 *)v367 )
    _libc_free((unsigned __int64)v365);
  if ( v362 != (__int64 *)v364 )
    _libc_free((unsigned __int64)v362);
  if ( v359 != v361 )
    _libc_free((unsigned __int64)v359);
  if ( v371 != v373 )
    _libc_free((unsigned __int64)v371);
  return v228;
}

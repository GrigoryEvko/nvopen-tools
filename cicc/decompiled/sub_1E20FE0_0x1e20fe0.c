// Function: sub_1E20FE0
// Address: 0x1e20fe0
//
void __fastcall sub_1E20FE0(__int64 *a1, char *a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx
  __int64 v5; // r14
  __int64 v6; // rsi
  __int64 *v7; // rbx
  __int64 v8; // rax
  __int64 v9; // rbx
  __int64 v10; // r12
  __int64 v11; // r15
  int v12; // ecx
  __int64 *v13; // r11
  unsigned int v14; // edi
  __int64 *v15; // rax
  __int64 v16; // rsi
  unsigned int v17; // r8d
  unsigned int v18; // edi
  __int64 *v19; // rax
  __int64 v20; // rsi
  int v21; // esi
  int v22; // esi
  __int64 v23; // r8
  unsigned int v24; // ecx
  int v25; // eax
  __int64 *v26; // rdx
  __int64 v27; // rdi
  int v28; // esi
  int v29; // esi
  __int64 v30; // r8
  unsigned int v31; // ecx
  int v32; // eax
  __int64 *v33; // rdx
  __int64 v34; // rdi
  char *v35; // rbx
  unsigned __int64 v36; // rdx
  unsigned int v37; // edi
  __int64 *v38; // rax
  __int64 v39; // rsi
  unsigned int v40; // esi
  unsigned int v41; // r12d
  unsigned int v42; // r8d
  __int64 *v43; // rax
  __int64 v44; // rdi
  __int64 v45; // r14
  __int64 v46; // r12
  unsigned __int64 v47; // rdx
  unsigned __int64 v48; // rax
  _QWORD *v49; // rax
  __int64 *v50; // r11
  __int64 v51; // rdx
  __int64 *v52; // r15
  _QWORD *j; // rdx
  __int64 *k; // rax
  __int64 v55; // r10
  int v56; // esi
  int v57; // esi
  __int64 v58; // r8
  unsigned int v59; // ecx
  __int64 *v60; // rdx
  __int64 v61; // rdi
  _QWORD *v62; // rdx
  int v63; // ecx
  int v64; // esi
  int v65; // eax
  unsigned int v66; // edi
  __int64 *v67; // rcx
  __int64 v68; // r8
  __int64 v69; // r9
  unsigned __int64 v70; // rax
  __int64 v71; // rax
  _QWORD *v72; // rax
  __int64 v73; // rdx
  __int64 *v74; // rsi
  _QWORD *m; // rdx
  __int64 *n; // rax
  __int64 v77; // rdx
  int v78; // ecx
  int v79; // r10d
  __int64 v80; // r8
  int v81; // r14d
  __int64 *v82; // r12
  unsigned int v83; // edi
  __int64 *v84; // rcx
  __int64 v85; // rbx
  _QWORD *v86; // rsi
  int v87; // edx
  int v88; // eax
  int v89; // edx
  unsigned int v90; // edi
  _QWORD *v91; // rcx
  __int64 v92; // r8
  __int64 v93; // rax
  int v94; // r9d
  int v95; // eax
  unsigned int v96; // eax
  __int64 v97; // rax
  _QWORD *v98; // rcx
  __int64 v99; // rdx
  __int64 *v100; // rax
  _QWORD *ii; // rdx
  __int64 *v102; // rcx
  __int64 v103; // rdx
  int v104; // r8d
  int v105; // r8d
  __int64 v106; // rbx
  int v107; // r15d
  __int64 *v108; // r14
  unsigned int v109; // edi
  __int64 *v110; // rsi
  __int64 v111; // r10
  _QWORD *v112; // rsi
  int v113; // edx
  int v114; // edx
  int v115; // r11d
  _QWORD *v116; // r8
  unsigned int v117; // r12d
  __int64 v118; // rdi
  int v119; // r8d
  int v120; // eax
  __int64 v121; // rax
  _QWORD *v122; // rax
  __int64 *v123; // r11
  unsigned int v124; // r10d
  __int64 v125; // rdx
  __int64 *v126; // r15
  _QWORD *i; // rdx
  __int64 *v128; // rax
  __int64 v129; // rdx
  int v130; // edi
  int v131; // edi
  __int64 v132; // r9
  unsigned int v133; // esi
  __int64 *v134; // rcx
  __int64 v135; // r8
  _QWORD *v136; // rdi
  int v137; // edx
  unsigned int v138; // eax
  int v139; // edx
  int v140; // r10d
  __int64 *v141; // r9
  unsigned int v142; // eax
  __int64 v143; // r8
  int v144; // r10d
  int v145; // eax
  int v146; // ecx
  int v147; // ecx
  __int64 v148; // rdi
  __int64 *v149; // r8
  unsigned int v150; // r12d
  int v151; // r10d
  __int64 v152; // rsi
  int v153; // r9d
  int v154; // eax
  int v155; // ecx
  int v156; // ecx
  __int64 v157; // rdi
  __int64 *v158; // r9
  unsigned int v159; // r14d
  int v160; // r10d
  __int64 v161; // rsi
  __int64 v162; // rsi
  __int64 v163; // rdx
  __int64 *v164; // r9
  __int64 v165; // rdi
  __int64 v166; // rsi
  __int64 v167; // rbx
  __int64 jj; // r12
  __int64 *v169; // rbx
  __int64 v170; // rcx
  __int64 v171; // r13
  int v172; // ebx
  _QWORD *v173; // r11
  int v174; // r11d
  char *v175; // r14
  __int64 *v176; // rbx
  __int64 v177; // rax
  __int64 *v178; // rax
  __int64 v179; // rax
  int v180; // r11d
  __int64 *v181; // r9
  int v182; // r11d
  __int64 *v183; // r10
  char *v184; // [rsp+8h] [rbp-98h]
  __int64 v185; // [rsp+18h] [rbp-88h]
  char *v187; // [rsp+28h] [rbp-78h]
  __int64 *v188; // [rsp+30h] [rbp-70h]
  __int64 *v189; // [rsp+30h] [rbp-70h]
  __int64 *v190; // [rsp+30h] [rbp-70h]
  int v191; // [rsp+30h] [rbp-70h]
  __int64 *v192; // [rsp+38h] [rbp-68h]
  __int64 v193; // [rsp+38h] [rbp-68h]
  __int64 v194; // [rsp+38h] [rbp-68h]
  int v195; // [rsp+38h] [rbp-68h]
  __int64 *v196; // [rsp+38h] [rbp-68h]
  char *v197; // [rsp+40h] [rbp-60h]
  char *v198; // [rsp+48h] [rbp-58h]
  char *v200; // [rsp+58h] [rbp-48h]
  __int64 v201[7]; // [rsp+68h] [rbp-38h] BYREF

  v4 = a2 - (char *)a1;
  v185 = a3;
  v187 = a2;
  if ( a2 - (char *)a1 <= 128 )
    return;
  v5 = a4;
  if ( !a3 )
  {
    v197 = a2;
    goto LABEL_221;
  }
  v184 = (char *)(a1 + 1);
  while ( 2 )
  {
    --v185;
    v6 = a1[1];
    v7 = &a1[(__int64)(((v187 - (char *)a1) >> 3) + ((unsigned __int64)(v187 - (char *)a1) >> 63)) >> 1];
    v201[0] = a4;
    if ( !sub_1E20950(v201, v6, *v7) )
    {
      if ( sub_1E20950(v201, a1[1], *((_QWORD *)v187 - 1)) )
      {
        v10 = *a1;
        v9 = a1[1];
        a1[1] = *a1;
        *a1 = v9;
        goto LABEL_7;
      }
      v175 = v187;
      if ( !sub_1E20950(v201, *v7, *((_QWORD *)v187 - 1)) )
      {
        v179 = *a1;
        *a1 = *v7;
        *v7 = v179;
        v9 = *a1;
        v10 = a1[1];
        goto LABEL_7;
      }
      v176 = a1;
LABEL_239:
      v177 = *v176;
      *v176 = *((_QWORD *)v175 - 1);
      *((_QWORD *)v175 - 1) = v177;
      v178 = v176;
      v9 = *v176;
      v10 = v178[1];
      goto LABEL_7;
    }
    if ( !sub_1E20950(v201, *v7, *((_QWORD *)v187 - 1)) )
    {
      v175 = v187;
      v176 = a1;
      if ( !sub_1E20950(v201, a1[1], *((_QWORD *)v187 - 1)) )
      {
        v10 = *a1;
        v9 = a1[1];
        a1[1] = *a1;
        *a1 = v9;
        goto LABEL_7;
      }
      goto LABEL_239;
    }
    v8 = *a1;
    *a1 = *v7;
    *v7 = v8;
    v9 = *a1;
    v10 = a1[1];
LABEL_7:
    v198 = v184;
    v200 = v187;
    v11 = *(unsigned int *)(a4 + 24);
    while ( 2 )
    {
      v197 = v198;
      if ( (_DWORD)v11 )
      {
        v12 = v11 - 1;
        v13 = *(__int64 **)(a4 + 8);
        v14 = (v11 - 1) & (((unsigned int)v10 >> 9) ^ ((unsigned int)v10 >> 4));
        v15 = &v13[2 * v14];
        v16 = *v15;
        if ( *v15 == v10 )
        {
LABEL_9:
          v17 = *((_DWORD *)v15 + 2);
          goto LABEL_10;
        }
        v153 = 1;
        v26 = 0;
        while ( v16 != -8 )
        {
          if ( !v26 && v16 == -16 )
            v26 = v15;
          v14 = v12 & (v153 + v14);
          v15 = &v13[2 * v14];
          v16 = *v15;
          if ( *v15 == v10 )
            goto LABEL_9;
          ++v153;
        }
        if ( !v26 )
          v26 = v15;
        v154 = *(_DWORD *)(a4 + 16);
        ++*(_QWORD *)a4;
        v25 = v154 + 1;
        if ( 4 * v25 < (unsigned int)(3 * v11) )
        {
          if ( (int)v11 - *(_DWORD *)(a4 + 20) - v25 <= (unsigned int)v11 >> 3 )
          {
            sub_1E20790(a4, v11);
            v155 = *(_DWORD *)(a4 + 24);
            if ( !v155 )
            {
LABEL_322:
              ++*(_DWORD *)(a4 + 16);
              BUG();
            }
            v156 = v155 - 1;
            v157 = *(_QWORD *)(a4 + 8);
            v158 = 0;
            v159 = v156 & (((unsigned int)v10 >> 9) ^ ((unsigned int)v10 >> 4));
            v160 = 1;
            v25 = *(_DWORD *)(a4 + 16) + 1;
            v26 = (__int64 *)(v157 + 16LL * v159);
            v161 = *v26;
            if ( v10 != *v26 )
            {
              while ( v161 != -8 )
              {
                if ( !v158 && v161 == -16 )
                  v158 = v26;
                v159 = v156 & (v160 + v159);
                v26 = (__int64 *)(v157 + 16LL * v159);
                v161 = *v26;
                if ( *v26 == v10 )
                  goto LABEL_17;
                ++v160;
              }
              if ( v158 )
                v26 = v158;
            }
          }
          goto LABEL_17;
        }
      }
      else
      {
        ++*(_QWORD *)a4;
      }
      sub_1E20790(a4, 2 * v11);
      v21 = *(_DWORD *)(a4 + 24);
      if ( !v21 )
        goto LABEL_322;
      v22 = v21 - 1;
      v23 = *(_QWORD *)(a4 + 8);
      v24 = v22 & (((unsigned int)v10 >> 9) ^ ((unsigned int)v10 >> 4));
      v25 = *(_DWORD *)(a4 + 16) + 1;
      v26 = (__int64 *)(v23 + 16LL * v24);
      v27 = *v26;
      if ( *v26 != v10 )
      {
        v182 = 1;
        v183 = 0;
        while ( v27 != -8 )
        {
          if ( !v183 && v27 == -16 )
            v183 = v26;
          v24 = v22 & (v182 + v24);
          v26 = (__int64 *)(v23 + 16LL * v24);
          v27 = *v26;
          if ( *v26 == v10 )
            goto LABEL_17;
          ++v182;
        }
        if ( v183 )
          v26 = v183;
      }
LABEL_17:
      *(_DWORD *)(a4 + 16) = v25;
      if ( *v26 != -8 )
        --*(_DWORD *)(a4 + 20);
      *v26 = v10;
      *((_DWORD *)v26 + 2) = 0;
      v11 = *(unsigned int *)(a4 + 24);
      if ( !(_DWORD)v11 )
      {
        ++*(_QWORD *)a4;
        goto LABEL_21;
      }
      v13 = *(__int64 **)(a4 + 8);
      v12 = v11 - 1;
      v17 = 0;
LABEL_10:
      v18 = v12 & (((unsigned int)v9 >> 9) ^ ((unsigned int)v9 >> 4));
      v19 = &v13[2 * v18];
      v20 = *v19;
      if ( v9 == *v19 )
      {
LABEL_11:
        if ( *((_DWORD *)v19 + 2) > v17 )
          goto LABEL_12;
        goto LABEL_26;
      }
      v144 = 1;
      v33 = 0;
      while ( v20 != -8 )
      {
        if ( v20 == -16 && !v33 )
          v33 = v19;
        v18 = v12 & (v144 + v18);
        v19 = &v13[2 * v18];
        v20 = *v19;
        if ( *v19 == v9 )
          goto LABEL_11;
        ++v144;
      }
      if ( !v33 )
        v33 = v19;
      v145 = *(_DWORD *)(a4 + 16);
      ++*(_QWORD *)a4;
      v32 = v145 + 1;
      if ( 4 * v32 < (unsigned int)(3 * v11) )
      {
        if ( (int)v11 - (v32 + *(_DWORD *)(a4 + 20)) <= (unsigned int)v11 >> 3 )
        {
          sub_1E20790(a4, v11);
          v146 = *(_DWORD *)(a4 + 24);
          if ( !v146 )
          {
LABEL_320:
            ++*(_DWORD *)(a4 + 16);
            BUG();
          }
          v147 = v146 - 1;
          v148 = *(_QWORD *)(a4 + 8);
          v149 = 0;
          v150 = v147 & (((unsigned int)v9 >> 9) ^ ((unsigned int)v9 >> 4));
          v151 = 1;
          v32 = *(_DWORD *)(a4 + 16) + 1;
          v33 = (__int64 *)(v148 + 16LL * v150);
          v152 = *v33;
          if ( v9 != *v33 )
          {
            while ( v152 != -8 )
            {
              if ( v152 == -16 && !v149 )
                v149 = v33;
              v150 = v147 & (v151 + v150);
              v33 = (__int64 *)(v148 + 16LL * v150);
              v152 = *v33;
              if ( *v33 == v9 )
                goto LABEL_23;
              ++v151;
            }
            if ( v149 )
              v33 = v149;
          }
        }
        goto LABEL_23;
      }
LABEL_21:
      sub_1E20790(a4, 2 * v11);
      v28 = *(_DWORD *)(a4 + 24);
      if ( !v28 )
        goto LABEL_320;
      v29 = v28 - 1;
      v30 = *(_QWORD *)(a4 + 8);
      v31 = v29 & (((unsigned int)v9 >> 9) ^ ((unsigned int)v9 >> 4));
      v32 = *(_DWORD *)(a4 + 16) + 1;
      v33 = (__int64 *)(v30 + 16LL * v31);
      v34 = *v33;
      if ( *v33 != v9 )
      {
        v180 = 1;
        v181 = 0;
        while ( v34 != -8 )
        {
          if ( !v181 && v34 == -16 )
            v181 = v33;
          v31 = v29 & (v180 + v31);
          v33 = (__int64 *)(v30 + 16LL * v31);
          v34 = *v33;
          if ( *v33 == v9 )
            goto LABEL_23;
          ++v180;
        }
        if ( v181 )
          v33 = v181;
      }
LABEL_23:
      *(_DWORD *)(a4 + 16) = v32;
      if ( *v33 != -8 )
        --*(_DWORD *)(a4 + 20);
      *v33 = v9;
      *((_DWORD *)v33 + 2) = 0;
      v11 = *(unsigned int *)(a4 + 24);
      v13 = *(__int64 **)(a4 + 8);
LABEL_26:
      v35 = v200 - 8;
      while ( 1 )
      {
        v45 = *(_QWORD *)v35;
        v200 = v35;
        v46 = *a1;
        if ( (_DWORD)v11 )
        {
          v36 = (unsigned int)(v11 - 1);
          v37 = v36 & (((unsigned int)v46 >> 9) ^ ((unsigned int)v46 >> 4));
          v38 = &v13[2 * v37];
          v39 = *v38;
          if ( v46 == *v38 )
          {
LABEL_28:
            v40 = *((_DWORD *)v38 + 2);
            goto LABEL_29;
          }
          v119 = 1;
          v67 = 0;
          while ( v39 != -8 )
          {
            if ( !v67 && v39 == -16 )
              v67 = v38;
            v37 = v36 & (v119 + v37);
            v38 = &v13[2 * v37];
            v39 = *v38;
            if ( v46 == *v38 )
              goto LABEL_28;
            ++v119;
          }
          if ( !v67 )
            v67 = v38;
          v120 = *(_DWORD *)(a4 + 16);
          ++*(_QWORD *)a4;
          v64 = v120 + 1;
          if ( 4 * (v120 + 1) < (unsigned int)(3 * v11) )
          {
            if ( (int)v11 - *(_DWORD *)(a4 + 20) - v64 > (unsigned int)v11 >> 3 )
              goto LABEL_51;
            v190 = v13;
            v121 = (((((((((v36 | (v36 >> 1)) >> 2) | v36 | (v36 >> 1)) >> 4)
                      | ((v36 | (v36 >> 1)) >> 2)
                      | v36
                      | (v36 >> 1)) >> 8)
                    | ((((v36 | (v36 >> 1)) >> 2) | v36 | (v36 >> 1)) >> 4)
                    | ((v36 | (v36 >> 1)) >> 2)
                    | v36
                    | (v36 >> 1)) >> 16)
                  | ((((((v36 | (v36 >> 1)) >> 2) | v36 | (v36 >> 1)) >> 4)
                    | ((v36 | (v36 >> 1)) >> 2)
                    | v36
                    | (v36 >> 1)) >> 8)
                  | ((((v36 | (v36 >> 1)) >> 2) | v36 | (v36 >> 1)) >> 4)
                  | ((v36 | (v36 >> 1)) >> 2)
                  | v36
                  | (v36 >> 1))
                 + 1;
            if ( (unsigned int)v121 < 0x40 )
              LODWORD(v121) = 64;
            *(_DWORD *)(a4 + 24) = v121;
            v122 = (_QWORD *)sub_22077B0(16LL * (unsigned int)v121);
            v123 = v190;
            v124 = ((unsigned int)v46 >> 9) ^ ((unsigned int)v46 >> 4);
            *(_QWORD *)(a4 + 8) = v122;
            if ( v190 )
            {
              v125 = *(unsigned int *)(a4 + 24);
              *(_QWORD *)(a4 + 16) = 0;
              v126 = &v190[2 * v11];
              for ( i = &v122[2 * v125]; i != v122; v122 += 2 )
              {
                if ( v122 )
                  *v122 = -8;
              }
              v128 = v190;
              do
              {
                v129 = *v128;
                if ( *v128 != -8 && v129 != -16 )
                {
                  v130 = *(_DWORD *)(a4 + 24);
                  if ( !v130 )
                  {
                    MEMORY[0] = *v128;
                    BUG();
                  }
                  v131 = v130 - 1;
                  v132 = *(_QWORD *)(a4 + 8);
                  v133 = v131 & (((unsigned int)v129 >> 9) ^ ((unsigned int)v129 >> 4));
                  v134 = (__int64 *)(v132 + 16LL * v133);
                  v135 = *v134;
                  if ( *v134 != v129 )
                  {
                    v191 = 1;
                    v196 = 0;
                    while ( v135 != -8 )
                    {
                      if ( v135 == -16 )
                      {
                        if ( v196 )
                          v134 = v196;
                        v196 = v134;
                      }
                      v133 = v131 & (v191 + v133);
                      v134 = (__int64 *)(v132 + 16LL * v133);
                      v135 = *v134;
                      if ( v129 == *v134 )
                        goto LABEL_141;
                      ++v191;
                    }
                    if ( v196 )
                      v134 = v196;
                  }
LABEL_141:
                  *v134 = v129;
                  *((_DWORD *)v134 + 2) = *((_DWORD *)v128 + 2);
                  ++*(_DWORD *)(a4 + 16);
                }
                v128 += 2;
              }
              while ( v126 != v128 );
              j___libc_free_0(v123);
              v136 = *(_QWORD **)(a4 + 8);
              v137 = *(_DWORD *)(a4 + 24);
              v124 = ((unsigned int)v46 >> 9) ^ ((unsigned int)v46 >> 4);
              v64 = *(_DWORD *)(a4 + 16) + 1;
            }
            else
            {
              v165 = *(unsigned int *)(a4 + 24);
              *(_QWORD *)(a4 + 16) = 0;
              v137 = v165;
              v136 = &v122[2 * v165];
              if ( v122 == v136 )
              {
                v64 = 1;
              }
              else
              {
                do
                {
                  if ( v122 )
                    *v122 = -8;
                  v122 += 2;
                }
                while ( v136 != v122 );
                v136 = *(_QWORD **)(a4 + 8);
                v137 = *(_DWORD *)(a4 + 24);
                v64 = *(_DWORD *)(a4 + 16) + 1;
              }
            }
            if ( !v137 )
            {
LABEL_324:
              ++*(_DWORD *)(a4 + 16);
              BUG();
            }
            v138 = v124;
            v139 = v137 - 1;
            v140 = 1;
            v141 = 0;
            v142 = v139 & v138;
            v67 = &v136[2 * v142];
            v143 = *v67;
            if ( v46 == *v67 )
              goto LABEL_51;
            while ( v143 != -8 )
            {
              if ( !v141 && v143 == -16 )
                v141 = v67;
              v142 = v139 & (v140 + v142);
              v67 = &v136[2 * v142];
              v143 = *v67;
              if ( v46 == *v67 )
                goto LABEL_51;
              ++v140;
            }
            goto LABEL_147;
          }
        }
        else
        {
          ++*(_QWORD *)a4;
        }
        v192 = v13;
        v47 = ((((((((unsigned int)(2 * v11 - 1) | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 2)
                 | (unsigned int)(2 * v11 - 1)
                 | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 4)
               | (((unsigned int)(2 * v11 - 1) | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 2)
               | (unsigned int)(2 * v11 - 1)
               | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 8)
             | (((((unsigned int)(2 * v11 - 1) | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 2)
               | (unsigned int)(2 * v11 - 1)
               | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 4)
             | (((unsigned int)(2 * v11 - 1) | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 2)
             | (unsigned int)(2 * v11 - 1)
             | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 16;
        v48 = (v47
             | (((((((unsigned int)(2 * v11 - 1) | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 2)
                 | (unsigned int)(2 * v11 - 1)
                 | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 4)
               | (((unsigned int)(2 * v11 - 1) | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 2)
               | (unsigned int)(2 * v11 - 1)
               | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 8)
             | (((((unsigned int)(2 * v11 - 1) | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 2)
               | (unsigned int)(2 * v11 - 1)
               | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 4)
             | (((unsigned int)(2 * v11 - 1) | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 2)
             | (unsigned int)(2 * v11 - 1)
             | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1))
            + 1;
        if ( (unsigned int)v48 < 0x40 )
          LODWORD(v48) = 64;
        *(_DWORD *)(a4 + 24) = v48;
        v49 = (_QWORD *)sub_22077B0(16LL * (unsigned int)v48);
        v50 = v192;
        *(_QWORD *)(a4 + 8) = v49;
        if ( v192 )
        {
          v51 = *(unsigned int *)(a4 + 24);
          *(_QWORD *)(a4 + 16) = 0;
          v52 = &v192[2 * v11];
          for ( j = &v49[2 * v51]; j != v49; v49 += 2 )
          {
            if ( v49 )
              *v49 = -8;
          }
          for ( k = v192; v52 != k; k += 2 )
          {
            v55 = *k;
            if ( *k != -8 && v55 != -16 )
            {
              v56 = *(_DWORD *)(a4 + 24);
              if ( !v56 )
              {
                MEMORY[0] = *k;
                BUG();
              }
              v57 = v56 - 1;
              v58 = *(_QWORD *)(a4 + 8);
              v59 = v57 & (((unsigned int)v55 >> 9) ^ ((unsigned int)v55 >> 4));
              v60 = (__int64 *)(v58 + 16LL * v59);
              v61 = *v60;
              if ( v55 != *v60 )
              {
                v195 = 1;
                v164 = 0;
                while ( v61 != -8 )
                {
                  if ( !v164 && v61 == -16 )
                    v164 = v60;
                  v59 = v57 & (v195 + v59);
                  v60 = (__int64 *)(v58 + 16LL * v59);
                  v61 = *v60;
                  if ( v55 == *v60 )
                    goto LABEL_45;
                  ++v195;
                }
                if ( v164 )
                  v60 = v164;
              }
LABEL_45:
              *v60 = v55;
              *((_DWORD *)v60 + 2) = *((_DWORD *)k + 2);
              ++*(_DWORD *)(a4 + 16);
            }
          }
          j___libc_free_0(v50);
        }
        else
        {
          v163 = *(unsigned int *)(a4 + 24);
          *(_QWORD *)(a4 + 16) = 0;
          v63 = v163;
          v62 = &v49[2 * v163];
          if ( v49 == v62 )
          {
            v64 = 1;
            goto LABEL_49;
          }
          do
          {
            if ( v49 )
              *v49 = -8;
            v49 += 2;
          }
          while ( v62 != v49 );
        }
        v62 = *(_QWORD **)(a4 + 8);
        v63 = *(_DWORD *)(a4 + 24);
        v64 = *(_DWORD *)(a4 + 16) + 1;
LABEL_49:
        if ( !v63 )
          goto LABEL_324;
        v65 = v63 - 1;
        v66 = (v63 - 1) & (((unsigned int)v46 >> 9) ^ ((unsigned int)v46 >> 4));
        v67 = &v62[2 * v66];
        v68 = *v67;
        if ( v46 == *v67 )
          goto LABEL_51;
        v174 = 1;
        v141 = 0;
        while ( v68 != -8 )
        {
          if ( v141 || v68 != -16 )
            v67 = v141;
          v66 = v65 & (v174 + v66);
          v68 = v62[2 * v66];
          if ( v46 == v68 )
          {
            v67 = &v62[2 * v66];
            goto LABEL_51;
          }
          ++v174;
          v141 = v67;
          v67 = &v62[2 * v66];
        }
LABEL_147:
        if ( v141 )
          v67 = v141;
LABEL_51:
        *(_DWORD *)(a4 + 16) = v64;
        if ( *v67 != -8 )
          --*(_DWORD *)(a4 + 20);
        *v67 = v46;
        *((_DWORD *)v67 + 2) = 0;
        v11 = *(unsigned int *)(a4 + 24);
        v13 = *(__int64 **)(a4 + 8);
        if ( !(_DWORD)v11 )
        {
          ++*(_QWORD *)a4;
          v69 = v45;
          goto LABEL_55;
        }
        v36 = (unsigned int)(v11 - 1);
        v40 = 0;
LABEL_29:
        v41 = ((unsigned int)v45 >> 9) ^ ((unsigned int)v45 >> 4);
        v42 = v36 & v41;
        v43 = &v13[2 * ((unsigned int)v36 & v41)];
        v44 = *v43;
        if ( v45 != *v43 )
          break;
LABEL_30:
        v35 -= 8;
        if ( v40 >= *((_DWORD *)v43 + 2) )
          goto LABEL_75;
      }
      v94 = 1;
      v91 = 0;
      while ( v44 != -8 )
      {
        if ( v44 == -16 && !v91 )
          v91 = v43;
        v42 = v36 & (v94 + v42);
        v43 = &v13[2 * v42];
        v44 = *v43;
        if ( v45 == *v43 )
          goto LABEL_30;
        ++v94;
      }
      v69 = v45;
      if ( !v91 )
        v91 = v43;
      v95 = *(_DWORD *)(a4 + 16);
      ++*(_QWORD *)a4;
      v88 = v95 + 1;
      if ( 4 * v88 >= (unsigned int)(3 * v11) )
      {
LABEL_55:
        v188 = v13;
        v193 = v69;
        v70 = (((((((unsigned int)(2 * v11 - 1) | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 2)
                | (unsigned int)(2 * v11 - 1)
                | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 4)
              | (((unsigned int)(2 * v11 - 1) | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 2)
              | (unsigned int)(2 * v11 - 1)
              | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 8)
            | (((((unsigned int)(2 * v11 - 1) | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 2)
              | (unsigned int)(2 * v11 - 1)
              | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 4)
            | (((unsigned int)(2 * v11 - 1) | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1)) >> 2)
            | (unsigned int)(2 * v11 - 1)
            | ((unsigned __int64)(unsigned int)(2 * v11 - 1) >> 1);
        v71 = ((v70 >> 16) | v70) + 1;
        if ( (unsigned int)v71 < 0x40 )
          LODWORD(v71) = 64;
        *(_DWORD *)(a4 + 24) = v71;
        v72 = (_QWORD *)sub_22077B0(16LL * (unsigned int)v71);
        v69 = v193;
        *(_QWORD *)(a4 + 8) = v72;
        if ( v188 )
        {
          v73 = *(unsigned int *)(a4 + 24);
          *(_QWORD *)(a4 + 16) = 0;
          v74 = &v188[2 * v11];
          for ( m = &v72[2 * v73]; m != v72; v72 += 2 )
          {
            if ( v72 )
              *v72 = -8;
          }
          for ( n = v188; v74 != n; n += 2 )
          {
            v77 = *n;
            if ( *n != -16 && v77 != -8 )
            {
              v78 = *(_DWORD *)(a4 + 24);
              if ( !v78 )
              {
                MEMORY[0] = *n;
                BUG();
              }
              v79 = v78 - 1;
              v80 = *(_QWORD *)(a4 + 8);
              v81 = 1;
              v82 = 0;
              v83 = (v78 - 1) & (((unsigned int)v77 >> 9) ^ ((unsigned int)v77 >> 4));
              v84 = (__int64 *)(v80 + 16LL * v83);
              v85 = *v84;
              if ( *v84 != v77 )
              {
                while ( v85 != -8 )
                {
                  if ( v85 == -16 && !v82 )
                    v82 = v84;
                  v83 = v79 & (v81 + v83);
                  v84 = (__int64 *)(v80 + 16LL * v83);
                  v85 = *v84;
                  if ( v77 == *v84 )
                    goto LABEL_67;
                  ++v81;
                }
                if ( v82 )
                  v84 = v82;
              }
LABEL_67:
              *v84 = v77;
              *((_DWORD *)v84 + 2) = *((_DWORD *)n + 2);
              ++*(_DWORD *)(a4 + 16);
            }
          }
          j___libc_free_0(v188);
          v86 = *(_QWORD **)(a4 + 8);
          v87 = *(_DWORD *)(a4 + 24);
          v69 = v193;
          v88 = *(_DWORD *)(a4 + 16) + 1;
        }
        else
        {
          v162 = *(unsigned int *)(a4 + 24);
          *(_QWORD *)(a4 + 16) = 0;
          v87 = v162;
          v86 = &v72[2 * v162];
          if ( v72 == v86 )
          {
            v88 = 1;
          }
          else
          {
            do
            {
              if ( v72 )
                *v72 = -8;
              v72 += 2;
            }
            while ( v86 != v72 );
            v86 = *(_QWORD **)(a4 + 8);
            v87 = *(_DWORD *)(a4 + 24);
            v88 = *(_DWORD *)(a4 + 16) + 1;
          }
        }
        if ( !v87 )
          goto LABEL_325;
        v89 = v87 - 1;
        v90 = v89 & (((unsigned int)v69 >> 9) ^ ((unsigned int)v69 >> 4));
        v91 = &v86[2 * v90];
        v92 = *v91;
        if ( v69 != *v91 )
        {
          v172 = 1;
          v173 = 0;
          while ( v92 != -8 )
          {
            if ( v92 != -16 || v173 )
              v91 = v173;
            v90 = v89 & (v172 + v90);
            v92 = v86[2 * v90];
            if ( v69 == v92 )
            {
              v91 = &v86[2 * v90];
              goto LABEL_72;
            }
            ++v172;
            v173 = v91;
            v91 = &v86[2 * v90];
          }
          if ( v173 )
            v91 = v173;
        }
      }
      else if ( (int)v11 - (v88 + *(_DWORD *)(a4 + 20)) <= (unsigned int)v11 >> 3 )
      {
        v189 = v13;
        v96 = ((((((((v36 >> 1) | v36 | (((v36 >> 1) | v36) >> 2)) >> 4) | (v36 >> 1) | v36 | (((v36 >> 1) | v36) >> 2)) >> 8)
               | (((v36 >> 1) | v36 | (((v36 >> 1) | v36) >> 2)) >> 4)
               | (v36 >> 1)
               | v36
               | (((v36 >> 1) | v36) >> 2)) >> 16)
             | (((((v36 >> 1) | v36 | (((v36 >> 1) | v36) >> 2)) >> 4) | (v36 >> 1) | v36 | (((v36 >> 1) | v36) >> 2)) >> 8)
             | (((v36 >> 1) | v36 | (((v36 >> 1) | v36) >> 2)) >> 4)
             | (v36 >> 1)
             | v36
             | (((v36 >> 1) | v36) >> 2))
            + 1;
        if ( v96 < 0x40 )
          v96 = 64;
        *(_DWORD *)(a4 + 24) = v96;
        v97 = sub_22077B0(16LL * v96);
        v69 = v45;
        *(_QWORD *)(a4 + 8) = v97;
        v98 = (_QWORD *)v97;
        if ( v189 )
        {
          v99 = *(unsigned int *)(a4 + 24);
          *(_QWORD *)(a4 + 16) = 0;
          v100 = &v189[2 * v11];
          for ( ii = &v98[2 * v99]; ii != v98; v98 += 2 )
          {
            if ( v98 )
              *v98 = -8;
          }
          v102 = v189;
          do
          {
            v103 = *v102;
            if ( *v102 != -16 && v103 != -8 )
            {
              v104 = *(_DWORD *)(a4 + 24);
              if ( !v104 )
              {
                MEMORY[0] = *v102;
                BUG();
              }
              v105 = v104 - 1;
              v106 = *(_QWORD *)(a4 + 8);
              v107 = 1;
              v108 = 0;
              v109 = v105 & (((unsigned int)v103 >> 9) ^ ((unsigned int)v103 >> 4));
              v110 = (__int64 *)(v106 + 16LL * v109);
              v111 = *v110;
              if ( *v110 != v103 )
              {
                while ( v111 != -8 )
                {
                  if ( v111 == -16 && !v108 )
                    v108 = v110;
                  v109 = v105 & (v107 + v109);
                  v110 = (__int64 *)(v106 + 16LL * v109);
                  v111 = *v110;
                  if ( v103 == *v110 )
                    goto LABEL_105;
                  ++v107;
                }
                if ( v108 )
                  v110 = v108;
              }
LABEL_105:
              *v110 = v103;
              *((_DWORD *)v110 + 2) = *((_DWORD *)v102 + 2);
              ++*(_DWORD *)(a4 + 16);
            }
            v102 += 2;
          }
          while ( v100 != v102 );
          v194 = v69;
          j___libc_free_0(v189);
          v112 = *(_QWORD **)(a4 + 8);
          v113 = *(_DWORD *)(a4 + 24);
          v69 = v194;
          v88 = *(_DWORD *)(a4 + 16) + 1;
        }
        else
        {
          v166 = *(unsigned int *)(a4 + 24);
          *(_QWORD *)(a4 + 16) = 0;
          v113 = v166;
          v112 = (_QWORD *)(v97 + 16 * v166);
          if ( (_QWORD *)v97 == v112 )
          {
            v88 = 1;
          }
          else
          {
            do
            {
              if ( v98 )
                *v98 = -8;
              v98 += 2;
            }
            while ( v112 != v98 );
            v112 = *(_QWORD **)(a4 + 8);
            v113 = *(_DWORD *)(a4 + 24);
            v88 = *(_DWORD *)(a4 + 16) + 1;
          }
        }
        if ( v113 )
        {
          v114 = v113 - 1;
          v115 = 1;
          v116 = 0;
          v117 = v114 & v41;
          v91 = &v112[2 * v117];
          v118 = *v91;
          if ( v69 != *v91 )
          {
            while ( v118 != -8 )
            {
              if ( !v116 && v118 == -16 )
                v116 = v91;
              v117 = v114 & (v115 + v117);
              v91 = &v112[2 * v117];
              v118 = *v91;
              if ( v69 == *v91 )
                goto LABEL_72;
              ++v115;
            }
            if ( v116 )
              v91 = v116;
          }
          goto LABEL_72;
        }
LABEL_325:
        ++*(_DWORD *)(a4 + 16);
        BUG();
      }
LABEL_72:
      *(_DWORD *)(a4 + 16) = v88;
      if ( *v91 != -8 )
        --*(_DWORD *)(a4 + 20);
      *v91 = v69;
      *((_DWORD *)v91 + 2) = 0;
LABEL_75:
      if ( v198 < v200 )
      {
        v93 = *(_QWORD *)v198;
        *(_QWORD *)v198 = *(_QWORD *)v200;
        *(_QWORD *)v200 = v93;
        v11 = *(unsigned int *)(a4 + 24);
LABEL_12:
        v9 = *a1;
        v10 = *((_QWORD *)v198 + 1);
        v198 += 8;
        continue;
      }
      break;
    }
    sub_1E20FE0(v198, v187, v185, a4);
    v4 = v198 - (char *)a1;
    if ( v198 - (char *)a1 > 128 )
    {
      if ( v185 )
      {
        v187 = v198;
        continue;
      }
      v5 = a4;
LABEL_221:
      v167 = v4 >> 3;
      for ( jj = (v167 - 2) >> 1; ; --jj )
      {
        sub_1E20BB0((__int64)a1, jj, v167, a1[jj], v5);
        if ( !jj )
          break;
      }
      v169 = (__int64 *)(v197 - 8);
      do
      {
        v170 = *v169;
        v171 = (char *)v169-- - (char *)a1;
        v169[1] = *a1;
        sub_1E20BB0((__int64)a1, 0, v171 >> 3, v170, v5);
      }
      while ( v171 > 8 );
    }
    break;
  }
}

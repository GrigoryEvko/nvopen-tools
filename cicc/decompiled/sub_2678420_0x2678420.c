// Function: sub_2678420
// Address: 0x2678420
//
__int64 __fastcall sub_2678420(__int64 a1, __int64 a2, _DWORD *a3)
{
  unsigned int v3; // r13d
  __int64 v5; // r12
  const char **v7; // r15
  __int64 i; // rax
  __int64 v9; // rdi
  unsigned __int8 *v10; // r15
  _BYTE *v11; // r14
  _BYTE *v12; // rax
  unsigned int v13; // r13d
  _BYTE *v14; // r15
  unsigned int v15; // edx
  __int64 *v16; // rax
  __int64 v17; // rax
  __int64 v18; // r13
  __int64 v19; // rax
  __int64 v20; // rax
  __int64 v21; // rdi
  __int64 v22; // rsi
  __int64 v23; // rax
  __int64 *v24; // r13
  __int64 v25; // rax
  __int64 v26; // rax
  __int64 v27; // rdx
  __int64 v28; // rdx
  __int64 v29; // rcx
  __int64 v30; // r8
  __int64 v31; // r9
  __int64 v32; // rdx
  __int64 v33; // rcx
  __int64 v34; // r9
  unsigned __int64 v35; // rdi
  __int64 v36; // rax
  __int64 *v37; // rcx
  __int64 *v38; // rax
  __int64 *v39; // rsi
  __int64 *v40; // r13
  __int64 v41; // rax
  __int64 v42; // rax
  __int64 v43; // rax
  __int64 v44; // rax
  __int64 v45; // rax
  __int64 v46; // rax
  __int64 v47; // rax
  __int64 v48; // rcx
  __int64 v49; // r8
  __int64 v50; // r9
  __int64 v51; // rcx
  __int64 v52; // r8
  __int64 v53; // r9
  __int64 v54; // rcx
  __int64 v55; // r8
  __int64 v56; // r9
  __int64 v57; // rcx
  __int64 v58; // r8
  __int64 v59; // r9
  __int64 v60; // rcx
  __int64 v61; // r8
  __int64 v62; // r9
  __int64 v63; // rcx
  __int64 v64; // r8
  __int64 v65; // r9
  __int64 v66; // rcx
  __int64 v67; // r8
  __int64 v68; // r9
  __int64 v69; // rcx
  __int64 v70; // r8
  __int64 v71; // r9
  __int64 v72; // rcx
  __int64 v73; // r8
  __int64 v74; // r9
  _QWORD *v75; // rax
  _QWORD *v76; // rbx
  _QWORD *v77; // rax
  __int64 v78; // rax
  __int64 v79; // rax
  __int64 v80; // r9
  __int64 v81; // rbx
  __int64 v82; // rsi
  __int64 v83; // r13
  __int64 v84; // rdi
  __int64 v85; // r12
  __int64 v86; // rax
  __int64 v87; // rdx
  __int64 v88; // rbx
  __int64 v89; // rax
  __int64 v90; // rdx
  __int64 v91; // r13
  _QWORD *v92; // rax
  __int64 v93; // r12
  _QWORD *v94; // rax
  __int64 v95; // rbx
  __int64 v96; // r12
  __int64 v97; // r9
  __int64 v98; // r12
  unsigned int v99; // r13d
  __int64 v100; // rax
  _QWORD *v101; // rax
  __int64 v102; // r9
  __int64 v103; // r12
  __int64 v104; // rax
  __int64 v105; // rdx
  __int64 v106; // rbx
  __int64 v107; // r13
  __int64 v108; // r9
  __int64 v109; // rbx
  __int64 v110; // rax
  __int64 v111; // r13
  __int64 v112; // rdx
  __int64 v113; // rbx
  __int64 v114; // r9
  __int64 v115; // rax
  __int64 v116; // r13
  _QWORD *v117; // rax
  __int64 *v118; // rax
  __int64 v119; // rax
  __int64 v120; // r9
  __int64 v121; // r12
  _QWORD *v122; // rbx
  __int64 v123; // rsi
  _QWORD *v124; // rbx
  __int64 v125; // rdx
  _QWORD *v126; // rax
  _QWORD *v127; // r13
  unsigned __int8 **v128; // rdx
  __int64 v129; // rax
  __int64 v130; // rcx
  __int64 v131; // r8
  __int64 v132; // r9
  __int64 *v133; // r13
  __int64 v134; // rcx
  __int64 v135; // r8
  __int64 v136; // r9
  __int64 v137; // r9
  __int64 v138; // rax
  __int64 v139; // r15
  __int64 v140; // rdx
  _QWORD *v141; // rax
  __int64 v142; // r8
  unsigned __int8 **v143; // r12
  __int64 v144; // rcx
  unsigned __int8 *v145; // r15
  __int64 v146; // rax
  __int64 *v147; // r12
  __int64 v148; // rsi
  __int64 v149; // r9
  __int64 v150; // rdi
  __int64 v151; // rax
  __int64 v152; // r13
  __int64 v153; // rsi
  unsigned __int8 *v154; // rsi
  __int64 v155; // r15
  __int64 v156; // rax
  __int64 *v157; // rax
  __int64 v158; // r13
  __int64 *v159; // r12
  __int64 v160; // rax
  __int64 v161; // rdx
  __int64 v162; // rcx
  __int64 v163; // r8
  __int64 v164; // r9
  __int64 v165; // rdx
  __int64 v166; // rcx
  __int64 v167; // r8
  __int64 v168; // r9
  __int64 v169; // rsi
  unsigned __int8 *v170; // rsi
  __int64 v171; // rsi
  unsigned __int8 *v172; // rsi
  __int64 v173; // rax
  __int64 v174; // rsi
  _QWORD *v175; // rbx
  __int64 v176; // rax
  __int64 v177; // rdx
  __int64 v178; // r12
  __int64 v179; // r13
  __int64 v180; // r9
  __int64 v181; // rax
  __int64 v182; // rbx
  _QWORD *v183; // rbx
  __int64 v184; // r9
  __int64 v185; // rbx
  _QWORD *v186; // rbx
  __int64 *v187; // r13
  __int64 v188; // rax
  __int64 v189; // rax
  __int64 v190; // rdx
  __int64 v191; // rdx
  __int64 v192; // rcx
  __int64 v193; // r8
  __int64 v194; // r9
  __int64 v195; // rdx
  __int64 v196; // rcx
  __int64 v197; // r9
  __int64 *v198; // r9
  __int64 *v199; // r13
  __int64 v200; // rax
  __int64 v201; // rax
  __int64 v202; // r8
  __int64 v203; // rdx
  __int64 v204; // rcx
  __int64 v205; // r8
  __int64 v206; // r9
  __int64 v207; // rdx
  __int64 v208; // rcx
  __int64 v209; // r8
  __int64 v210; // r9
  __int64 v211; // r9
  __int64 v212; // rbx
  __int64 v213; // r13
  __int64 v214; // rdx
  _QWORD *v215; // rax
  _QWORD *v216; // rbx
  __int64 v217; // rax
  __int64 v218; // rax
  char v219; // al
  __int64 v220; // rax
  __int64 v221; // rax
  char v222; // al
  __int64 v223; // rax
  __int64 v224; // rax
  char v225; // al
  __int64 v226; // rax
  __int64 v227; // rax
  __int64 v228; // [rsp-10h] [rbp-640h]
  __int64 v229; // [rsp+0h] [rbp-630h]
  unsigned __int64 v230; // [rsp+8h] [rbp-628h]
  __int64 v231; // [rsp+10h] [rbp-620h]
  void *v232; // [rsp+18h] [rbp-618h]
  __int64 v233; // [rsp+20h] [rbp-610h]
  __int64 v234; // [rsp+28h] [rbp-608h]
  __int64 *v235; // [rsp+30h] [rbp-600h]
  __int64 v236; // [rsp+38h] [rbp-5F8h]
  __int64 v237; // [rsp+40h] [rbp-5F0h]
  void *v238; // [rsp+48h] [rbp-5E8h]
  __int64 *v239; // [rsp+50h] [rbp-5E0h]
  __int64 v240; // [rsp+58h] [rbp-5D8h]
  __int64 v241; // [rsp+58h] [rbp-5D8h]
  unsigned __int8 *v242; // [rsp+60h] [rbp-5D0h]
  unsigned __int8 *v243; // [rsp+60h] [rbp-5D0h]
  __int64 v244; // [rsp+68h] [rbp-5C8h]
  __int64 v245; // [rsp+68h] [rbp-5C8h]
  __int64 *v246; // [rsp+70h] [rbp-5C0h]
  unsigned __int8 *v247; // [rsp+70h] [rbp-5C0h]
  __int64 *v248; // [rsp+78h] [rbp-5B8h]
  unsigned __int16 v249; // [rsp+78h] [rbp-5B8h]
  __int64 v250; // [rsp+78h] [rbp-5B8h]
  unsigned __int8 **v251; // [rsp+78h] [rbp-5B8h]
  __int64 v252; // [rsp+78h] [rbp-5B8h]
  __int64 v253; // [rsp+80h] [rbp-5B0h]
  int v254; // [rsp+88h] [rbp-5A8h]
  unsigned __int8 v255; // [rsp+8Fh] [rbp-5A1h]
  __int64 *v256; // [rsp+90h] [rbp-5A0h]
  __int64 v257; // [rsp+90h] [rbp-5A0h]
  __int64 v258; // [rsp+90h] [rbp-5A0h]
  __int64 *v259; // [rsp+A0h] [rbp-590h]
  const char *v260; // [rsp+A0h] [rbp-590h]
  _QWORD *v261; // [rsp+A0h] [rbp-590h]
  _QWORD *v262; // [rsp+A0h] [rbp-590h]
  _QWORD *v263; // [rsp+A0h] [rbp-590h]
  __int64 v264; // [rsp+A8h] [rbp-588h]
  unsigned __int8 *v265; // [rsp+B0h] [rbp-580h]
  __int64 *v266; // [rsp+B0h] [rbp-580h]
  __int64 *v267; // [rsp+B8h] [rbp-578h]
  __int64 *v268; // [rsp+C0h] [rbp-570h]
  __int64 v269; // [rsp+C0h] [rbp-570h]
  __int64 v270; // [rsp+C8h] [rbp-568h]
  __int64 *v271; // [rsp+C8h] [rbp-568h]
  __int64 *v272; // [rsp+C8h] [rbp-568h]
  __int64 v273; // [rsp+C8h] [rbp-568h]
  __int64 v274; // [rsp+C8h] [rbp-568h]
  __int64 v275; // [rsp+C8h] [rbp-568h]
  __int64 v277; // [rsp+D0h] [rbp-560h]
  __int64 v278; // [rsp+D0h] [rbp-560h]
  __int64 v279; // [rsp+D0h] [rbp-560h]
  __int64 *v280; // [rsp+D0h] [rbp-560h]
  unsigned __int8 *v282; // [rsp+E8h] [rbp-548h] BYREF
  void *v283; // [rsp+F0h] [rbp-540h] BYREF
  __int64 v284; // [rsp+F8h] [rbp-538h]
  _BYTE v285[344]; // [rsp+140h] [rbp-4F0h] BYREF
  __int64 v286; // [rsp+298h] [rbp-398h]
  unsigned __int8 *v287; // [rsp+2A0h] [rbp-390h] BYREF
  __int64 v288; // [rsp+2A8h] [rbp-388h]
  _BYTE v289[344]; // [rsp+2F0h] [rbp-340h] BYREF
  __int64 v290; // [rsp+448h] [rbp-1E8h]
  char *v291; // [rsp+450h] [rbp-1E0h] BYREF
  __int64 v292; // [rsp+458h] [rbp-1D8h]
  const char *v293; // [rsp+460h] [rbp-1D0h] BYREF
  __int64 v294; // [rsp+468h] [rbp-1C8h] BYREF
  __int16 v295; // [rsp+470h] [rbp-1C0h]
  _BYTE v296[344]; // [rsp+4A0h] [rbp-190h] BYREF
  __int64 v297; // [rsp+5F8h] [rbp-38h]

  v3 = (unsigned __int8)qword_4FF4C08;
  if ( (_BYTE)qword_4FF4C08 )
    return 0;
  v255 = *(_BYTE *)(a1 + 113);
  if ( !v255 )
    return 0;
  v5 = *(_QWORD *)(a2 + 208);
  LODWORD(v293) = 172;
  v291 = (char *)0x100000000FLL;
  v292 = 0xAB000000BCLL;
  if ( !*(_BYTE *)(v5 + 34976) )
  {
LABEL_11:
    v10 = (unsigned __int8 *)sub_2674090(*(_QWORD *)(a1 + 296), a2);
    v11 = sub_2673FE0(v10);
    v12 = sub_2674040(v10);
    v13 = *((_DWORD *)v11 + 8);
    v14 = v12;
    if ( v13 <= 0x40 )
    {
      if ( !*((_QWORD *)v11 + 3) )
        return 0;
    }
    else if ( v13 == (unsigned int)sub_C444A0((__int64)(v11 + 24)) )
    {
      return 0;
    }
    v15 = *((_DWORD *)v14 + 8);
    v16 = (__int64 *)*((_QWORD *)v14 + 3);
    if ( v15 > 0x40 )
    {
      v17 = *v16;
    }
    else
    {
      if ( !v15 )
        goto LABEL_18;
      v17 = (__int64)((_QWORD)v16 << (64 - (unsigned __int8)v15)) >> (64 - (unsigned __int8)v15);
    }
    if ( (v17 & 2) == 0 )
    {
LABEL_18:
      *a3 = 0;
      v18 = sub_ACD640(*((_QWORD *)v11 + 1), 0, 0);
      v19 = sub_2673FD0(*(unsigned __int8 **)(a1 + 304));
      LODWORD(v291) = 0;
      v20 = sub_AAAE30(v19, v18, &v291, 1);
      v21 = *(_QWORD *)(a1 + 304);
      LODWORD(v291) = 0;
      v22 = v20;
      v23 = sub_AAAE30(v21, v20, &v291, 1);
      LODWORD(v21) = *(_DWORD *)(a1 + 160);
      *(_QWORD *)(a1 + 304) = v23;
      if ( (_DWORD)v21 )
      {
        if ( !*(_DWORD *)(a1 + 224) )
        {
          if ( *(_QWORD *)(a2 + 4392) )
          {
            v270 = *(_QWORD *)(a1 + 296);
            v22 = sub_B43CB0(v270);
            v24 = (__int64 *)(*(__int64 (__fastcall **)(_QWORD, __int64))(a2 + 4392))(*(_QWORD *)(a2 + 4400), v22);
            v277 = *v24;
            v25 = sub_B2BE50(*v24);
            v26 = sub_B6EA50(v25);
            v27 = v270;
            if ( v26
              || (v220 = sub_B2BE50(v277),
                  v221 = sub_B6F970(v220),
                  v222 = (*(__int64 (__fastcall **)(__int64))(*(_QWORD *)v221 + 48LL))(v221),
                  v27 = v270,
                  v222) )
            {
              sub_B174A0((__int64)&v287, *(_QWORD *)(a2 + 4408), (__int64)"OMP131", 6, v27);
              sub_B18290((__int64)&v287, "Rewriting generic-mode kernel with a customized state machine.", 0x3Eu);
              sub_23FE290((__int64)&v291, (__int64)&v287, v28, v29, v30, v31);
              v297 = v290;
              v291 = (char *)&unk_49D9D78;
              sub_B18290((__int64)&v291, " [", 2u);
              sub_B18290((__int64)&v291, "OMP131", 6u);
              sub_B18290((__int64)&v291, "]", 1u);
              sub_23FE290((__int64)&v283, (__int64)&v291, v32, v33, (__int64)&v283, v34);
              v283 = &unk_49D9D78;
              v286 = v297;
              v291 = (char *)&unk_49D9D40;
              sub_23FD590((__int64)v296);
              v287 = (unsigned __int8 *)&unk_49D9D40;
              sub_23FD590((__int64)v289);
              v22 = (__int64)&v283;
              sub_1049740(v24, (__int64)&v283);
              v283 = &unk_49D9D40;
              sub_23FD590((__int64)v285);
            }
          }
LABEL_23:
          v35 = *(_QWORD *)(a1 + 72) & 0xFFFFFFFFFFFFFFFCLL;
          if ( (*(_QWORD *)(a1 + 72) & 3LL) == 3 )
            v35 = *(_QWORD *)(v35 + 24);
          v268 = (__int64 *)sub_BD5C60(v35);
          v265 = sub_250CBE0((__int64 *)(a1 + 72), v22);
          v36 = *(_QWORD *)(a1 + 296);
          v37 = *(__int64 **)(v36 + 40);
          v291 = "thread.user_code.check";
          v295 = 259;
          v38 = *(__int64 **)(v36 + 32);
          v256 = v37;
          if ( v38 == v37 + 6 || !v38 )
            v39 = 0;
          else
            v39 = v38 - 3;
          v40 = (__int64 *)sub_AA8550(v37, v39 + 3, 0, (__int64)&v291, 0);
          v295 = 259;
          v291 = "is_worker_check";
          v41 = sub_22077B0(0x50u);
          v271 = (__int64 *)v41;
          if ( v41 )
            sub_AA4D50(v41, (__int64)v268, (__int64)&v291, (__int64)v265, (__int64)v40);
          v291 = "worker_state_machine.begin";
          v295 = 259;
          v42 = sub_22077B0(0x50u);
          v239 = (__int64 *)v42;
          if ( v42 )
            sub_AA4D50(v42, (__int64)v268, (__int64)&v291, (__int64)v265, (__int64)v40);
          v291 = "worker_state_machine.finished";
          v295 = 259;
          v43 = sub_22077B0(0x50u);
          v248 = (__int64 *)v43;
          if ( v43 )
            sub_AA4D50(v43, (__int64)v268, (__int64)&v291, (__int64)v265, (__int64)v40);
          v291 = "worker_state_machine.is_active.check";
          v295 = 259;
          v44 = sub_22077B0(0x50u);
          v246 = (__int64 *)v44;
          if ( v44 )
            sub_AA4D50(v44, (__int64)v268, (__int64)&v291, (__int64)v265, (__int64)v40);
          v291 = "worker_state_machine.parallel_region.check";
          v295 = 259;
          v45 = sub_22077B0(0x50u);
          v259 = (__int64 *)v45;
          if ( v45 )
            sub_AA4D50(v45, (__int64)v268, (__int64)&v291, (__int64)v265, (__int64)v40);
          v291 = "worker_state_machine.parallel_region.end";
          v295 = 259;
          v46 = sub_22077B0(0x50u);
          v267 = (__int64 *)v46;
          if ( v46 )
            sub_AA4D50(v46, (__int64)v268, (__int64)&v291, (__int64)v265, (__int64)v40);
          v291 = "worker_state_machine.done.barrier";
          v295 = 259;
          v47 = sub_22077B0(0x50u);
          v235 = (__int64 *)v47;
          if ( v47 )
            sub_AA4D50(v47, (__int64)v268, (__int64)&v291, (__int64)v265, (__int64)v40);
          v253 = a2 + 3560;
          sub_D695C0((__int64)&v291, a2 + 3560, v256, v48, v49, v50);
          sub_D695C0((__int64)&v291, a2 + 3560, v40, v51, v52, v53);
          sub_D695C0((__int64)&v291, a2 + 3560, v271, v54, v55, v56);
          sub_D695C0((__int64)&v291, a2 + 3560, v239, v57, v58, v59);
          sub_D695C0((__int64)&v291, a2 + 3560, v248, v60, v61, v62);
          sub_D695C0((__int64)&v291, a2 + 3560, v246, v63, v64, v65);
          sub_D695C0((__int64)&v291, a2 + 3560, v259, v66, v67, v68);
          sub_D695C0((__int64)&v291, a2 + 3560, v267, v69, v70, v71);
          sub_D695C0((__int64)&v291, a2 + 3560, v235, v72, v73, v74);
          v278 = *(_QWORD *)(a1 + 296);
          sub_B43C20((__int64)&v291, (__int64)v248);
          v75 = sub_BD2C40(72, 0);
          v76 = v75;
          if ( v75 )
            sub_B4BB80((__int64)v75, (__int64)v268, 0, 0, (__int64)v291, v292);
          v291 = *(char **)(v278 + 48);
          if ( v291 )
            sub_266EF50((__int64 *)&v291);
          if ( v76 + 6 != &v291 )
            sub_2670E90(v76 + 6, (unsigned __int8 **)&v291);
          sub_9C6650(&v291);
          v77 = (_QWORD *)sub_986580((__int64)v256);
          sub_B43D60(v77);
          sub_B43C20((__int64)&v287, (__int64)v256);
          v291 = "thread.is_worker";
          v78 = *(_QWORD *)(a1 + 296);
          v295 = 259;
          v79 = sub_AD64C0(*(_QWORD *)(v78 + 8), -1, 0);
          v81 = sub_B52500(53, 33, *(_QWORD *)(a1 + 296), v79, (__int64)&v291, v80, (__int64)v287, v288);
          v291 = *(char **)(v278 + 48);
          if ( v291 )
            sub_266EF50((__int64 *)&v291);
          if ( (char **)(v81 + 48) != &v291 )
            sub_2670E90((__int64 *)(v81 + 48), (unsigned __int8 **)&v291);
          sub_9C6650(&v291);
          sub_B43C20((__int64)&v291, (__int64)v256);
          v82 = (__int64)v40;
          v83 = v5 + 400;
          sub_2673B10((__int64)v271, v82, v81, (__int64)v291, v292);
          v84 = v5 + 400;
          v234 = v5 + 400;
          v85 = *((_QWORD *)v265 + 5);
          v233 = v85;
          v86 = sub_312CF50(v84, v85, 15);
          v88 = v87;
          v240 = v86;
          v89 = sub_312CF50(v83, v85, 16);
          v257 = v90;
          v91 = v89;
          sub_B43C20((__int64)&v287, (__int64)v271);
          v291 = "block.hw_size";
          v295 = 259;
          v242 = v287;
          v244 = (unsigned __int16)v288;
          v92 = sub_BD2C40(88, 1u);
          v93 = (__int64)v92;
          if ( v92 )
            sub_B4A410((__int64)v92, v240, v88, (__int64)&v291, 1u, v244, (__int64)v242, v244);
          if ( !*(_BYTE *)v88 )
            *(_WORD *)(v93 + 2) = *(_WORD *)(v93 + 2) & 0xF003 | (4 * ((*(_WORD *)(v88 + 2) >> 4) & 0x3FF));
          v291 = *(char **)(v278 + 48);
          if ( v291 )
            sub_266EF50((__int64 *)&v291);
          if ( (char **)(v93 + 48) != &v291 )
            sub_2670E90((__int64 *)(v93 + 48), (unsigned __int8 **)&v291);
          sub_9C6650(&v291);
          sub_B43C20((__int64)&v287, (__int64)v271);
          v291 = "warp.size";
          v295 = 259;
          v243 = v287;
          v245 = (unsigned __int16)v288;
          v94 = sub_BD2C40(88, 1u);
          v95 = (__int64)v94;
          if ( v94 )
            sub_B4A410((__int64)v94, v91, v257, (__int64)&v291, 1u, v245, (__int64)v243, v245);
          if ( !*(_BYTE *)v257 )
            *(_WORD *)(v95 + 2) = *(_WORD *)(v95 + 2) & 0xF003 | (4 * ((*(_WORD *)(v257 + 2) >> 4) & 0x3FF));
          v291 = *(char **)(v278 + 48);
          if ( v291 )
            sub_266EF50((__int64 *)&v291);
          if ( (char **)(v95 + 48) != &v291 )
            sub_2670E90((__int64 *)(v95 + 48), (unsigned __int8 **)&v291);
          sub_9C6650(&v291);
          sub_B43C20((__int64)&v287, (__int64)v271);
          v291 = "block.size";
          v295 = 259;
          v96 = sub_B504D0(15, v93, v95, (__int64)&v291, (__int64)v287, v288);
          v291 = *(char **)(v278 + 48);
          if ( v291 )
            sub_266EF50((__int64 *)&v291);
          if ( (char **)(v96 + 48) != &v291 )
            sub_2670E90((__int64 *)(v96 + 48), (unsigned __int8 **)&v291);
          sub_9C6650(&v291);
          sub_B43C20((__int64)&v287, (__int64)v271);
          v291 = "thread.is_main_or_worker";
          v295 = 259;
          v98 = sub_B52500(53, 40, *(_QWORD *)(a1 + 296), v96, (__int64)&v291, v97, (__int64)v287, v288);
          v291 = *(char **)(v278 + 48);
          if ( v291 )
            sub_266EF50((__int64 *)&v291);
          if ( (char **)(v98 + 48) != &v291 )
            sub_2670E90((__int64 *)(v98 + 48), (unsigned __int8 **)&v291);
          sub_9C6650(&v291);
          sub_B43C20((__int64)&v291, (__int64)v271);
          sub_2673B10((__int64)v239, (__int64)v248, v98, (__int64)v291, v292);
          v272 = (__int64 *)sub_BCE3C0(v268, 0);
          v99 = *(_DWORD *)(v233 + 316);
          v291 = "worker.work_fn.addr";
          v295 = 259;
          v100 = *((_QWORD *)v265 + 10);
          if ( !v100 )
            BUG();
          v258 = *(_QWORD *)(v100 + 32);
          v101 = sub_BD2C40(80, unk_3F10A14);
          v103 = (__int64)v101;
          if ( v101 )
            sub_B4CDD0((__int64)v101, v272, v99, 0, (__int64)&v291, v102, v258, 1);
          v291 = *(char **)(v278 + 48);
          if ( v291 )
            sub_266EF50((__int64 *)&v291);
          if ( (char **)(v103 + 48) != &v291 )
            sub_2670E90((__int64 *)(v103 + 48), (unsigned __int8 **)&v291);
          sub_9C6650(&v291);
          v291 = (char *)v239;
          v292 = (__int64)(v239 + 6);
          LOWORD(v293) = 0;
          v294 = *(_QWORD *)(v278 + 48);
          if ( v294 )
            sub_266EF50(&v294);
          sub_2677420(v234, (__int64)&v291);
          sub_9C6650(&v294);
          v232 = (void *)sub_2673FC0(*(unsigned __int8 **)(a1 + 304));
          v241 = *(_QWORD *)(a1 + 296);
          v104 = sub_312CF50(v234, v233, 188);
          v106 = v105;
          v231 = v104;
          v229 = v105;
          sub_B43C20((__int64)&v287, (__int64)v239);
          v283 = v232;
          v284 = v241;
          v107 = v106;
          v295 = 257;
          v109 = sub_2673A60(v231, v106, (__int64 *)&v283, 2, (__int64)&v291, v108, (__int64)v287, v288);
          if ( !*(_BYTE *)v107 )
            *(_WORD *)(v109 + 2) = *(_WORD *)(v109 + 2) & 0xF003 | (4 * ((*(_WORD *)(v107 + 2) >> 4) & 0x3FF));
          v291 = *(char **)(v278 + 48);
          if ( v291 )
            sub_266EF50((__int64 *)&v291);
          if ( (char **)(v109 + 48) != &v291 )
            sub_2670E90((__int64 *)(v109 + 48), (unsigned __int8 **)&v291);
          sub_9C6650(&v291);
          v110 = *(_QWORD *)(v103 + 8);
          if ( (unsigned int)*(unsigned __int8 *)(v110 + 8) - 17 <= 1 )
            v110 = **(_QWORD **)(v110 + 16);
          if ( *(_DWORD *)(v110 + 8) >> 8 )
          {
            v213 = sub_BCE3C0(v268, 0);
            v291 = (char *)sub_BD5D20(v103);
            v295 = 773;
            v292 = v214;
            v293 = ".generic";
            sub_B43C20((__int64)&v287, (__int64)v239);
            v215 = sub_BD2C40(72, unk_3F10A14);
            v216 = v215;
            if ( v215 )
              sub_B51C90((__int64)v215, v103, v213, (__int64)&v291, (__int64)v287, v288);
            v291 = *(char **)(v278 + 48);
            if ( v291 )
              sub_266EF50((__int64 *)&v291);
            if ( v216 + 6 != &v291 )
              sub_2670E90(v216 + 6, (unsigned __int8 **)&v291);
            v103 = (__int64)v216;
            sub_9C6650(&v291);
          }
          v111 = sub_312CF50(v234, v233, 171);
          v113 = v112;
          sub_B43C20((__int64)&v287, (__int64)v239);
          v291 = "worker.is_active";
          v295 = 259;
          v283 = (void *)v103;
          v115 = sub_2673A60(v111, v113, (__int64 *)&v283, 1, (__int64)&v291, v114, (__int64)v287, v288);
          v116 = v115;
          if ( !*(_BYTE *)v113 )
            *(_WORD *)(v115 + 2) = *(_WORD *)(v115 + 2) & 0xF003 | (4 * ((*(_WORD *)(v113 + 2) >> 4) & 0x3FF));
          v291 = *(char **)(v278 + 48);
          if ( v291 )
            sub_266EF50((__int64 *)&v291);
          if ( (char **)(v116 + 48) != &v291 )
            sub_2670E90((__int64 *)(v116 + 48), (unsigned __int8 **)&v291);
          sub_9C6650(&v291);
          v291 = "worker.work_fn";
          v295 = 259;
          sub_B43C20((__int64)&v287, (__int64)v239);
          v117 = sub_BD2C40(80, unk_3F10A14);
          v237 = (__int64)v117;
          if ( v117 )
            sub_B4D230((__int64)v117, (__int64)v272, v103, (__int64)&v291, (__int64)v287, v288);
          v291 = *(char **)(v278 + 48);
          if ( v291 )
            sub_266EF50((__int64 *)&v291);
          if ( (char **)(v237 + 48) != &v291 )
            sub_2670E90((__int64 *)(v237 + 48), (unsigned __int8 **)&v291);
          sub_9C6650(&v291);
          v291 = (char *)sub_BCB2C0(v268);
          v292 = sub_BCB2D0(v268);
          v118 = (__int64 *)sub_BCB120(v268);
          v230 = sub_BCF480(v118, &v291, 2, 0);
          sub_B43C20((__int64)&v287, (__int64)v239);
          v291 = "worker.is_done";
          v295 = 259;
          v119 = sub_AD6530((__int64)v272, (__int64)v239);
          v121 = sub_B52500(53, 32, v237, v119, (__int64)&v291, v120, (__int64)v287, v288);
          v291 = *(char **)(v278 + 48);
          if ( v291 )
            sub_266EF50((__int64 *)&v291);
          if ( (char **)(v121 + 48) != &v291 )
            sub_2670E90((__int64 *)(v121 + 48), (unsigned __int8 **)&v291);
          sub_9C6650(&v291);
          sub_B43C20((__int64)&v291, (__int64)v239);
          v122 = sub_2673B10((__int64)v248, (__int64)v246, v121, (__int64)v291, v292);
          v287 = *(unsigned __int8 **)(v278 + 48);
          if ( v287 )
            sub_266EF50((__int64 *)&v287);
          if ( v122 + 6 != &v287 )
            sub_2670E90(v122 + 6, &v287);
          sub_9C6650(&v287);
          sub_B43C20((__int64)&v291, (__int64)v246);
          v123 = (__int64)v235;
          v124 = sub_2673B10((__int64)v259, (__int64)v235, v116, (__int64)v291, v292);
          v287 = *(unsigned __int8 **)(v278 + 48);
          if ( v287 )
            sub_266EF50((__int64 *)&v287);
          if ( v124 + 6 != &v287 )
          {
            v123 = (__int64)&v287;
            sub_2670E90(v124 + 6, &v287);
          }
          sub_9C6650(&v287);
          v238 = (void *)sub_AD6530(*(_QWORD *)(*(_QWORD *)(v230 + 16) + 8LL), v123);
          v254 = *(_DWORD *)(a1 + 160);
          if ( v254 > 0 )
          {
            v236 = *(unsigned int *)(a1 + 160);
            v273 = 0;
            while ( 1 )
            {
              v144 = *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8 * v273);
              v145 = sub_BD3990(*(unsigned __int8 **)(v144 + 32 * (6LL - (*(_DWORD *)(v144 + 4) & 0x7FFFFFF))), v123);
              if ( *v145 )
              {
                v291 = "worker_state_machine.parallel_region.execute";
                v295 = 259;
                v173 = sub_22077B0(0x50u);
                v147 = (__int64 *)v173;
                if ( v173 )
                {
                  sub_AA4D50(v173, (__int64)v268, (__int64)&v291, (__int64)v265, (__int64)v267);
                  v174 = (__int64)v147;
                }
                else
                {
                  v174 = 0;
                }
                v145 = 0;
                sub_B43C20((__int64)&v287, v174);
                v150 = 0;
                v295 = 257;
                v283 = v238;
                v284 = v241;
              }
              else
              {
                v291 = "worker_state_machine.parallel_region.execute";
                v295 = 259;
                v146 = sub_22077B0(0x50u);
                v147 = (__int64 *)v146;
                if ( v146 )
                {
                  sub_AA4D50(v146, (__int64)v268, (__int64)&v291, (__int64)v265, (__int64)v267);
                  v148 = (__int64)v147;
                }
                else
                {
                  v148 = 0;
                }
                sub_B43C20((__int64)&v287, v148);
                v295 = 257;
                v283 = v238;
                v284 = v241;
                v150 = *((_QWORD *)v145 + 3);
              }
              v151 = sub_2673A60(v150, (__int64)v145, (__int64 *)&v283, 2, (__int64)&v291, v149, (__int64)v287, v288);
              v152 = v151;
              v282 = *(unsigned __int8 **)(v278 + 48);
              if ( !v282 )
                break;
              sub_266EF50((__int64 *)&v282);
              v125 = v152 + 48;
              if ( (unsigned __int8 **)(v152 + 48) != &v282 )
              {
                v153 = *(_QWORD *)(v152 + 48);
                if ( !v153 )
                {
LABEL_153:
                  v154 = v282;
                  *(_QWORD *)(v152 + 48) = v282;
                  if ( v154 )
                    sub_B976B0((__int64)&v282, v154, v125);
                  goto LABEL_123;
                }
LABEL_152:
                v250 = v125;
                sub_B91220(v125, v153);
                v125 = v250;
                goto LABEL_153;
              }
              if ( v282 )
                sub_B91220((__int64)&v282, (__int64)v282);
LABEL_123:
              sub_B43C20((__int64)&v291, (__int64)v147);
              v247 = (unsigned __int8 *)v291;
              v249 = v292;
              v126 = sub_BD2C40(72, 1u);
              v127 = v126;
              if ( v126 )
                sub_B4C8F0((__int64)v126, (__int64)v267, 1u, (__int64)v247, v249);
              v128 = (unsigned __int8 **)(v127 + 6);
              v287 = *(unsigned __int8 **)(v278 + 48);
              if ( !v287 )
              {
                if ( v128 == &v287 )
                  goto LABEL_129;
                v169 = v127[6];
                if ( !v169 )
                  goto LABEL_129;
LABEL_169:
                v251 = v128;
                sub_B91220((__int64)v128, v169);
                v128 = v251;
                goto LABEL_170;
              }
              sub_266EF50((__int64 *)&v287);
              v128 = (unsigned __int8 **)(v127 + 6);
              if ( v127 + 6 == &v287 )
              {
                if ( v287 )
                  sub_B91220((__int64)&v287, (__int64)v287);
                goto LABEL_129;
              }
              v169 = v127[6];
              if ( v169 )
                goto LABEL_169;
LABEL_170:
              v170 = v287;
              v127[6] = v287;
              if ( v170 )
                sub_B976B0((__int64)&v287, v170, (__int64)v128);
LABEL_129:
              v291 = "worker_state_machine.parallel_region.check";
              v295 = 259;
              v129 = sub_22077B0(0x50u);
              v133 = (__int64 *)v129;
              if ( v129 )
                sub_AA4D50(v129, (__int64)v268, (__int64)&v291, (__int64)v265, (__int64)v267);
              sub_D695C0((__int64)&v291, v253, v147, v130, v131, v132);
              sub_D695C0((__int64)&v291, v253, v133, v134, v135, v136);
              if ( v254 <= (int)v273 + 1 && !*(_DWORD *)(a1 + 224) )
              {
                v139 = sub_ACD6D0(v268);
                goto LABEL_137;
              }
              sub_B43C20((__int64)&v287, (__int64)v259);
              v291 = "worker.check_parallel_region";
              v295 = 259;
              v138 = sub_B52500(53, 32, v237, (__int64)v145, (__int64)&v291, v137, (__int64)v287, v288);
              v139 = v138;
              v291 = *(char **)(v278 + 48);
              if ( !v291 )
              {
                v140 = v138 + 48;
                if ( (char **)(v138 + 48) == &v291 )
                  goto LABEL_137;
                v171 = *(_QWORD *)(v138 + 48);
                if ( !v171 )
                  goto LABEL_137;
LABEL_174:
                v252 = v140;
                sub_B91220(v140, v171);
                v140 = v252;
                goto LABEL_175;
              }
              sub_266EF50((__int64 *)&v291);
              v140 = v139 + 48;
              if ( (char **)(v139 + 48) == &v291 )
              {
                if ( v291 )
                  sub_B91220((__int64)&v291, (__int64)v291);
                goto LABEL_137;
              }
              v171 = *(_QWORD *)(v139 + 48);
              if ( v171 )
                goto LABEL_174;
LABEL_175:
              v172 = (unsigned __int8 *)v291;
              *(_QWORD *)(v139 + 48) = v291;
              if ( v172 )
                sub_B976B0((__int64)&v291, v172, v140);
LABEL_137:
              sub_B43C20((__int64)&v291, (__int64)v259);
              v123 = 3;
              v260 = v291;
              v264 = (unsigned __int16)v292;
              v141 = sub_BD2C40(72, 3u);
              if ( v141 )
              {
                v142 = (__int64)v260;
                v261 = v141;
                sub_B4C9A0((__int64)v141, (__int64)v147, (__int64)v133, v139, 3u, v264, v142, v264);
                v141 = v261;
                v123 = v228;
              }
              v143 = (unsigned __int8 **)(v141 + 6);
              v287 = *(unsigned __int8 **)(v278 + 48);
              if ( !v287 )
              {
                if ( v143 == &v287 )
                  goto LABEL_143;
                v123 = v141[6];
                if ( !v123 )
                  goto LABEL_143;
LABEL_164:
                v263 = v141;
                sub_B91220((__int64)v143, v123);
                v141 = v263;
                goto LABEL_165;
              }
              v262 = v141;
              sub_266EF50((__int64 *)&v287);
              if ( v143 == &v287 )
              {
                v123 = (__int64)v287;
                if ( v287 )
                  sub_B91220((__int64)&v287, (__int64)v287);
                goto LABEL_143;
              }
              v141 = v262;
              v123 = v262[6];
              if ( v123 )
                goto LABEL_164;
LABEL_165:
              v123 = (__int64)v287;
              v141[6] = v287;
              if ( v123 )
                sub_B976B0((__int64)&v287, (unsigned __int8 *)v123, (__int64)v143);
LABEL_143:
              if ( v236 == ++v273 )
                goto LABEL_189;
              v259 = v133;
            }
            v125 = v151 + 48;
            if ( (unsigned __int8 **)(v151 + 48) == &v282 )
              goto LABEL_123;
            v153 = *(_QWORD *)(v151 + 48);
            if ( !v153 )
              goto LABEL_123;
            goto LABEL_152;
          }
          v133 = v259;
LABEL_189:
          if ( *(_DWORD *)(a1 + 224) )
          {
            v291 = "worker_state_machine.parallel_region.fallback.execute";
            v295 = 259;
            sub_BD6B50((unsigned __int8 *)v133, (const char **)&v291);
            sub_B43C20((__int64)&v287, (__int64)v133);
            v283 = v238;
            v295 = 257;
            v284 = v241;
            v212 = sub_2673A60(v230, v237, (__int64 *)&v283, 2, (__int64)&v291, v211, (__int64)v287, v288);
            v282 = *(unsigned __int8 **)(v278 + 48);
            if ( v282 )
              sub_266EF50((__int64 *)&v282);
            if ( (unsigned __int8 **)(v212 + 48) != &v282 )
              sub_2670E90((__int64 *)(v212 + 48), &v282);
            sub_9C6650(&v282);
          }
          sub_B43C20((__int64)&v291, (__int64)v133);
          v175 = sub_F340F0((__int64)v267, (__int64)v291, v292);
          v287 = *(unsigned __int8 **)(v278 + 48);
          if ( v287 )
            sub_266EF50((__int64 *)&v287);
          if ( v175 + 6 != &v287 )
            sub_2670E90(v175 + 6, &v287);
          sub_9C6650(&v287);
          v176 = sub_312CF50(v234, v233, 172);
          v178 = v177;
          v179 = v176;
          sub_B43C20((__int64)&v287, (__int64)v267);
          v295 = 257;
          v181 = sub_2673A60(v179, v178, 0, 0, (__int64)&v291, v180, (__int64)v287, v288);
          v182 = v181;
          if ( !*(_BYTE *)v178 )
            *(_WORD *)(v181 + 2) = *(_WORD *)(v181 + 2) & 0xF003 | (4 * ((*(_WORD *)(v178 + 2) >> 4) & 0x3FF));
          v291 = *(char **)(v278 + 48);
          if ( v291 )
            sub_266EF50((__int64 *)&v291);
          if ( (char **)(v182 + 48) != &v291 )
            sub_2670E90((__int64 *)(v182 + 48), (unsigned __int8 **)&v291);
          sub_9C6650(&v291);
          sub_B43C20((__int64)&v291, (__int64)v267);
          v183 = sub_F340F0((__int64)v235, (__int64)v291, v292);
          v287 = *(unsigned __int8 **)(v278 + 48);
          if ( v287 )
            sub_266EF50((__int64 *)&v287);
          if ( v183 + 6 != &v287 )
            sub_2670E90(v183 + 6, &v287);
          sub_9C6650(&v287);
          sub_B43C20((__int64)&v287, (__int64)v235);
          v283 = v232;
          v295 = 257;
          v284 = v241;
          v185 = sub_2673A60(v231, v229, (__int64 *)&v283, 2, (__int64)&v291, v184, (__int64)v287, v288);
          v282 = *(unsigned __int8 **)(v278 + 48);
          if ( v282 )
            sub_266EF50((__int64 *)&v282);
          if ( (unsigned __int8 **)(v185 + 48) != &v282 )
            sub_2670E90((__int64 *)(v185 + 48), &v282);
          sub_9C6650(&v282);
          sub_B43C20((__int64)&v291, (__int64)v235);
          v186 = sub_F340F0((__int64)v239, (__int64)v291, v292);
          v287 = *(unsigned __int8 **)(v278 + 48);
          if ( v287 )
            sub_266EF50((__int64 *)&v287);
          if ( v186 + 6 != &v287 )
            sub_2670E90(v186 + 6, &v287);
          sub_9C6650(&v287);
          return v255;
        }
      }
      else
      {
        v22 = *(unsigned int *)(a1 + 224);
        if ( !(_DWORD)v22 )
        {
          if ( *(_QWORD *)(a2 + 4392) )
          {
            v155 = *(_QWORD *)(a1 + 296);
            v156 = sub_B43CB0(v155);
            v157 = (__int64 *)(*(__int64 (__fastcall **)(_QWORD, __int64))(a2 + 4392))(*(_QWORD *)(a2 + 4400), v156);
            v158 = *v157;
            v159 = v157;
            v160 = sub_B2BE50(*v157);
            if ( sub_B6EA50(v160)
              || (v226 = sub_B2BE50(v158),
                  v227 = sub_B6F970(v226),
                  (*(unsigned __int8 (__fastcall **)(__int64))(*(_QWORD *)v227 + 48LL))(v227)) )
            {
              sub_B174A0((__int64)&v287, *(_QWORD *)(a2 + 4408), (__int64)"OMP130", 6, v155);
              sub_B18290((__int64)&v287, "Removing unused state machine from generic-mode kernel.", 0x37u);
              sub_23FE290((__int64)&v291, (__int64)&v287, v161, v162, v163, v164);
              v297 = v290;
              v291 = (char *)&unk_49D9D78;
              sub_B18290((__int64)&v291, " [", 2u);
              sub_B18290((__int64)&v291, "OMP130", 6u);
              sub_B18290((__int64)&v291, "]", 1u);
              sub_23FE290((__int64)&v283, (__int64)&v291, v165, v166, v167, v168);
              v283 = &unk_49D9D78;
              v286 = v297;
              v291 = (char *)&unk_49D9D40;
              sub_23FD590((__int64)v296);
              v287 = (unsigned __int8 *)&unk_49D9D40;
              sub_23FD590((__int64)v289);
              sub_1049740(v159, (__int64)&v283);
              v283 = &unk_49D9D40;
              sub_23FD590((__int64)v285);
            }
          }
          return v255;
        }
      }
      if ( *(_QWORD *)(a2 + 4392) )
      {
        v274 = *(_QWORD *)(a1 + 296);
        v22 = sub_B43CB0(v274);
        v187 = (__int64 *)(*(__int64 (__fastcall **)(_QWORD, __int64))(a2 + 4392))(*(_QWORD *)(a2 + 4400), v22);
        v279 = *v187;
        v188 = sub_B2BE50(*v187);
        v189 = sub_B6EA50(v188);
        v190 = v274;
        if ( v189
          || (v223 = sub_B2BE50(v279),
              v224 = sub_B6F970(v223),
              v225 = (*(__int64 (__fastcall **)(__int64))(*(_QWORD *)v224 + 48LL))(v224),
              v190 = v274,
              v225) )
        {
          sub_B178C0((__int64)&v287, *(_QWORD *)(a2 + 4408), (__int64)"OMP132", 6, v190);
          sub_B18290(
            (__int64)&v287,
            "Generic-mode kernel is executed with a customized state machine that requires a fallback.",
            0x59u);
          sub_23FE290((__int64)&v291, (__int64)&v287, v191, v192, v193, v194);
          v297 = v290;
          v291 = (char *)&unk_49D9DE8;
          sub_B18290((__int64)&v291, " [", 2u);
          sub_B18290((__int64)&v291, "OMP132", 6u);
          sub_B18290((__int64)&v291, "]", 1u);
          sub_23FE290((__int64)&v283, (__int64)&v291, v195, v196, (__int64)&v283, v197);
          v283 = &unk_49D9DE8;
          v286 = v297;
          v291 = (char *)&unk_49D9D40;
          sub_23FD590((__int64)v296);
          v287 = (unsigned __int8 *)&unk_49D9D40;
          sub_23FD590((__int64)v289);
          v22 = (__int64)&v283;
          sub_1049740(v187, (__int64)&v283);
          v283 = &unk_49D9D40;
          sub_23FD590((__int64)v285);
        }
      }
      v198 = *(__int64 **)(a1 + 216);
      v199 = v198;
      v280 = &v198[*(unsigned int *)(a1 + 224)];
      if ( v198 != v280 )
      {
        do
        {
          if ( *v199 )
          {
            if ( *(_QWORD *)(a2 + 4392) )
            {
              v269 = *v199;
              v22 = sub_B43CB0(*v199);
              v266 = (__int64 *)(*(__int64 (__fastcall **)(_QWORD, __int64))(a2 + 4392))(*(_QWORD *)(a2 + 4400), v22);
              v275 = *v266;
              v200 = sub_B2BE50(*v266);
              v201 = sub_B6EA50(v200);
              v202 = v269;
              if ( v201
                || (v217 = sub_B2BE50(v275),
                    v218 = sub_B6F970(v217),
                    v219 = (*(__int64 (__fastcall **)(__int64))(*(_QWORD *)v218 + 48LL))(v218),
                    v202 = v269,
                    v219) )
              {
                sub_B178C0((__int64)&v287, *(_QWORD *)(a2 + 4408), (__int64)"OMP133", 6, v202);
                sub_B18290((__int64)&v287, "Call may contain unknown parallel regions. Use ", 0x2Fu);
                sub_B18290((__int64)&v287, "`[[omp::assume(\"omp_no_parallelism\")]]` to override.", 0x34u);
                sub_23FE290((__int64)&v291, (__int64)&v287, v203, v204, v205, v206);
                v297 = v290;
                v291 = (char *)&unk_49D9DE8;
                sub_B18290((__int64)&v291, " [", 2u);
                sub_B18290((__int64)&v291, "OMP133", 6u);
                sub_B18290((__int64)&v291, "]", 1u);
                sub_23FE290((__int64)&v283, (__int64)&v291, v207, v208, v209, v210);
                v283 = &unk_49D9DE8;
                v286 = v297;
                v291 = (char *)&unk_49D9D40;
                sub_23FD590((__int64)v296);
                v287 = (unsigned __int8 *)&unk_49D9D40;
                sub_23FD590((__int64)v289);
                v22 = (__int64)&v283;
                sub_1049740(v266, (__int64)&v283);
                v283 = &unk_49D9D40;
                sub_23FD590((__int64)v285);
              }
            }
          }
          ++v199;
        }
        while ( v280 != v199 );
      }
      goto LABEL_23;
    }
    return 0;
  }
  v7 = (const char **)&v291;
  for ( i = 15; ; i = *(int *)v7 )
  {
    v9 = *(_QWORD *)(v5 + 160 * i + 3632);
    if ( !v9 || sub_B2FC80(v9) )
      break;
    v7 = (const char **)((char *)v7 + 4);
    if ( (const char **)((char *)&v293 + 4) == v7 )
      goto LABEL_11;
  }
  return v3;
}

// Function: sub_EFE900
// Address: 0xefe900
//
void __fastcall sub_EFE900(
        __int64 a1,
        unsigned int a2,
        __int64 a3,
        __int64 a4,
        __int64 a5,
        __int64 a6,
        unsigned int a7,
        char a8)
{
  __int64 v8; // rbx
  int v9; // r14d
  int v10; // ecx
  _DWORD *v11; // r15
  int v12; // r13d
  unsigned int v13; // ecx
  int v14; // r13d
  __int64 *v15; // rdx
  __int64 v16; // r12
  unsigned __int8 v17; // al
  unsigned int v18; // r14d
  char v19; // dl
  __int64 v20; // rax
  unsigned __int8 v21; // dl
  unsigned int v22; // eax
  __int64 v23; // r13
  unsigned int v24; // ecx
  __int64 v25; // r13
  unsigned int v26; // ebx
  unsigned int v27; // r12d
  unsigned int v28; // eax
  int v29; // edx
  int v30; // edx
  _QWORD *v31; // r14
  __int64 v32; // rdx
  __int64 v33; // r13
  unsigned int v34; // r13d
  int v35; // ecx
  unsigned int v36; // eax
  unsigned int v37; // ecx
  int v38; // eax
  _QWORD *v39; // rdi
  __int64 v40; // rdx
  int v41; // eax
  unsigned int v42; // r13d
  __int64 v43; // rax
  int v44; // ecx
  unsigned int v45; // r8d
  _QWORD *v46; // rdi
  __int64 v47; // rcx
  int v48; // edx
  unsigned int v49; // r13d
  unsigned int v50; // ecx
  int v51; // edx
  unsigned int v52; // ecx
  int v53; // eax
  unsigned __int8 *v54; // rax
  unsigned __int8 *v55; // r15
  unsigned __int8 *v56; // r12
  unsigned int v57; // eax
  int v58; // ecx
  unsigned int v59; // r8d
  unsigned int v60; // ecx
  _QWORD *v61; // rdi
  __int64 v62; // rdx
  int v63; // edx
  unsigned int v64; // eax
  unsigned __int64 v65; // rsi
  char v66; // dl
  int v67; // ecx
  unsigned int v68; // eax
  int v69; // r10d
  int v70; // r10d
  _QWORD *v71; // rdi
  __int64 v72; // rdx
  int v73; // edx
  unsigned int v74; // esi
  unsigned int v75; // eax
  _QWORD *v76; // rdi
  __int64 v77; // rcx
  int v78; // eax
  _QWORD *v79; // rax
  __int64 v80; // rdx
  unsigned int v81; // edx
  int v82; // eax
  unsigned __int64 v83; // rsi
  int v84; // r10d
  __int64 v85; // r13
  unsigned int v86; // ebx
  unsigned int v87; // r12d
  int v88; // edx
  int v89; // edx
  _QWORD *v90; // r14
  __int64 v91; // rdx
  int v92; // edx
  unsigned int v93; // ecx
  int v94; // eax
  int v95; // r12d
  unsigned int v96; // r15d
  int v97; // ecx
  unsigned int v98; // eax
  unsigned int v99; // ecx
  int v100; // eax
  _QWORD *v101; // rdi
  __int64 v102; // rdx
  int v103; // eax
  unsigned int v104; // r15d
  __int64 v105; // r15
  char v106; // al
  __int64 v107; // rax
  int v108; // ecx
  unsigned int v109; // r9d
  unsigned int v110; // r13d
  unsigned int v111; // ecx
  __int64 v112; // r10
  __int64 v113; // r15
  unsigned int v114; // ebx
  int v115; // eax
  unsigned int v116; // r10d
  unsigned int v117; // r10d
  unsigned int v118; // eax
  _QWORD *v119; // r14
  __int64 v120; // rdx
  int v121; // eax
  unsigned int v122; // ecx
  int v123; // r13d
  _QWORD *v124; // rax
  __int64 v125; // rcx
  int v126; // eax
  _QWORD *v127; // rax
  __int64 v128; // r10
  __int64 v129; // rcx
  __int64 v130; // r13
  unsigned __int64 v131; // rdx
  _QWORD *v132; // rsi
  __int64 v133; // rdx
  _BYTE *v134; // r13
  __int64 v135; // r15
  _QWORD *v136; // r13
  __int64 v137; // rax
  _QWORD *v138; // rdi
  __int64 v139; // rcx
  int v140; // eax
  _QWORD *v141; // rdi
  __int64 v142; // rdx
  int v143; // edx
  unsigned int v144; // r15d
  char v145; // al
  unsigned int v146; // r13d
  int v147; // ecx
  unsigned int v148; // r12d
  unsigned int v149; // ecx
  int v150; // r12d
  __int64 v151; // r13
  int v152; // ecx
  int v153; // r14d
  unsigned int v154; // ecx
  int v155; // r14d
  _QWORD *v156; // rax
  int v157; // r13d
  __int64 v158; // rcx
  __int64 v159; // rdx
  _QWORD *v160; // r14
  __int64 v161; // rax
  unsigned int v162; // edx
  int v163; // eax
  _QWORD *v164; // r12
  __int64 v165; // rax
  unsigned int v166; // edx
  int v167; // eax
  __int64 v168; // [rsp+8h] [rbp-98h]
  unsigned int v169; // [rsp+10h] [rbp-90h]
  unsigned int v170; // [rsp+10h] [rbp-90h]
  int v171; // [rsp+10h] [rbp-90h]
  int v172; // [rsp+10h] [rbp-90h]
  __int64 v173; // [rsp+10h] [rbp-90h]
  int v174; // [rsp+10h] [rbp-90h]
  unsigned int v175; // [rsp+10h] [rbp-90h]
  unsigned int v176; // [rsp+18h] [rbp-88h]
  unsigned int v177; // [rsp+18h] [rbp-88h]
  int v178; // [rsp+18h] [rbp-88h]
  int v179; // [rsp+18h] [rbp-88h]
  int v180; // [rsp+18h] [rbp-88h]
  __int64 v181; // [rsp+18h] [rbp-88h]
  int v182; // [rsp+18h] [rbp-88h]
  int v183; // [rsp+18h] [rbp-88h]
  __int64 v184; // [rsp+18h] [rbp-88h]
  char v185; // [rsp+18h] [rbp-88h]
  unsigned int v186; // [rsp+18h] [rbp-88h]
  __int64 v187; // [rsp+18h] [rbp-88h]
  int v188; // [rsp+20h] [rbp-80h]
  unsigned int v189; // [rsp+20h] [rbp-80h]
  __int64 v190; // [rsp+20h] [rbp-80h]
  __int64 v191; // [rsp+20h] [rbp-80h]
  __int64 v192; // [rsp+20h] [rbp-80h]
  int v193; // [rsp+20h] [rbp-80h]
  __int64 v194; // [rsp+20h] [rbp-80h]
  _QWORD *v195; // [rsp+20h] [rbp-80h]
  int v196; // [rsp+20h] [rbp-80h]
  __int64 v197; // [rsp+20h] [rbp-80h]
  __int64 v198; // [rsp+20h] [rbp-80h]
  int v199; // [rsp+20h] [rbp-80h]
  _QWORD *v200; // [rsp+20h] [rbp-80h]
  char v201; // [rsp+20h] [rbp-80h]
  __int64 v202; // [rsp+20h] [rbp-80h]
  __int64 v203; // [rsp+28h] [rbp-78h]
  int v204; // [rsp+28h] [rbp-78h]
  __int64 v205; // [rsp+28h] [rbp-78h]
  _QWORD *v206; // [rsp+28h] [rbp-78h]
  __int64 v207; // [rsp+28h] [rbp-78h]
  __int64 v209; // [rsp+38h] [rbp-68h]
  __int64 v210; // [rsp+40h] [rbp-60h]
  unsigned int v211; // [rsp+4Ch] [rbp-54h]
  __int64 v213; // [rsp+58h] [rbp-48h]
  int v214; // [rsp+58h] [rbp-48h]
  _QWORD *v215; // [rsp+60h] [rbp-40h]
  int v216; // [rsp+68h] [rbp-38h]
  __int64 v217; // [rsp+68h] [rbp-38h]

  v8 = a1;
  v9 = *(_DWORD *)(a1 + 56);
  v10 = *(_DWORD *)(a1 + 48);
  v11 = *(_DWORD **)(*(_QWORD *)(a1 + 64) + 16LL * (a2 - 4));
  v210 = a5;
  v12 = a2 << v10;
  v13 = v9 + v10;
  v14 = *(_DWORD *)(a1 + 52) | v12;
  v209 = a6;
  v211 = a6;
  *(_DWORD *)(a1 + 52) = v14;
  if ( v13 > 0x1F )
  {
    v79 = *(_QWORD **)(a1 + 24);
    v80 = v79[1];
    a5 = v80 + 4;
    if ( (unsigned __int64)(v80 + 4) > v79[2] )
    {
      v217 = *(_QWORD *)(a1 + 24);
      sub_C8D290(v217, v79 + 3, v80 + 4, 1u, a5, a6);
      v79 = (_QWORD *)v217;
      v80 = *(_QWORD *)(v217 + 8);
    }
    *(_DWORD *)(*v79 + v80) = v14;
    v81 = 0;
    v79[1] += 4LL;
    v82 = *(_DWORD *)(a1 + 48);
    if ( v82 )
      v81 = a2 >> (32 - v82);
    *(_DWORD *)(a1 + 52) = v81;
    *(_DWORD *)(a1 + 48) = ((_BYTE)v82 + (_BYTE)v9) & 0x1F;
  }
  else
  {
    *(_DWORD *)(a1 + 48) = v13;
  }
  v216 = v11[2];
  if ( a8 )
  {
    v15 = *(__int64 **)v11;
    LODWORD(v16) = 1;
    v17 = *(_BYTE *)(*(_QWORD *)v11 + 8LL);
    if ( (v17 & 1) == 0 )
    {
      v145 = (v17 >> 1) & 7;
      switch ( v145 )
      {
        case 2:
          v159 = *v15;
          if ( v159 )
            sub_A17DE0(a1, a7, v159);
          break;
        case 4:
          if ( (unsigned __int8)(a7 - 97) <= 0x19u )
          {
            v146 = (char)a7 - 97;
          }
          else if ( (unsigned __int8)(a7 - 65) <= 0x19u )
          {
            v146 = (char)a7 - 39;
          }
          else
          {
            v146 = (char)a7 + 4;
            if ( (unsigned __int8)(a7 - 48) > 9u )
            {
              if ( (_BYTE)a7 == 46 )
              {
                v146 = 62;
              }
              else
              {
                if ( (_BYTE)a7 != 95 )
LABEL_217:
                  BUG();
                v146 = 63;
              }
            }
          }
          v147 = *(_DWORD *)(a1 + 48);
          v148 = v146 << v147;
          v149 = v147 + 6;
          v150 = *(_DWORD *)(a1 + 52) | v148;
          *(_DWORD *)(a1 + 52) = v150;
          if ( v149 > 0x1F )
          {
            v160 = *(_QWORD **)(a1 + 24);
            v161 = v160[1];
            if ( (unsigned __int64)(v161 + 4) > v160[2] )
            {
              sub_C8D290(*(_QWORD *)(a1 + 24), v160 + 3, v161 + 4, 1u, a5, a6);
              v161 = v160[1];
            }
            *(_DWORD *)(*v160 + v161) = v150;
            v162 = 0;
            v160[1] += 4LL;
            v163 = *(_DWORD *)(a1 + 48);
            if ( v163 )
              v162 = v146 >> (32 - v163);
            *(_DWORD *)(a1 + 52) = v162;
            LODWORD(v16) = 1;
            *(_DWORD *)(a1 + 48) = ((_BYTE)v163 + 6) & 0x1F;
          }
          else
          {
            *(_DWORD *)(a1 + 48) = v149;
            LODWORD(v16) = 1;
          }
          break;
        case 1:
          v151 = *v15;
          if ( *v15 )
          {
            v152 = *(_DWORD *)(a1 + 48);
            v153 = a7 << v152;
            v154 = v151 + v152;
            v155 = *(_DWORD *)(a1 + 52) | v153;
            *(_DWORD *)(a1 + 52) = v155;
            if ( v154 > 0x1F )
            {
              v164 = *(_QWORD **)(a1 + 24);
              v165 = v164[1];
              if ( (unsigned __int64)(v165 + 4) > v164[2] )
              {
                sub_C8D290(*(_QWORD *)(a1 + 24), v164 + 3, v165 + 4, 1u, a5, a6);
                v165 = v164[1];
              }
              *(_DWORD *)(*v164 + v165) = v155;
              v166 = 0;
              v164[1] += 4LL;
              v167 = *(_DWORD *)(a1 + 48);
              if ( v167 )
                v166 = a7 >> (32 - v167);
              *(_DWORD *)(a1 + 52) = v166;
              LODWORD(v16) = 1;
              *(_DWORD *)(a1 + 48) = ((_BYTE)v151 + (_BYTE)v167) & 0x1F;
            }
            else
            {
              *(_DWORD *)(a1 + 48) = v154;
            }
          }
          break;
        default:
LABEL_218:
          BUG();
      }
    }
  }
  else
  {
    LODWORD(v16) = 0;
  }
  v18 = 0;
  v213 = v210;
  if ( v216 != (_DWORD)v16 )
  {
    v215 = v11;
    while ( 1 )
    {
      v20 = *v215 + 16LL * (unsigned int)v16;
      v21 = *(_BYTE *)(v20 + 8);
      if ( (v21 & 1) != 0 )
        goto LABEL_13;
      v19 = (v21 >> 1) & 7;
      if ( v19 == 3 )
        break;
      if ( v19 == 5 )
      {
        if ( v213 )
        {
          sub_A18720(v8, v210, v209, 1);
          v213 = 0;
        }
        else
        {
          v110 = *(_DWORD *)(v8 + 52);
          v111 = *(_DWORD *)(v8 + 48);
          v112 = a4 - v18;
          a6 = a3 + 8LL * v18;
          a5 = (unsigned int)v112;
          if ( (unsigned int)v112 > 0x1F )
          {
            v179 = v16;
            v113 = a4 - v18;
            v16 = v8;
            v114 = a4 - v18;
            v192 = a3 + 8LL * v18;
            v170 = v18;
            do
            {
              v117 = v114 & 0x1F | 0x20;
              v118 = v117 << v111;
              v111 += 6;
              v110 |= v118;
              *(_DWORD *)(v16 + 52) = v110;
              if ( v111 > 0x1F )
              {
                v119 = *(_QWORD **)(v16 + 24);
                v120 = v119[1];
                if ( (unsigned __int64)(v120 + 4) > v119[2] )
                {
                  sub_C8D290(*(_QWORD *)(v16 + 24), v119 + 3, v120 + 4, 1u, a5, a6);
                  v120 = v119[1];
                  v117 = v114 & 0x1F | 0x20;
                }
                *(_DWORD *)(*v119 + v120) = v110;
                v110 = 0;
                v119[1] += 4LL;
                v115 = *(_DWORD *)(v16 + 48);
                v116 = v117 >> (32 - v115);
                if ( v115 )
                  v110 = v116;
                v111 = ((_BYTE)v115 + 6) & 0x1F;
                *(_DWORD *)(v16 + 52) = v110;
              }
              v114 >>= 5;
              *(_DWORD *)(v16 + 48) = v111;
            }
            while ( v114 > 0x1F );
            a5 = v114;
            a6 = v192;
            v8 = v16;
            v112 = v113;
            v18 = v170;
            LODWORD(v16) = v179;
          }
          v121 = (_DWORD)a5 << v111;
          v122 = v111 + 6;
          v123 = v121 | v110;
          *(_DWORD *)(v8 + 52) = v123;
          if ( v122 > 0x1F )
          {
            v124 = *(_QWORD **)(v8 + 24);
            v125 = v124[1];
            if ( (unsigned __int64)(v125 + 4) > v124[2] )
            {
              v194 = v112;
              v172 = a5;
              v181 = a6;
              v205 = *(_QWORD *)(v8 + 24);
              sub_C8D290(v205, v124 + 3, v125 + 4, 1u, a5, a6);
              v124 = (_QWORD *)v205;
              LODWORD(a5) = v172;
              a6 = v181;
              v112 = v194;
              v125 = *(_QWORD *)(v205 + 8);
            }
            *(_DWORD *)(*v124 + v125) = v123;
            v124[1] += 4LL;
            v126 = *(_DWORD *)(v8 + 48);
            a5 = (unsigned int)a5 >> (32 - v126);
            if ( !v126 )
              a5 = 0;
            v122 = ((_BYTE)v126 + 6) & 0x1F;
            *(_DWORD *)(v8 + 52) = a5;
          }
          *(_DWORD *)(v8 + 48) = v122;
          if ( v122 )
          {
            v156 = *(_QWORD **)(v8 + 24);
            v157 = *(_DWORD *)(v8 + 52);
            v158 = v156[1];
            if ( (unsigned __int64)(v158 + 4) > v156[2] )
            {
              v202 = v112;
              v187 = a6;
              v207 = *(_QWORD *)(v8 + 24);
              sub_C8D290(v207, v156 + 3, v158 + 4, 1u, a5, a6);
              v156 = (_QWORD *)v207;
              a6 = v187;
              v112 = v202;
              v158 = *(_QWORD *)(v207 + 8);
            }
            *(_DWORD *)(*v156 + v158) = v157;
            v156[1] += 4LL;
            *(_QWORD *)(v8 + 48) = 0;
          }
          v127 = *(_QWORD **)(v8 + 24);
          v128 = 8 * v112;
          v129 = v127[1];
          v130 = v128 >> 3;
          v131 = (v128 >> 3) + v129;
          if ( v131 > v127[2] )
          {
            v198 = a6;
            v184 = v128;
            v206 = *(_QWORD **)(v8 + 24);
            sub_C8D290((__int64)v127, v127 + 3, v131, 1u, a5, a6);
            v127 = v206;
            v128 = v184;
            a6 = v198;
            v129 = v206[1];
          }
          v132 = (_QWORD *)(v129 + *v127);
          if ( v128 > 0 )
          {
            v133 = 0;
            do
            {
              *((_BYTE *)v132 + v133) = *(_QWORD *)(a6 + 8 * v133);
              ++v133;
            }
            while ( v130 - v133 > 0 );
            v129 = v127[1];
          }
          v127[1] = v129 + v130;
          while ( 1 )
          {
            v134 = *(_BYTE **)(v8 + 32);
            v135 = *(_QWORD *)(*(_QWORD *)(v8 + 24) + 8LL);
            if ( v134 && sub_CB7440(*(_QWORD *)(v8 + 32)) )
            {
              if ( !sub_CB7440((__int64)v134) )
                BUG();
              a5 = (*(__int64 (__fastcall **)(_BYTE *, _QWORD *))(*(_QWORD *)v134 + 80LL))(v134, v132);
              LOBYTE(v135) = a5 + v134[32] - v134[16] + v135;
            }
            if ( (v135 & 3) == 0 )
              break;
            v136 = *(_QWORD **)(v8 + 24);
            v137 = v136[1];
            if ( (unsigned __int64)(v137 + 1) > v136[2] )
            {
              v132 = v136 + 3;
              sub_C8D290(*(_QWORD *)(v8 + 24), v136 + 3, v137 + 1, 1u, a5, a6);
              v137 = v136[1];
            }
            *(_BYTE *)(*v136 + v137) = 0;
            ++v136[1];
          }
        }
LABEL_11:
        LODWORD(v16) = v16 + 1;
        if ( v216 == (_DWORD)v16 )
          return;
      }
      else
      {
        v33 = *(_QWORD *)(a3 + 8LL * v18);
        switch ( v19 )
        {
          case 2:
            if ( *(_QWORD *)v20 )
            {
              v83 = *(_QWORD *)(a3 + 8LL * v18++);
              sub_A17DE0(v8, v83, *(_QWORD *)v20);
              goto LABEL_14;
            }
            break;
          case 4:
            if ( (unsigned __int8)(v33 - 97) <= 0x19u )
            {
              v34 = (char)v33 - 97;
            }
            else if ( (unsigned __int8)(v33 - 65) <= 0x19u )
            {
              v34 = (char)v33 - 39;
            }
            else if ( (unsigned __int8)(v33 - 48) <= 9u )
            {
              v34 = (char)v33 + 4;
            }
            else if ( (_BYTE)v33 == 46 )
            {
              v34 = 62;
            }
            else
            {
              if ( (_BYTE)v33 != 95 )
                goto LABEL_217;
              v34 = 63;
            }
            v35 = *(_DWORD *)(v8 + 48);
            v36 = v34 << v35;
            v37 = v35 + 6;
            v38 = *(_DWORD *)(v8 + 52) | v36;
            *(_DWORD *)(v8 + 52) = v38;
            if ( v37 > 0x1F )
            {
              v39 = *(_QWORD **)(v8 + 24);
              v40 = v39[1];
              a5 = v40 + 4;
              if ( (unsigned __int64)(v40 + 4) > v39[2] )
              {
                v199 = v38;
                sub_C8D290((__int64)v39, v39 + 3, v40 + 4, 1u, a5, a6);
                v38 = v199;
                v40 = v39[1];
              }
              *(_DWORD *)(*v39 + v40) = v38;
              v39[1] += 4LL;
              v41 = *(_DWORD *)(v8 + 48);
              v42 = v34 >> (32 - v41);
              if ( !v41 )
                v42 = 0;
              ++v18;
              *(_DWORD *)(v8 + 52) = v42;
              *(_DWORD *)(v8 + 48) = ((_BYTE)v41 + 6) & 0x1F;
              goto LABEL_14;
            }
LABEL_188:
            *(_DWORD *)(v8 + 48) = v37;
            ++v18;
            goto LABEL_14;
          case 1:
            v43 = *(_QWORD *)v20;
            if ( v43 )
            {
              v44 = *(_DWORD *)(v8 + 48);
              v45 = (_DWORD)v33 << v44;
              v37 = v43 + v44;
              a5 = *(_DWORD *)(v8 + 52) | v45;
              *(_DWORD *)(v8 + 52) = a5;
              if ( v37 <= 0x1F )
                goto LABEL_188;
              v46 = *(_QWORD **)(v8 + 24);
              v47 = v46[1];
              if ( (unsigned __int64)(v47 + 4) > v46[2] )
              {
                v186 = a5;
                v201 = v43;
                sub_C8D290((__int64)v46, v46 + 3, v47 + 4, 1u, a5, a6);
                a5 = v186;
                LOBYTE(v43) = v201;
                v47 = v46[1];
              }
              *(_DWORD *)(*v46 + v47) = a5;
              v46[1] += 4LL;
              v48 = *(_DWORD *)(v8 + 48);
              v49 = (unsigned int)v33 >> (32 - v48);
              v50 = 0;
              if ( v48 )
                v50 = v49;
              *(_DWORD *)(v8 + 52) = v50;
              *(_DWORD *)(v8 + 48) = ((_BYTE)v48 + (_BYTE)v43) & 0x1F;
            }
            break;
          default:
            goto LABEL_218;
        }
LABEL_13:
        ++v18;
LABEL_14:
        LODWORD(v16) = v16 + 1;
        if ( v216 == (_DWORD)v16 )
          return;
      }
    }
    v22 = *(_DWORD *)(v8 + 52);
    v16 = (unsigned int)(v16 + 1);
    v23 = *v215 + 16 * v16;
    v24 = *(_DWORD *)(v8 + 48);
    if ( v213 )
    {
      if ( v211 <= 0x1F )
      {
        a6 = v211;
      }
      else
      {
        v203 = *v215 + 16 * v16;
        v25 = v8;
        v26 = v211;
        v188 = v16;
        v27 = v22;
        v176 = v18;
        do
        {
          v30 = (v26 & 0x1F | 0x20) << v24;
          v24 += 6;
          v27 |= v30;
          *(_DWORD *)(v25 + 52) = v27;
          if ( v24 > 0x1F )
          {
            v31 = *(_QWORD **)(v25 + 24);
            v32 = v31[1];
            if ( (unsigned __int64)(v32 + 4) > v31[2] )
            {
              sub_C8D290(*(_QWORD *)(v25 + 24), v31 + 3, v32 + 4, 1u, a5, v32 + 4);
              v32 = v31[1];
            }
            v28 = 0;
            *(_DWORD *)(*v31 + v32) = v27;
            v31[1] += 4LL;
            v29 = *(_DWORD *)(v25 + 48);
            if ( v29 )
              v28 = (v26 & 0x1F | 0x20) >> (32 - v29);
            v24 = ((_BYTE)v29 + 6) & 0x1F;
            *(_DWORD *)(v25 + 52) = v28;
            v27 = v28;
          }
          v26 >>= 5;
          *(_DWORD *)(v25 + 48) = v24;
        }
        while ( v26 > 0x1F );
        a6 = v26;
        v22 = v27;
        v8 = v25;
        v18 = v176;
        LODWORD(v16) = v188;
        v23 = v203;
      }
      v51 = (_DWORD)a6 << v24;
      v52 = v24 + 6;
      v53 = v51 | v22;
      *(_DWORD *)(v8 + 52) = v53;
      if ( v52 > 0x1F )
      {
        v76 = *(_QWORD **)(v8 + 24);
        v77 = v76[1];
        if ( (unsigned __int64)(v77 + 4) > v76[2] )
        {
          v183 = v53;
          v196 = a6;
          sub_C8D290((__int64)v76, v76 + 3, v77 + 4, 1u, a5, a6);
          v53 = v183;
          LODWORD(a6) = v196;
          v77 = v76[1];
        }
        *(_DWORD *)(*v76 + v77) = v53;
        v76[1] += 4LL;
        v78 = *(_DWORD *)(v8 + 48);
        a6 = (unsigned int)a6 >> (32 - v78);
        if ( !v78 )
          a6 = 0;
        *(_DWORD *)(v8 + 48) = ((_BYTE)v78 + 6) & 0x1F;
        *(_DWORD *)(v8 + 52) = a6;
        if ( v211 )
          goto LABEL_51;
      }
      else
      {
        *(_DWORD *)(v8 + 48) = v52;
        if ( v211 )
        {
LABEL_51:
          v54 = (unsigned __int8 *)v213;
          v214 = v16;
          a6 = (__int64)&v54[(unsigned int)v209];
          v55 = v54;
          v56 = (unsigned __int8 *)a6;
          while ( 1 )
          {
            v65 = *v55;
            v66 = (*(_BYTE *)(v23 + 8) >> 1) & 7;
            if ( v66 == 2 )
            {
              if ( *(_QWORD *)v23 )
                sub_A17DE0(v8, v65, *(_QWORD *)v23);
              goto LABEL_64;
            }
            if ( v66 == 4 )
              break;
            if ( v66 != 1 )
              goto LABEL_218;
            a5 = *(_QWORD *)v23;
            if ( *(_QWORD *)v23 )
            {
              v67 = *(_DWORD *)(v8 + 48);
              v68 = (unsigned __int8)v65;
              v69 = (unsigned __int8)v65 << v67;
              v60 = a5 + v67;
              v70 = *(_DWORD *)(v8 + 52) | v69;
              *(_DWORD *)(v8 + 52) = v70;
              if ( v60 <= 0x1F )
                goto LABEL_85;
              v71 = *(_QWORD **)(v8 + 24);
              v72 = v71[1];
              if ( (unsigned __int64)(v72 + 4) > v71[2] )
              {
                v197 = a5;
                v174 = v70;
                sub_C8D290((__int64)v71, v71 + 3, v72 + 4, 1u, a5, a6);
                v70 = v174;
                v68 = (unsigned __int8)v65;
                a5 = v197;
                v72 = v71[1];
              }
              *(_DWORD *)(*v71 + v72) = v70;
              v71[1] += 4LL;
              v73 = *(_DWORD *)(v8 + 48);
              v74 = v68 >> (32 - v73);
              v75 = 0;
              if ( v73 )
                v75 = v74;
              ++v55;
              *(_DWORD *)(v8 + 52) = v75;
              *(_DWORD *)(v8 + 48) = ((_BYTE)a5 + (_BYTE)v73) & 0x1F;
              if ( v55 == v56 )
              {
LABEL_75:
                LODWORD(v16) = v214;
                v213 = 0;
                goto LABEL_11;
              }
            }
            else
            {
LABEL_64:
              if ( ++v55 == v56 )
                goto LABEL_75;
            }
          }
          if ( (unsigned __int8)(v65 - 97) <= 0x19u )
          {
            v57 = (char)v65 - 97;
          }
          else if ( (unsigned __int8)(v65 - 65) <= 0x19u )
          {
            v57 = (char)v65 - 39;
          }
          else
          {
            v57 = (char)v65 + 4;
            if ( (unsigned __int8)(v65 - 48) > 9u )
            {
              if ( (_BYTE)v65 == 46 )
              {
                v57 = 62;
              }
              else
              {
                if ( (_BYTE)v65 != 95 )
                  goto LABEL_217;
                v57 = 63;
              }
            }
          }
          v58 = *(_DWORD *)(v8 + 48);
          v59 = v57 << v58;
          v60 = v58 + 6;
          a5 = *(_DWORD *)(v8 + 52) | v59;
          *(_DWORD *)(v8 + 52) = a5;
          if ( v60 > 0x1F )
          {
            v61 = *(_QWORD **)(v8 + 24);
            v62 = v61[1];
            if ( (unsigned __int64)(v62 + 4) > v61[2] )
            {
              v189 = a5;
              v177 = v57;
              sub_C8D290((__int64)v61, v61 + 3, v62 + 4, 1u, a5, a6);
              v57 = v177;
              a5 = v189;
              v62 = v61[1];
            }
            *(_DWORD *)(*v61 + v62) = a5;
            v61[1] += 4LL;
            v63 = *(_DWORD *)(v8 + 48);
            v64 = v57 >> (32 - v63);
            if ( !v63 )
              v64 = 0;
            *(_DWORD *)(v8 + 52) = v64;
            *(_DWORD *)(v8 + 48) = ((_BYTE)v63 + 6) & 0x1F;
            goto LABEL_64;
          }
LABEL_85:
          *(_DWORD *)(v8 + 48) = v60;
          goto LABEL_64;
        }
      }
      v213 = 0;
      goto LABEL_11;
    }
    v84 = a4;
    a6 = (unsigned int)a4 - v18;
    if ( (unsigned int)a6 > 0x1F )
    {
      v190 = *v215 + 16 * v16;
      v85 = v8;
      v86 = *(_DWORD *)(v8 + 52);
      v178 = v16;
      v87 = a4 - v18;
      v169 = v18;
      do
      {
        a5 = v87 & 0x1F | 0x20;
        v89 = (v87 & 0x1F | 0x20) << v24;
        v24 += 6;
        v86 |= v89;
        *(_DWORD *)(v85 + 52) = v86;
        if ( v24 > 0x1F )
        {
          v90 = *(_QWORD **)(v85 + 24);
          v91 = v90[1];
          if ( (unsigned __int64)(v91 + 4) > v90[2] )
          {
            sub_C8D290(*(_QWORD *)(v85 + 24), v90 + 3, v91 + 4, 1u, a5, a6);
            v91 = v90[1];
            LODWORD(a5) = v87 & 0x1F | 0x20;
          }
          *(_DWORD *)(*v90 + v91) = v86;
          v86 = 0;
          v90[1] += 4LL;
          v88 = *(_DWORD *)(v85 + 48);
          a5 = (unsigned int)a5 >> (32 - v88);
          if ( v88 )
            v86 = a5;
          v24 = ((_BYTE)v88 + 6) & 0x1F;
          *(_DWORD *)(v85 + 52) = v86;
        }
        v87 >>= 5;
        *(_DWORD *)(v85 + 48) = v24;
      }
      while ( v87 > 0x1F );
      v22 = v86;
      a6 = v87;
      v8 = v85;
      v18 = v169;
      LODWORD(v16) = v178;
      v23 = v190;
      v84 = a4;
    }
    v92 = (_DWORD)a6 << v24;
    v93 = v24 + 6;
    v94 = v92 | v22;
    *(_DWORD *)(v8 + 52) = v94;
    if ( v93 > 0x1F )
    {
      v138 = *(_QWORD **)(v8 + 24);
      v139 = v138[1];
      if ( (unsigned __int64)(v139 + 4) > v138[2] )
      {
        v193 = v84;
        v171 = v94;
        v180 = a6;
        sub_C8D290((__int64)v138, v138 + 3, v139 + 4, 1u, a5, a6);
        v94 = v171;
        LODWORD(a6) = v180;
        v84 = v193;
        v139 = v138[1];
      }
      *(_DWORD *)(*v138 + v139) = v94;
      v138[1] += 4LL;
      v140 = *(_DWORD *)(v8 + 48);
      a6 = (unsigned int)a6 >> (32 - v140);
      if ( !v140 )
        a6 = 0;
      *(_DWORD *)(v8 + 52) = a6;
      *(_DWORD *)(v8 + 48) = ((_BYTE)v140 + 6) & 0x1F;
    }
    else
    {
      *(_DWORD *)(v8 + 48) = v93;
    }
    if ( (_DWORD)a4 == v18 )
      goto LABEL_11;
    v204 = v16;
    a5 = a3;
    v95 = v84;
    while ( 1 )
    {
      while ( 1 )
      {
        v105 = *(_QWORD *)(a5 + 8LL * v18);
        v106 = (*(_BYTE *)(v23 + 8) >> 1) & 7;
        if ( v106 == 2 )
        {
          if ( *(_QWORD *)v23 )
          {
            v191 = a5;
            sub_A17DE0(v8, *(_QWORD *)(a5 + 8LL * v18), *(_QWORD *)v23);
            a5 = v191;
          }
          goto LABEL_121;
        }
        if ( v106 != 4 )
          break;
        if ( (unsigned __int8)(v105 - 97) <= 0x19u )
        {
          v96 = (char)v105 - 97;
        }
        else if ( (unsigned __int8)(v105 - 65) <= 0x19u )
        {
          v96 = (char)v105 - 39;
        }
        else if ( (unsigned __int8)(v105 - 48) <= 9u )
        {
          v96 = (char)v105 + 4;
        }
        else if ( (_BYTE)v105 == 46 )
        {
          v96 = 62;
        }
        else
        {
          if ( (_BYTE)v105 != 95 )
            goto LABEL_217;
          v96 = 63;
        }
        v97 = *(_DWORD *)(v8 + 48);
        v98 = v96 << v97;
        v99 = v97 + 6;
        v100 = *(_DWORD *)(v8 + 52) | v98;
        *(_DWORD *)(v8 + 52) = v100;
        if ( v99 <= 0x1F )
          goto LABEL_127;
        v101 = *(_QWORD **)(v8 + 24);
        v102 = v101[1];
        a6 = v102 + 4;
        if ( (unsigned __int64)(v102 + 4) > v101[2] )
        {
          v195 = *(_QWORD **)(v8 + 24);
          v173 = a5;
          v182 = v100;
          sub_C8D290((__int64)v101, v101 + 3, v102 + 4, 1u, a5, a6);
          v101 = v195;
          a5 = v173;
          v100 = v182;
          v102 = v195[1];
        }
        *(_DWORD *)(*v101 + v102) = v100;
        v101[1] += 4LL;
        v103 = *(_DWORD *)(v8 + 48);
        v104 = v96 >> (32 - v103);
        if ( !v103 )
          v104 = 0;
        *(_DWORD *)(v8 + 52) = v104;
        *(_DWORD *)(v8 + 48) = ((_BYTE)v103 + 6) & 0x1F;
LABEL_121:
        if ( v95 == ++v18 )
          goto LABEL_128;
      }
      if ( v106 != 1 )
        goto LABEL_218;
      v107 = *(_QWORD *)v23;
      if ( !*(_QWORD *)v23 )
        goto LABEL_121;
      v108 = *(_DWORD *)(v8 + 48);
      v109 = (_DWORD)v105 << v108;
      v99 = v107 + v108;
      a6 = *(_DWORD *)(v8 + 52) | v109;
      *(_DWORD *)(v8 + 52) = a6;
      if ( v99 > 0x1F )
      {
        v141 = *(_QWORD **)(v8 + 24);
        v142 = v141[1];
        if ( (unsigned __int64)(v142 + 4) > v141[2] )
        {
          v200 = *(_QWORD **)(v8 + 24);
          v168 = a5;
          v175 = a6;
          v185 = v107;
          sub_C8D290((__int64)v141, v141 + 3, v142 + 4, 1u, a5, a6);
          v141 = v200;
          a5 = v168;
          a6 = v175;
          LOBYTE(v107) = v185;
          v142 = v200[1];
        }
        *(_DWORD *)(*v141 + v142) = a6;
        v141[1] += 4LL;
        v143 = *(_DWORD *)(v8 + 48);
        v144 = (unsigned int)v105 >> (32 - v143);
        if ( !v143 )
          v144 = 0;
        *(_DWORD *)(v8 + 52) = v144;
        *(_DWORD *)(v8 + 48) = ((_BYTE)v143 + (_BYTE)v107) & 0x1F;
        goto LABEL_121;
      }
LABEL_127:
      ++v18;
      *(_DWORD *)(v8 + 48) = v99;
      if ( v95 == v18 )
      {
LABEL_128:
        LODWORD(v16) = v204;
        goto LABEL_11;
      }
    }
  }
}

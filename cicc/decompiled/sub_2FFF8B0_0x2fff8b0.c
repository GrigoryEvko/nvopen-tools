// Function: sub_2FFF8B0
// Address: 0x2fff8b0
//
void __fastcall sub_2FFF8B0(__int64 a1, __int64 a2, __int64 a3, int *a4)
{
  unsigned int *v5; // rcx
  __int64 v6; // r13
  __int64 v7; // rdx
  __int64 v8; // rax
  __int64 v9; // rdx
  unsigned int *v10; // rax
  unsigned int *v11; // rdx
  unsigned __int64 v12; // rbx
  __int64 i; // rax
  _DWORD *v14; // rax
  unsigned __int8 *v15; // rsi
  __int64 v16; // rax
  __int64 v17; // r14
  __int64 v18; // r15
  bool v19; // zf
  _QWORD *v20; // r13
  __int64 v21; // r14
  __int64 v22; // rdx
  unsigned __int64 v23; // rax
  unsigned __int64 v24; // rdx
  __int64 v25; // r13
  __int64 j; // r13
  int v27; // r14d
  unsigned int v28; // esi
  __int64 v29; // r8
  unsigned __int64 *v30; // rdx
  int v31; // r11d
  unsigned int v32; // edi
  _QWORD *v33; // rax
  unsigned __int64 v34; // rcx
  int *v35; // rax
  __int64 v36; // rax
  unsigned __int64 v37; // rax
  __int64 v38; // r15
  unsigned __int64 v39; // rcx
  __int64 v40; // rdi
  unsigned __int64 k; // rax
  __int64 m; // rsi
  __int16 v43; // dx
  __int64 v44; // rsi
  __int64 v45; // r8
  unsigned int v46; // ecx
  __int64 *v47; // rdx
  __int64 v48; // r10
  __int64 v49; // rdx
  __int64 v50; // rcx
  __int16 *v51; // rbx
  unsigned int v52; // r13d
  __int64 v53; // rsi
  __int64 v54; // r14
  __int64 *v55; // rsi
  int v56; // r15d
  __int64 v57; // rax
  __int64 v58; // r8
  __int64 v59; // r9
  __int64 v60; // rdx
  int v61; // edx
  __int64 v62; // r13
  int v63; // eax
  int v64; // eax
  __int64 v65; // rdx
  __int64 v66; // rax
  unsigned int v67; // eax
  unsigned __int64 v68; // rdx
  __int64 v69; // rsi
  __int64 v70; // r13
  __int64 v71; // rdx
  int v72; // r14d
  unsigned __int64 v73; // rax
  unsigned __int64 v74; // r15
  __int64 v75; // rdx
  __int64 v76; // r9
  __int64 v77; // r14
  __int64 v78; // r15
  int v79; // ebx
  __int64 *v80; // rsi
  __int64 v81; // rax
  __int64 v82; // r9
  __int64 v83; // rdx
  __int64 v84; // r8
  __int64 v85; // rcx
  int v86; // edx
  unsigned int v87; // eax
  __int64 v88; // rsi
  __int64 v89; // rax
  int v90; // ecx
  int v91; // ecx
  __int64 v92; // r8
  __int64 v93; // rsi
  unsigned __int64 v94; // rdi
  int v95; // r11d
  unsigned __int64 *v96; // r10
  unsigned __int64 v97; // r9
  int v98; // r10d
  int v99; // r10d
  __int64 v100; // r8
  unsigned __int64 *v101; // rdi
  int v102; // r11d
  __int64 v103; // rcx
  unsigned __int64 v104; // rsi
  __int64 v105; // rbx
  __int64 v106; // r13
  __int64 v107; // rbx
  __int64 v108; // r12
  __int64 v109; // rbx
  _BYTE *v110; // r15
  __int64 v111; // rdx
  __int64 v112; // rcx
  __int64 v113; // r8
  __int64 v114; // r9
  _BYTE *v115; // r14
  __int64 v116; // rbx
  char v117; // al
  _BYTE *v118; // r13
  __m128i *v119; // rdi
  unsigned __int64 v120; // rax
  _BYTE *v121; // rsi
  __int64 v122; // r8
  unsigned __int64 v123; // rbx
  __int64 v124; // rax
  unsigned __int64 v125; // rax
  __int64 v126; // r13
  __int64 v127; // rdx
  __int64 v128; // rcx
  __int64 v129; // r8
  __int64 v130; // r9
  unsigned __int64 v131; // rax
  _BYTE *v132; // rsi
  __int64 v133; // r12
  __int64 v134; // rsi
  __int64 v135; // rdi
  unsigned __int64 v136; // rax
  __int64 n; // rsi
  __int16 v138; // dx
  unsigned int v139; // esi
  __int64 v140; // r8
  unsigned int v141; // ecx
  __int64 *v142; // rdx
  __int64 v143; // r10
  __int64 v144; // r15
  unsigned __int64 v145; // rax
  unsigned int v146; // edx
  __int64 v147; // r15
  __int64 v148; // r12
  __int64 v149; // rbx
  __int64 *v150; // rcx
  __int64 *v151; // rcx
  __int64 v152; // rax
  unsigned __int64 v153; // r13
  _QWORD *v154; // rcx
  _QWORD *v155; // rdi
  unsigned int v156; // edx
  __int64 v157; // rdx
  __int64 *v158; // rbx
  __int64 v159; // rax
  unsigned int *v160; // rbx
  int v161; // r9d
  int v162; // edx
  __int64 v163; // r14
  unsigned __int64 v164; // r13
  _QWORD *v165; // rcx
  _QWORD *v166; // rsi
  __int128 v167; // [rsp-20h] [rbp-140h]
  __int128 v168; // [rsp-20h] [rbp-140h]
  __int128 v169; // [rsp-20h] [rbp-140h]
  __int64 v170; // [rsp+8h] [rbp-118h]
  unsigned int *v172; // [rsp+18h] [rbp-108h]
  char v173; // [rsp+2Bh] [rbp-F5h]
  unsigned int v174; // [rsp+2Ch] [rbp-F4h]
  char v176; // [rsp+3Bh] [rbp-E5h]
  int v177; // [rsp+3Ch] [rbp-E4h]
  unsigned __int64 v178; // [rsp+40h] [rbp-E0h]
  unsigned __int64 v179; // [rsp+48h] [rbp-D8h]
  __int64 v180; // [rsp+48h] [rbp-D8h]
  unsigned __int64 v181; // [rsp+48h] [rbp-D8h]
  __int64 v182; // [rsp+48h] [rbp-D8h]
  unsigned int *v183; // [rsp+50h] [rbp-D0h]
  __int64 v184; // [rsp+58h] [rbp-C8h]
  __int64 v185; // [rsp+58h] [rbp-C8h]
  unsigned __int64 v186; // [rsp+60h] [rbp-C0h]
  unsigned __int64 v187; // [rsp+60h] [rbp-C0h]
  char v188; // [rsp+60h] [rbp-C0h]
  int v189; // [rsp+68h] [rbp-B8h]
  __int64 v190; // [rsp+68h] [rbp-B8h]
  signed __int64 v191; // [rsp+70h] [rbp-B0h]
  unsigned int *v192; // [rsp+78h] [rbp-A8h]
  char v193; // [rsp+78h] [rbp-A8h]
  __int128 v194; // [rsp+80h] [rbp-A0h]
  int v195; // [rsp+88h] [rbp-98h]
  int v196; // [rsp+94h] [rbp-8Ch] BYREF
  unsigned __int8 *v197; // [rsp+98h] [rbp-88h] BYREF
  unsigned __int8 *v198; // [rsp+A0h] [rbp-80h] BYREF
  __int64 v199; // [rsp+A8h] [rbp-78h] BYREF
  __int64 v200; // [rsp+B0h] [rbp-70h]
  __m128i v201; // [rsp+C0h] [rbp-60h] BYREF
  unsigned __int64 v202; // [rsp+D0h] [rbp-50h]
  __int64 v203; // [rsp+D8h] [rbp-48h]
  __int64 v204; // [rsp+E0h] [rbp-40h]

  v5 = *(unsigned int **)a3;
  v6 = *(_QWORD *)(a2 + 32);
  v7 = 8LL * *(unsigned int *)(a3 + 8);
  v183 = &v5[(unsigned __int64)v7 / 4];
  v8 = v7 >> 3;
  v9 = v7 >> 5;
  if ( v9 )
  {
    v10 = v5;
    v11 = &v5[8 * v9];
    do
    {
      if ( (*(_BYTE *)(v6 + 40LL * v10[1] + 4) & 4) != 0 )
      {
        v172 = v10;
        goto LABEL_9;
      }
      if ( (*(_BYTE *)(v6 + 40LL * v10[3] + 4) & 4) != 0 )
      {
        v172 = v10 + 2;
        goto LABEL_9;
      }
      if ( (*(_BYTE *)(v6 + 40LL * v10[5] + 4) & 4) != 0 )
      {
        v172 = v10 + 4;
        goto LABEL_9;
      }
      if ( (*(_BYTE *)(v6 + 40LL * v10[7] + 4) & 4) != 0 )
      {
        v172 = v10 + 6;
        goto LABEL_9;
      }
      v10 += 8;
    }
    while ( v11 != v10 );
    v172 = v10;
    v8 = ((char *)v183 - (char *)v10) >> 3;
  }
  else
  {
    v172 = v5;
  }
  if ( v8 != 2 )
  {
    if ( v8 != 3 )
    {
      if ( v8 != 1 )
      {
        v172 = v183;
        goto LABEL_9;
      }
      goto LABEL_238;
    }
    if ( (*(_BYTE *)(v6 + 40LL * v172[1] + 4) & 4) != 0 )
      goto LABEL_9;
    v172 += 2;
  }
  if ( (*(_BYTE *)(v6 + 40LL * v172[1] + 4) & 4) != 0 )
    goto LABEL_9;
  v172 += 2;
LABEL_238:
  v160 = v172;
  if ( (*(_BYTE *)(v6 + 40LL * v172[1] + 4) & 4) == 0 )
    v160 = v183;
  v172 = v160;
LABEL_9:
  v196 = 0;
  if ( v5 != v183 )
  {
    v12 = a2;
    v192 = v5;
    v191 = 0;
    v173 = 1;
    v176 = 0;
    v174 = ((unsigned int)a2 >> 9) ^ ((unsigned int)a2 >> 4);
    for ( i = v6; ; i = *(_QWORD *)(v12 + 32) )
    {
      v195 = *(_DWORD *)(i + 40LL * v192[1] + 8);
      v14 = (_DWORD *)(40LL * *v192 + i);
      v184 = 40LL * *v192;
      v189 = v14[2];
      v177 = (*v14 >> 8) & 0xFFF;
      if ( v195 == v189 )
      {
        v173 = 0;
        goto LABEL_66;
      }
      v15 = *(unsigned __int8 **)(v12 + 56);
      v196 = v195;
      v16 = *(_QWORD *)(a1 + 8);
      v197 = v15;
      v17 = *(_QWORD *)(v16 + 8) - 800LL;
      if ( v15 )
      {
        sub_B96E90((__int64)&v197, (__int64)v15, 1);
        v198 = v197;
        if ( v197 )
        {
          sub_B976B0((__int64)&v197, v197, (__int64)&v198);
          v18 = *(_QWORD *)(v12 + 24);
          v199 = 0;
          v19 = (*(_BYTE *)(v12 + 44) & 4) == 0;
          v200 = 0;
          v197 = 0;
          v20 = *(_QWORD **)(v18 + 32);
          v201.m128i_i64[0] = (__int64)v198;
          if ( !v19 )
          {
            if ( v198 )
              sub_B96E90((__int64)&v201, (__int64)v198, 1);
LABEL_17:
            v21 = (__int64)sub_2E7B380(v20, v17, (unsigned __int8 **)&v201, 0);
            if ( v201.m128i_i64[0] )
              sub_B91220((__int64)&v201, v201.m128i_i64[0]);
            sub_2E326B0(v18, (__int64 *)v12, v21);
            v22 = v199;
            if ( v199 )
              goto LABEL_20;
            goto LABEL_21;
          }
          if ( v198 )
            sub_B96E90((__int64)&v201, (__int64)v198, 1);
          goto LABEL_90;
        }
      }
      else
      {
        v198 = 0;
      }
      v18 = *(_QWORD *)(v12 + 24);
      v199 = 0;
      v200 = 0;
      v20 = *(_QWORD **)(v18 + 32);
      if ( (*(_BYTE *)(v12 + 44) & 4) != 0 )
      {
        v201.m128i_i64[0] = 0;
        goto LABEL_17;
      }
      v201.m128i_i64[0] = 0;
LABEL_90:
      v21 = (__int64)sub_2E7B380(v20, v17, (unsigned __int8 **)&v201, 0);
      if ( v201.m128i_i64[0] )
        sub_B91220((__int64)&v201, v201.m128i_i64[0]);
      sub_2E31040((__int64 *)(v18 + 40), v21);
      v65 = *(_QWORD *)v12;
      v66 = *(_QWORD *)v21;
      *(_QWORD *)(v21 + 8) = v12;
      v65 &= 0xFFFFFFFFFFFFFFF8LL;
      *(_QWORD *)v21 = v65 | v66 & 7;
      *(_QWORD *)(v65 + 8) = v21;
      v22 = v199;
      *(_QWORD *)v12 = v21 | *(_QWORD *)v12 & 7LL;
      if ( v22 )
LABEL_20:
        sub_2E882B0(v21, (__int64)v20, v22);
LABEL_21:
      if ( v200 )
        sub_2E88680(v21, (__int64)v20, v200);
      v201.m128i_i64[0] = 0x10000000;
      v202 = 0;
      v201.m128i_i32[2] = v195;
      v203 = 0;
      v204 = 0;
      sub_2E8EAD0(v21, (__int64)v20, &v201);
      if ( v198 )
        sub_B91220((__int64)&v198, (__int64)v198);
      if ( v197 )
        sub_B91220((__int64)&v197, (__int64)v197);
      v201.m128i_i32[2] = v189;
      v202 = 0;
      v201.m128i_i64[0] = (unsigned int)(v177 << 8);
      v203 = 0;
      v204 = 0;
      sub_2E8EAD0(v21, (__int64)v20, &v201);
      v178 = *(_QWORD *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 56LL) + 16LL * (v189 & 0x7FFFFFFF)) & 0xFFFFFFFFFFFFFFF8LL;
      if ( v177 )
      {
        v23 = 0;
        if ( v195 >= 0 )
          v23 = *(_QWORD *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 56LL) + 16LL * (v189 & 0x7FFFFFFF))
              & 0xFFFFFFFFFFFFFFF8LL;
        v178 = v23;
      }
      v24 = *(_QWORD *)v12 & 0xFFFFFFFFFFFFFFF8LL;
      if ( !v24 )
        BUG();
      v25 = *(_QWORD *)v12 & 0xFFFFFFFFFFFFFFF8LL;
      if ( (*(_QWORD *)v24 & 4) == 0 && (*(_BYTE *)(v24 + 44) & 4) != 0 )
      {
        for ( j = *(_QWORD *)v24; ; j = *(_QWORD *)v25 )
        {
          v25 = j & 0xFFFFFFFFFFFFFFF8LL;
          if ( (*(_BYTE *)(v25 + 44) & 4) == 0 )
            break;
        }
      }
      v198 = (unsigned __int8 *)v25;
      LODWORD(v199) = *a4;
      sub_2FFCC20((__int64)&v201, a1 + 80, (__int64 *)&v198, &v199);
      v27 = *a4 + 1;
      *a4 = v27;
      v28 = *(_DWORD *)(a1 + 104);
      if ( v28 )
      {
        v29 = *(_QWORD *)(a1 + 88);
        v30 = 0;
        v31 = 1;
        v32 = (v28 - 1) & v174;
        v33 = (_QWORD *)(v29 + 16LL * v32);
        v34 = *v33;
        if ( *v33 == v12 )
        {
LABEL_39:
          v35 = (int *)(v33 + 1);
          goto LABEL_40;
        }
        while ( v34 != -4096 )
        {
          if ( v34 == -8192 && !v30 )
            v30 = v33;
          v32 = (v28 - 1) & (v31 + v32);
          v33 = (_QWORD *)(v29 + 16LL * v32);
          v34 = *v33;
          if ( *v33 == v12 )
            goto LABEL_39;
          ++v31;
        }
        if ( !v30 )
          v30 = v33;
        v63 = *(_DWORD *)(a1 + 96);
        ++*(_QWORD *)(a1 + 80);
        v64 = v63 + 1;
        if ( 4 * v64 < 3 * v28 )
        {
          if ( v28 - *(_DWORD *)(a1 + 100) - v64 <= v28 >> 3 )
          {
            sub_2E261E0(a1 + 80, v28);
            v98 = *(_DWORD *)(a1 + 104);
            if ( !v98 )
            {
LABEL_275:
              ++*(_DWORD *)(a1 + 96);
              BUG();
            }
            v99 = v98 - 1;
            v100 = *(_QWORD *)(a1 + 88);
            v101 = 0;
            v102 = 1;
            v64 = *(_DWORD *)(a1 + 96) + 1;
            LODWORD(v103) = v99 & v174;
            v30 = (unsigned __int64 *)(v100 + 16LL * (v99 & v174));
            v104 = *v30;
            if ( *v30 != v12 )
            {
              while ( v104 != -4096 )
              {
                if ( v104 == -8192 && !v101 )
                  v101 = v30;
                v103 = v99 & (unsigned int)(v103 + v102);
                v30 = (unsigned __int64 *)(v100 + 16 * v103);
                v104 = *v30;
                if ( *v30 == v12 )
                  goto LABEL_78;
                ++v102;
              }
              if ( v101 )
                v30 = v101;
            }
          }
          goto LABEL_78;
        }
      }
      else
      {
        ++*(_QWORD *)(a1 + 80);
      }
      sub_2E261E0(a1 + 80, 2 * v28);
      v90 = *(_DWORD *)(a1 + 104);
      if ( !v90 )
        goto LABEL_275;
      v91 = v90 - 1;
      v92 = *(_QWORD *)(a1 + 88);
      LODWORD(v93) = v91 & v174;
      v64 = *(_DWORD *)(a1 + 96) + 1;
      v30 = (unsigned __int64 *)(v92 + 16LL * (v91 & v174));
      v94 = *v30;
      if ( *v30 != v12 )
      {
        v95 = 1;
        v96 = 0;
        while ( v94 != -4096 )
        {
          if ( v94 == -8192 && !v96 )
            v96 = v30;
          v93 = v91 & (unsigned int)(v93 + v95);
          v30 = (unsigned __int64 *)(v92 + 16 * v93);
          v94 = *v30;
          if ( *v30 == v12 )
            goto LABEL_78;
          ++v95;
        }
        if ( v96 )
          v30 = v96;
      }
LABEL_78:
      *(_DWORD *)(a1 + 96) = v64;
      if ( *v30 != -4096 )
        --*(_DWORD *)(a1 + 100);
      *v30 = v12;
      v35 = (int *)(v30 + 1);
      *((_DWORD *)v30 + 2) = 0;
LABEL_40:
      *v35 = v27;
      v36 = *(_QWORD *)(a1 + 48);
      if ( !v36 )
        goto LABEL_62;
      v37 = sub_2E192D0(*(_QWORD *)(v36 + 32), v25, 0);
      v38 = *(_QWORD *)(a1 + 48);
      v39 = v12;
      v40 = *(_QWORD *)(v38 + 32);
      v191 = v37 & 0xFFFFFFFFFFFFFFF8LL | 4;
      for ( k = v12; (*(_BYTE *)(k + 44) & 4) != 0; k = *(_QWORD *)k & 0xFFFFFFFFFFFFFFF8LL )
        ;
      if ( (*(_DWORD *)(v12 + 44) & 8) != 0 )
      {
        do
          v39 = *(_QWORD *)(v39 + 8);
        while ( (*(_BYTE *)(v39 + 44) & 8) != 0 );
      }
      for ( m = *(_QWORD *)(v39 + 8); m != k; k = *(_QWORD *)(k + 8) )
      {
        v43 = *(_WORD *)(k + 68);
        if ( (unsigned __int16)(v43 - 14) > 4u && v43 != 24 )
          break;
      }
      v44 = *(unsigned int *)(v40 + 144);
      v45 = *(_QWORD *)(v40 + 128);
      if ( !(_DWORD)v44 )
        goto LABEL_114;
      v46 = (v44 - 1) & (((unsigned int)k >> 9) ^ ((unsigned int)k >> 4));
      v47 = (__int64 *)(v45 + 16LL * v46);
      v48 = *v47;
      if ( *v47 != k )
      {
        v86 = 1;
        while ( v48 != -4096 )
        {
          v161 = v86 + 1;
          v46 = (v44 - 1) & (v86 + v46);
          v47 = (__int64 *)(v45 + 16LL * v46);
          v48 = *v47;
          if ( *v47 == k )
            goto LABEL_51;
          v86 = v161;
        }
LABEL_114:
        v47 = (__int64 *)(v45 + 16 * v44);
      }
LABEL_51:
      v186 = (2LL * (v183 == v172) + 2) | v47[1] & 0xFFFFFFFFFFFFFFF8LL;
      if ( v195 < 0 )
      {
        v67 = v195 & 0x7FFFFFFF;
        v68 = *(unsigned int *)(v38 + 160);
        if ( (v195 & 0x7FFFFFFFu) < (unsigned int)v68 )
        {
          v69 = *(_QWORD *)(v38 + 152);
          v70 = *(_QWORD *)(v69 + 8LL * v67);
          if ( v70 )
          {
LABEL_98:
            v71 = *(_QWORD *)(v38 + 56);
            v72 = *(_DWORD *)(v70 + 72);
            *(_QWORD *)(v38 + 136) += 16LL;
            v73 = (v71 + 15) & 0xFFFFFFFFFFFFFFF0LL;
            if ( *(_QWORD *)(v38 + 64) >= v73 + 16 && v71 )
            {
              *(_QWORD *)(v38 + 56) = v73 + 16;
              v74 = (v71 + 15) & 0xFFFFFFFFFFFFFFF0LL;
              if ( v73 )
                goto LABEL_101;
            }
            else
            {
              v69 = 16;
              v73 = sub_9D1E70(v38 + 56, 16, 16, 4);
              v74 = v73;
LABEL_101:
              *(_DWORD *)v74 = v72;
              *(_QWORD *)(v74 + 8) = v191;
            }
            v75 = *(unsigned int *)(v70 + 72);
            v76 = v75 + 1;
            if ( v75 + 1 > (unsigned __int64)*(unsigned int *)(v70 + 76) )
            {
              v69 = v70 + 80;
              v181 = v73;
              sub_C8D5F0(v70 + 64, (const void *)(v70 + 80), v75 + 1, 8u, v45, v76);
              v75 = *(unsigned int *)(v70 + 72);
              v73 = v181;
            }
            *(_QWORD *)(*(_QWORD *)(v70 + 64) + 8 * v75) = v73;
            ++*(_DWORD *)(v70 + 72);
            v202 = v74;
            v201.m128i_i64[1] = v186;
            *((_QWORD *)&v168 + 1) = v186;
            *(_QWORD *)&v168 = v191;
            v201.m128i_i64[0] = v191;
            sub_2E0F080(v70, v69, v75, v186, v45, v76, v168, v74);
            v77 = *(_QWORD *)(v70 + 104);
            if ( v77 )
            {
              v78 = v186;
              v187 = v12;
              do
              {
                v79 = *(_DWORD *)(v77 + 72);
                v80 = (__int64 *)(*(_QWORD *)(a1 + 48) + 56LL);
                v81 = sub_A777F0(0x10u, v80);
                if ( v81 )
                {
                  *(_DWORD *)v81 = v79;
                  *(_QWORD *)(v81 + 8) = v191;
                }
                v83 = *(unsigned int *)(v77 + 72);
                v84 = v83 + 1;
                if ( v83 + 1 > (unsigned __int64)*(unsigned int *)(v77 + 76) )
                {
                  v80 = (__int64 *)(v77 + 80);
                  v180 = v81;
                  sub_C8D5F0(v77 + 64, (const void *)(v77 + 80), v83 + 1, 8u, v84, v82);
                  v83 = *(unsigned int *)(v77 + 72);
                  v81 = v180;
                }
                v85 = *(_QWORD *)(v77 + 64);
                *(_QWORD *)(v85 + 8 * v83) = v81;
                ++*(_DWORD *)(v77 + 72);
                v201.m128i_i64[1] = v78;
                v202 = v81;
                *((_QWORD *)&v169 + 1) = v78;
                *(_QWORD *)&v169 = v191;
                v201.m128i_i64[0] = v191;
                sub_2E0F080(v77, (__int64)v80, v83, v85, v84, v82, v169, v81);
                v77 = *(_QWORD *)(v77 + 104);
              }
              while ( v77 );
              v12 = v187;
            }
            goto LABEL_62;
          }
        }
        v87 = v67 + 1;
        if ( (unsigned int)v68 >= v87 || (v97 = v87, v87 == v68) )
        {
LABEL_116:
          v88 = *(_QWORD *)(v38 + 152);
        }
        else
        {
          if ( v87 < v68 )
          {
            *(_DWORD *)(v38 + 160) = v87;
            goto LABEL_116;
          }
          v152 = *(_QWORD *)(v38 + 168);
          v153 = v97 - v68;
          if ( v97 > *(unsigned int *)(v38 + 164) )
          {
            v182 = *(_QWORD *)(v38 + 168);
            sub_C8D5F0(v38 + 152, (const void *)(v38 + 168), v97, 8u, v45, v97);
            v68 = *(unsigned int *)(v38 + 160);
            v152 = v182;
          }
          v88 = *(_QWORD *)(v38 + 152);
          v154 = (_QWORD *)(v88 + 8 * v68);
          v155 = &v154[v153];
          if ( v154 != v155 )
          {
            do
              *v154++ = v152;
            while ( v155 != v154 );
            LODWORD(v68) = *(_DWORD *)(v38 + 160);
            v88 = *(_QWORD *)(v38 + 152);
          }
          *(_DWORD *)(v38 + 160) = v153 + v68;
        }
        v89 = sub_2E10F30(v195);
        *(_QWORD *)(v88 + 8LL * (v195 & 0x7FFFFFFF)) = v89;
        v69 = v89;
        v70 = v89;
        sub_2E11E80((_QWORD *)v38, v89);
        v38 = *(_QWORD *)(a1 + 48);
        goto LABEL_98;
      }
      v49 = *(_QWORD *)(a1 + 16);
      v179 = v12;
      v50 = *(_QWORD *)(v49 + 8);
      v51 = (__int16 *)(*(_QWORD *)(v49 + 56) + 2LL * (*(_DWORD *)(v50 + 24LL * (unsigned int)v195 + 16) >> 12));
      v52 = *(_DWORD *)(v50 + 24LL * (unsigned int)v195 + 16) & 0xFFF;
      do
      {
        if ( !v51 )
          break;
        v53 = *(_QWORD *)(a1 + 48);
        v54 = *(_QWORD *)(*(_QWORD *)(v53 + 424) + 8LL * v52);
        if ( v54 )
        {
          v55 = (__int64 *)(v53 + 56);
          v56 = *(_DWORD *)(v54 + 72);
          v57 = sub_A777F0(0x10u, v55);
          if ( v57 )
          {
            *(_DWORD *)v57 = v56;
            *(_QWORD *)(v57 + 8) = v191;
          }
          v60 = *(unsigned int *)(v54 + 72);
          if ( v60 + 1 > (unsigned __int64)*(unsigned int *)(v54 + 76) )
          {
            v55 = (__int64 *)(v54 + 80);
            v170 = v57;
            sub_C8D5F0(v54 + 64, (const void *)(v54 + 80), v60 + 1, 8u, v58, v59);
            v60 = *(unsigned int *)(v54 + 72);
            v57 = v170;
          }
          *(_QWORD *)(*(_QWORD *)(v54 + 64) + 8 * v60) = v57;
          ++*(_DWORD *)(v54 + 72);
          v201.m128i_i64[1] = v186;
          v202 = v57;
          *((_QWORD *)&v167 + 1) = v186;
          *(_QWORD *)&v167 = v191;
          v201.m128i_i64[0] = v191;
          sub_2E0F080(v54, (__int64)v55, v60, v186, v58, v59, v167, v57);
        }
        v61 = *v51++;
        v52 += v61;
      }
      while ( (_WORD)v61 );
      v12 = v179;
LABEL_62:
      v62 = *(_QWORD *)(v12 + 32) + v184;
      if ( (((*(_BYTE *)(v62 + 3) & 0x40) != 0) & ((*(_BYTE *)(v62 + 3) >> 4) ^ 1)) != 0
        || sub_2FF9BD0((_QWORD *)a1, *(_QWORD *)(v62 + 16), *(_DWORD *)(v62 + 8)) )
      {
        *(_BYTE *)(v62 + 3) &= ~0x40u;
        v176 = 1;
      }
      if ( v195 < 0 && v189 < 0 )
        sub_2EBE590(*(_QWORD *)(a1 + 32), v195, v178, 0);
      sub_2EAB0C0(v62, v195);
      *(_DWORD *)v62 &= 0xFFF000FF;
LABEL_66:
      v192 += 2;
      if ( v183 == v192 )
      {
        if ( !v173 )
        {
          if ( v176 )
          {
            v105 = *(_QWORD *)(a2 + 32);
            v106 = v105 + 40LL * (*(_DWORD *)(a2 + 40) & 0xFFFFFF);
            v107 = v105 + 40LL * (unsigned int)sub_2E88FE0(a2);
            if ( v106 != v107 )
            {
              while ( 1 )
              {
                v108 = v107;
                if ( (unsigned __int8)sub_2E2FA70((_BYTE *)v107) )
                  break;
                v107 += 40;
                if ( v106 == v107 )
                  return;
              }
              if ( v106 != v107 )
              {
                if ( v189 == *(_DWORD *)(v107 + 8) )
                {
LABEL_151:
                  *(_BYTE *)(v108 + 3) |= 0x40u;
                }
                else
                {
                  while ( 1 )
                  {
                    v109 = v108 + 40;
                    if ( v108 + 40 == v106 )
                      break;
                    while ( 1 )
                    {
                      v108 = v109;
                      if ( (unsigned __int8)sub_2E2FA70((_BYTE *)v109) )
                        break;
                      v109 += 40;
                      if ( v106 == v109 )
                        return;
                    }
                    if ( v109 == v106 )
                      break;
                    if ( v189 == *(_DWORD *)(v109 + 8) )
                      goto LABEL_151;
                  }
                }
              }
            }
          }
          return;
        }
        v6 = *(_QWORD *)(a2 + 32);
        goto LABEL_153;
      }
    }
  }
  v177 = 0;
  v191 = 0;
  v176 = 0;
  v189 = 0;
LABEL_153:
  v110 = (_BYTE *)(v6 + 40LL * (*(_DWORD *)(a2 + 40) & 0xFFFFFF));
  v115 = (_BYTE *)(v6 + 40LL * (unsigned int)sub_2E88FE0(a2));
  if ( v110 == v115 )
    goto LABEL_246;
  while ( 1 )
  {
    v116 = (__int64)v115;
    v117 = sub_2E2FA70(v115);
    if ( v117 )
      break;
    v115 += 40;
    if ( v110 == v115 )
      goto LABEL_246;
  }
  if ( v110 == v115 )
  {
LABEL_246:
    if ( !v176 )
    {
LABEL_181:
      v194 = 0u;
      goto LABEL_182;
    }
LABEL_167:
    v119 = *(__m128i **)(a1 + 40);
    if ( v119 )
    {
      v120 = sub_2E29D60(v119, v189, v111, v112, v113, v114);
      v201.m128i_i64[0] = a2;
      v121 = sub_2FF8C10(*(_QWORD **)(v120 + 32), *(_QWORD *)(v120 + 40), v201.m128i_i64);
      if ( v121 != *(_BYTE **)(v122 + 40) )
      {
        sub_2E25970(v122 + 32, v121);
        v123 = *(_QWORD *)a2 & 0xFFFFFFFFFFFFFFF8LL;
        if ( !v123 )
          BUG();
        v124 = *(_QWORD *)v123;
        if ( (*(_QWORD *)v123 & 4) == 0 && (*(_BYTE *)(v123 + 44) & 4) != 0 )
        {
          while ( 1 )
          {
            v125 = v124 & 0xFFFFFFFFFFFFFFF8LL;
            v123 = v125;
            if ( (*(_BYTE *)(v125 + 44) & 4) == 0 )
              break;
            v124 = *(_QWORD *)v125;
          }
        }
        v126 = *(_QWORD *)(a1 + 40);
        if ( (unsigned __int8)sub_2E8F280(v123, v189, *(_QWORD **)(v126 + 96), 0) )
        {
          v131 = sub_2E29D60((__m128i *)v126, v189, v127, v128, v129, v130);
          v201.m128i_i64[0] = v123;
          v132 = *(_BYTE **)(v131 + 40);
          if ( v132 == *(_BYTE **)(v131 + 48) )
          {
            sub_2E26050(v131 + 32, v132, &v201);
          }
          else
          {
            if ( v132 )
            {
              *(_QWORD *)v132 = v123;
              v132 = *(_BYTE **)(v131 + 40);
            }
            *(_QWORD *)(v131 + 40) = v132 + 8;
          }
        }
      }
    }
    *sub_2FFAE70(a1 + 208, &v196) = v189;
    goto LABEL_181;
  }
  v193 = v117;
  v194 = 0u;
  do
  {
    if ( *(_DWORD *)(v116 + 8) == v189 )
    {
      if ( ((*(_DWORD *)v116 >> 8) & 0xFFF) == v177 && v183 == v172 )
      {
        if ( (((*(_BYTE *)(v116 + 3) & 0x40) != 0) & ((*(_BYTE *)(v116 + 3) >> 4) ^ 1)) != 0
          || sub_2FF9BD0((_QWORD *)a1, *(_QWORD *)(v116 + 16), v189) )
        {
          *(_BYTE *)(v116 + 3) &= ~0x40u;
          v176 = v193;
        }
        sub_2EAB0C0(v116, v196);
        *(_DWORD *)v116 &= 0xFFF000FF;
      }
      else
      {
        v112 = *(_QWORD *)(a1 + 16);
        v194 |= *(_OWORD *)(*(_QWORD *)(v112 + 272) + 16LL * ((*(_DWORD *)v116 >> 8) & 0xFFF));
      }
    }
    v111 = v116 + 40;
    if ( (_BYTE *)(v116 + 40) == v110 )
      break;
    v118 = (_BYTE *)(v116 + 40);
    while ( 1 )
    {
      v116 = (__int64)v118;
      if ( (unsigned __int8)sub_2E2FA70(v118) )
        break;
      v118 += 40;
      if ( v110 == v118 )
        goto LABEL_165;
    }
  }
  while ( v118 != v110 );
LABEL_165:
  if ( v176 && v194 == 0 )
    goto LABEL_167;
LABEL_182:
  v133 = *(_QWORD *)(a1 + 48);
  if ( !v133 )
    return;
  v134 = a2;
  v135 = *(_QWORD *)(v133 + 32);
  v136 = a2;
  if ( (*(_DWORD *)(a2 + 44) & 4) != 0 )
  {
    do
      v136 = *(_QWORD *)v136 & 0xFFFFFFFFFFFFFFF8LL;
    while ( (*(_BYTE *)(v136 + 44) & 4) != 0 );
  }
  if ( (*(_DWORD *)(a2 + 44) & 8) != 0 )
  {
    do
      v134 = *(_QWORD *)(v134 + 8);
    while ( (*(_BYTE *)(v134 + 44) & 8) != 0 );
  }
  for ( n = *(_QWORD *)(v134 + 8); n != v136; v136 = *(_QWORD *)(v136 + 8) )
  {
    v138 = *(_WORD *)(v136 + 68);
    if ( (unsigned __int16)(v138 - 14) > 4u && v138 != 24 )
      break;
  }
  v139 = *(_DWORD *)(v135 + 144);
  v140 = *(_QWORD *)(v135 + 128);
  if ( !v139 )
  {
LABEL_243:
    v142 = (__int64 *)(v140 + 16LL * v139);
    goto LABEL_193;
  }
  v141 = (v139 - 1) & (((unsigned int)v136 >> 9) ^ ((unsigned int)v136 >> 4));
  v142 = (__int64 *)(v140 + 16LL * v141);
  v143 = *v142;
  if ( v136 != *v142 )
  {
    v162 = 1;
    while ( v143 != -4096 )
    {
      v114 = (unsigned int)(v162 + 1);
      v141 = (v139 - 1) & (v162 + v141);
      v142 = (__int64 *)(v140 + 16LL * v141);
      v143 = *v142;
      if ( *v142 == v136 )
        goto LABEL_193;
      v162 = v114;
    }
    goto LABEL_243;
  }
LABEL_193:
  v144 = v142[1];
  v145 = *(unsigned int *)(v133 + 160);
  v146 = v189 & 0x7FFFFFFF;
  if ( (v189 & 0x7FFFFFFFu) < (unsigned int)v145 )
  {
    v185 = *(_QWORD *)(*(_QWORD *)(v133 + 152) + 8LL * v146);
    if ( v185 )
      goto LABEL_195;
  }
  v156 = v146 + 1;
  if ( (unsigned int)v145 < v156 && v156 != v145 )
  {
    if ( v156 >= v145 )
    {
      v163 = *(_QWORD *)(v133 + 168);
      v164 = v156 - v145;
      if ( v156 > (unsigned __int64)*(unsigned int *)(v133 + 164) )
      {
        sub_C8D5F0(v133 + 152, (const void *)(v133 + 168), v156, 8u, v156, v114);
        v145 = *(unsigned int *)(v133 + 160);
      }
      v157 = *(_QWORD *)(v133 + 152);
      v165 = (_QWORD *)(v157 + 8 * v145);
      v166 = &v165[v164];
      if ( v165 != v166 )
      {
        do
          *v165++ = v163;
        while ( v166 != v165 );
        LODWORD(v145) = *(_DWORD *)(v133 + 160);
        v157 = *(_QWORD *)(v133 + 152);
      }
      *(_DWORD *)(v133 + 160) = v164 + v145;
      goto LABEL_232;
    }
    *(_DWORD *)(v133 + 160) = v156;
  }
  v157 = *(_QWORD *)(v133 + 152);
LABEL_232:
  v158 = (__int64 *)(v157 + 8LL * (v189 & 0x7FFFFFFF));
  v159 = sub_2E10F30(v189);
  *v158 = v159;
  v185 = v159;
  sub_2E11E80((_QWORD *)v133, v159);
LABEL_195:
  if ( !*(_QWORD *)(v185 + 104) )
    goto LABEL_205;
  v190 = v144;
  v147 = *(_QWORD *)(v185 + 104);
  v188 = 1;
  do
  {
    while ( 1 )
    {
      v148 = *(_QWORD *)(v147 + 112);
      v149 = *(_QWORD *)(v147 + 120);
      v150 = (__int64 *)sub_2E09D00((__int64 *)v147, v191);
      if ( v150 == (__int64 *)(*(_QWORD *)v147 + 24LL * *(unsigned int *)(v147 + 8))
        || (*(_DWORD *)((*v150 & 0xFFFFFFFFFFFFFFF8LL) + 24) | (unsigned int)(*v150 >> 1) & 3) > ((unsigned int)(v191 >> 1)
                                                                                                & 2
                                                                                                | *(_DWORD *)((v191 & 0xFFFFFFFFFFFFFFF8LL) + 24)) )
      {
        goto LABEL_198;
      }
      if ( *((_QWORD *)&v194 + 1) & v149 | (unsigned __int64)v194 & v148 || (v150[1] & 0xFFFFFFFFFFFFFFF8LL) != v190 )
        break;
      v150[1] = v191;
LABEL_198:
      v147 = *(_QWORD *)(v147 + 104);
      if ( !v147 )
        goto LABEL_204;
    }
    v147 = *(_QWORD *)(v147 + 104);
    v188 = 0;
  }
  while ( v147 );
LABEL_204:
  v144 = v190;
  if ( v188 )
  {
LABEL_205:
    v151 = (__int64 *)sub_2E09D00((__int64 *)v185, v191);
    if ( v151 != (__int64 *)(*(_QWORD *)v185 + 24LL * *(unsigned int *)(v185 + 8))
      && (*(_DWORD *)((*v151 & 0xFFFFFFFFFFFFFFF8LL) + 24) | (unsigned int)(*v151 >> 1) & 3) <= (*(_DWORD *)((v191 & 0xFFFFFFFFFFFFFFF8LL) + 24)
                                                                                               | (unsigned int)(v191 >> 1)
                                                                                               & 3)
      && v194 == 0
      && (v151[1] & 0xFFFFFFFFFFFFFFF8LL) == v144 )
    {
      v151[1] = v191;
    }
  }
}

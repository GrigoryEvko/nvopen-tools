// Function: sub_27678E0
// Address: 0x27678e0
//
void __fastcall sub_27678E0(__int64 a1, _BYTE *a2, unsigned __int64 a3, __int64 a4)
{
  __int64 v4; // r8
  __int64 v5; // r9
  __int64 v6; // rdx
  __int64 v7; // rcx
  __int64 v8; // r8
  __int64 v9; // r9
  _QWORD *v10; // rbx
  _QWORD *v11; // r12
  void (__fastcall *v12)(_QWORD *, _QWORD *, __int64); // rax
  __int64 v13; // rax
  int v14; // eax
  _QWORD *v15; // rdx
  _QWORD *v16; // rdi
  __int64 v17; // rcx
  __int64 v18; // rbx
  __int64 v19; // rdi
  unsigned __int64 v20; // rdi
  __int64 v21; // r14
  __int64 v22; // rdx
  __int64 v23; // r13
  __int64 v24; // r12
  __int64 v25; // r14
  __int64 v26; // rdx
  __int64 v27; // r13
  __int64 v28; // rax
  __int64 v29; // r12
  _BYTE *v30; // rsi
  _BYTE *v31; // r8
  _BYTE *v32; // rax
  __int64 v33; // rsi
  __int64 v34; // r13
  unsigned __int16 v35; // r12
  _QWORD *v36; // rdi
  __int64 v37; // r14
  __int64 v38; // r12
  __int64 v39; // r15
  __int64 v40; // r13
  _QWORD *v41; // rdi
  __int64 v42; // r8
  __int64 v43; // r9
  _BYTE *v44; // r14
  _BYTE *v45; // r15
  __int16 v46; // dx
  __int64 v47; // r8
  __int64 v48; // rdx
  __int64 v49; // r13
  __int64 v50; // rax
  __int64 v51; // r12
  __int64 v52; // rdi
  unsigned __int16 v53; // ax
  __int16 v54; // dx
  __int64 v55; // r8
  __int64 v56; // rdx
  __int64 v57; // rax
  __int64 v58; // r13
  __int64 v59; // rdi
  unsigned __int16 v60; // ax
  __int64 v61; // r15
  int v62; // ecx
  __int64 v63; // rax
  unsigned int v64; // esi
  __int64 v65; // rax
  __int64 v66; // r8
  __int64 v67; // r9
  __int64 v68; // r14
  __int64 v69; // rdx
  __int64 v70; // r12
  __int64 i; // r13
  __int64 v72; // r15
  __int64 v73; // rax
  __int64 v74; // rcx
  unsigned int v75; // edi
  int v76; // edx
  __int64 v77; // rax
  __int64 v78; // rsi
  int v79; // edx
  __int64 v80; // rax
  __int64 v81; // rdx
  __int64 v82; // rdx
  __int64 v83; // r15
  __int64 v84; // rcx
  int v85; // edx
  __int64 v86; // rax
  __int64 v87; // rdi
  __int64 v88; // rax
  __int64 v89; // rsi
  int v90; // edx
  __int64 v91; // rax
  __int64 v92; // rdx
  __int64 v93; // rdx
  __int64 v94; // rax
  __int64 v95; // r13
  __int64 v96; // rdx
  __int64 v97; // rcx
  __int64 v98; // rax
  __int64 v99; // rax
  int v100; // ecx
  __int64 v101; // rdi
  int v102; // ecx
  unsigned int v103; // edx
  _QWORD *v104; // rax
  _BYTE *v105; // r8
  __int64 *v106; // rbx
  _QWORD *v107; // r13
  _BYTE *v108; // r12
  const __m128i *v109; // r12
  const __m128i *v110; // rbx
  __int64 j; // rax
  __m128i v112; // xmm0
  __int64 v113; // rax
  __int64 v114; // r14
  __int64 v115; // r15
  __m128i v116; // rax
  __int64 v117; // r13
  __int64 v118; // r12
  _BYTE *v119; // rsi
  __int64 v120; // r13
  unsigned __int16 v121; // r12
  __int64 v122; // rcx
  _QWORD *v123; // rdi
  __int64 v124; // r8
  __int64 v125; // r9
  __int16 v126; // dx
  __int64 v127; // r8
  char v128; // r14
  __int64 v129; // rdx
  __int64 v130; // r13
  __int64 v131; // r12
  unsigned __int16 v132; // ax
  __int64 v133; // rax
  __int64 v134; // rdx
  __int64 v135; // r13
  __int64 v136; // r14
  __int64 v137; // r12
  __int64 v138; // rbx
  __int64 v139; // rsi
  __int64 v140; // rax
  __int64 v141; // rax
  __int64 v142; // rax
  __int64 v143; // r13
  __int16 v144; // dx
  __int64 v145; // r14
  __int64 v146; // rdx
  __int64 v147; // rdx
  char v148; // cl
  __int64 v149; // rax
  int v150; // ecx
  __int64 v151; // rdi
  unsigned __int16 v152; // ax
  __int64 v153; // r14
  __int64 v154; // rdx
  __int64 v155; // rdx
  __int64 v156; // r14
  __int64 v157; // rax
  __int64 v158; // rax
  __int64 v159; // r14
  __int64 v160; // r12
  __int64 v161; // r13
  _QWORD *v162; // rdi
  __int64 v163; // r14
  int v164; // eax
  int v165; // r9d
  __int64 v166; // [rsp-8h] [rbp-478h]
  __int64 v167; // [rsp+8h] [rbp-468h]
  __int64 v169; // [rsp+38h] [rbp-438h]
  __int64 v170; // [rsp+38h] [rbp-438h]
  char v171; // [rsp+38h] [rbp-438h]
  char v172; // [rsp+38h] [rbp-438h]
  char v173; // [rsp+50h] [rbp-420h]
  char v174; // [rsp+50h] [rbp-420h]
  __int64 v175; // [rsp+50h] [rbp-420h]
  __int64 v176; // [rsp+50h] [rbp-420h]
  char v177; // [rsp+50h] [rbp-420h]
  char v178; // [rsp+58h] [rbp-418h]
  char v179; // [rsp+58h] [rbp-418h]
  _BYTE *v180; // [rsp+60h] [rbp-410h]
  __int64 v181; // [rsp+68h] [rbp-408h]
  int v182; // [rsp+68h] [rbp-408h]
  unsigned __int64 v183; // [rsp+70h] [rbp-400h]
  __int64 v184; // [rsp+80h] [rbp-3F0h]
  __int64 v185; // [rsp+88h] [rbp-3E8h]
  _BYTE *v186; // [rsp+88h] [rbp-3E8h]
  _QWORD *v187; // [rsp+98h] [rbp-3D8h]
  __m128i v188; // [rsp+A0h] [rbp-3D0h] BYREF
  const char *v189; // [rsp+B0h] [rbp-3C0h] BYREF
  __int64 v190; // [rsp+B8h] [rbp-3B8h] BYREF
  const __m128i *v191; // [rsp+C0h] [rbp-3B0h] BYREF
  const __m128i *v192; // [rsp+C8h] [rbp-3A8h]
  __int64 v193; // [rsp+D0h] [rbp-3A0h]
  unsigned __int64 v194; // [rsp+E0h] [rbp-390h] BYREF
  _BYTE *v195; // [rsp+E8h] [rbp-388h]
  _BYTE *v196; // [rsp+F0h] [rbp-380h]
  __m128i v197; // [rsp+100h] [rbp-370h] BYREF
  const char *v198; // [rsp+110h] [rbp-360h]
  unsigned __int64 v199; // [rsp+118h] [rbp-358h]
  __int64 v200; // [rsp+120h] [rbp-350h]
  unsigned __int64 v201; // [rsp+128h] [rbp-348h]
  _BYTE *v202; // [rsp+130h] [rbp-340h] BYREF
  __int64 v203; // [rsp+138h] [rbp-338h]
  _BYTE v204[64]; // [rsp+140h] [rbp-330h] BYREF
  unsigned __int64 v205[2]; // [rsp+180h] [rbp-2F0h] BYREF
  _BYTE v206[512]; // [rsp+190h] [rbp-2E0h] BYREF
  __int64 v207; // [rsp+390h] [rbp-E0h]
  __int64 v208; // [rsp+398h] [rbp-D8h]
  _BYTE *v209; // [rsp+3A0h] [rbp-D0h]
  __int64 v210; // [rsp+3A8h] [rbp-C8h]
  char v211; // [rsp+3B0h] [rbp-C0h]
  __int64 v212; // [rsp+3B8h] [rbp-B8h]
  char *v213; // [rsp+3C0h] [rbp-B0h]
  __int64 v214; // [rsp+3C8h] [rbp-A8h]
  int v215; // [rsp+3D0h] [rbp-A0h]
  char v216; // [rsp+3D4h] [rbp-9Ch]
  char v217; // [rsp+3D8h] [rbp-98h] BYREF
  __int16 v218; // [rsp+418h] [rbp-58h]
  _QWORD *v219; // [rsp+420h] [rbp-50h]
  _QWORD *v220; // [rsp+428h] [rbp-48h]
  __int64 v221; // [rsp+430h] [rbp-40h]

  v4 = 0;
  v5 = *(unsigned int *)(a3 + 8);
  v205[0] = (unsigned __int64)v206;
  v205[1] = 0x1000000000LL;
  v213 = &v217;
  v202 = v204;
  v203 = 0x400000000LL;
  v207 = 0;
  v208 = 0;
  v209 = a2;
  v210 = 0;
  v211 = 0;
  v212 = 0;
  v214 = 8;
  v215 = 0;
  v216 = 1;
  v218 = 0;
  v219 = 0;
  v220 = 0;
  v221 = 0;
  if ( !(_DWORD)v5 )
    goto LABEL_2;
  a2 = (_BYTE *)a3;
  sub_27656D0((__int64)&v202, a3, a3, a4, 0, v5);
  v14 = v203;
  if ( (_DWORD)v203 )
  {
    while ( 1 )
    {
      v15 = &v202[16 * v14 - 16];
      v16 = (_QWORD *)*v15;
      v17 = v15[1];
      LODWORD(v203) = v14 - 1;
      v191 = 0;
      v18 = v16[5];
      v187 = v16;
      v188.m128i_i64[0] = v17;
      v19 = *(_QWORD *)(v18 + 48);
      v192 = 0;
      v193 = 0;
      v194 = 0;
      v20 = v19 & 0xFFFFFFFFFFFFFFF8LL;
      v195 = 0;
      v196 = 0;
      v183 = v20;
      if ( v20 == v18 + 48 )
        goto LABEL_195;
      if ( !v20 )
        BUG();
      if ( (unsigned int)*(unsigned __int8 *)(v20 - 24) - 30 > 0xA )
LABEL_195:
        BUG();
      if ( *(_BYTE *)(v20 - 24) != 31 )
        BUG();
      v184 = *(_QWORD *)(a1 + 24);
      if ( (*(_DWORD *)(v20 - 20) & 0x7FFFFFF) == 1 )
        break;
      v185 = *(_QWORD *)(v188.m128i_i64[0] + 40);
      v21 = *(_QWORD *)(v185 + 72);
      v197.m128i_i64[0] = (__int64)sub_BD5D20((__int64)v187);
      LOWORD(v200) = 773;
      v197.m128i_i64[1] = v22;
      v198 = ".si.unfold.true";
      v23 = sub_BD5C60((__int64)v187);
      v24 = sub_22077B0(0x50u);
      if ( v24 )
        sub_AA4D50(v24, v23, (__int64)&v197, v21, v185);
      v189 = (const char *)v24;
      v25 = *(_QWORD *)(v185 + 72);
      v197.m128i_i64[0] = (__int64)sub_BD5D20((__int64)v187);
      LOWORD(v200) = 773;
      v197.m128i_i64[1] = v26;
      v198 = ".si.unfold.false";
      v27 = sub_BD5C60((__int64)v187);
      v28 = sub_22077B0(0x50u);
      v29 = v28;
      if ( v28 )
        sub_AA4D50(v28, v27, (__int64)&v197, v25, v185);
      v30 = v195;
      v31 = v196;
      v190 = v29;
      if ( v195 != v196 )
      {
        if ( v195 )
        {
          *(_QWORD *)v195 = v189;
          v30 = v195;
          v31 = v196;
        }
        v32 = v30 + 8;
        v33 = v190;
        v195 = v32;
        if ( v32 == v31 )
        {
LABEL_181:
          sub_9319A0((__int64)&v194, v31, &v190);
          v33 = v190;
          goto LABEL_33;
        }
LABEL_31:
        *(_QWORD *)v32 = v33;
        v32 = v195;
        v33 = v190;
        goto LABEL_32;
      }
      sub_9319A0((__int64)&v194, v195, &v189);
      v32 = v195;
      v31 = v196;
      if ( v195 == v196 )
        goto LABEL_181;
      v33 = v190;
      if ( v195 )
        goto LABEL_31;
LABEL_32:
      v195 = v32 + 8;
LABEL_33:
      sub_B43C20((__int64)&v197, v33);
      v34 = v197.m128i_i64[0];
      v35 = v197.m128i_u16[4];
      v36 = sub_BD2C40(72, 1u);
      if ( v36 )
        sub_B4C8F0((__int64)v36, v185, 1u, v34, v35);
      sub_B43C20((__int64)&v197, (__int64)v189);
      v37 = v190;
      v38 = v197.m128i_i64[0];
      v39 = *(v187 - 12);
      v40 = v197.m128i_u16[4];
      v41 = sub_BD2C40(72, 3u);
      if ( v41 )
      {
        sub_B4C9A0((__int64)v41, v185, v37, v39, 3u, v43, v38, v40);
        v42 = v166;
      }
      v200 = v190;
      v197.m128i_i64[0] = (__int64)v189;
      v198 = v189;
      v199 = v185 & 0xFFFFFFFFFFFFFFFBLL;
      v201 = v185 & 0xFFFFFFFFFFFFFFFBLL;
      v197.m128i_i64[1] = v190 & 0xFFFFFFFFFFFFFFFBLL;
      sub_FFB3D0((__int64)v205, (unsigned __int64 *)&v197, 3, v190 & 0xFFFFFFFFFFFFFFFBLL, v42, v43);
      v44 = (_BYTE *)*(v187 - 8);
      v45 = (_BYTE *)*(v187 - 4);
      v47 = sub_AA5190((__int64)v189);
      if ( v47 )
      {
        v178 = v46;
        v173 = HIBYTE(v46);
      }
      else
      {
        v173 = 0;
        v178 = 0;
      }
      v169 = v47;
      v197.m128i_i64[0] = (__int64)sub_BD5D20((__int64)v44);
      v198 = ".si.unfold.phi";
      LOWORD(v200) = 773;
      v197.m128i_i64[1] = v48;
      v49 = *(_QWORD *)(v188.m128i_i64[0] + 8);
      v50 = sub_BD2DA0(80);
      v51 = v50;
      if ( v50 )
      {
        v52 = v50;
        LOBYTE(v53) = v178;
        HIBYTE(v53) = v173;
        sub_B44260(v52, v49, 55, 0x8000000u, v169, v53);
        *(_DWORD *)(v51 + 72) = 1;
        sub_BD6B50((unsigned __int8 *)v51, (const char **)&v197);
        sub_BD2A10(v51, *(_DWORD *)(v51 + 72), 1);
      }
      v55 = sub_AA5190(v190);
      if ( v55 )
      {
        v179 = v54;
        v174 = HIBYTE(v54);
      }
      else
      {
        v174 = 0;
        v179 = 0;
      }
      v170 = v55;
      v197.m128i_i64[0] = (__int64)sub_BD5D20((__int64)v45);
      LOWORD(v200) = 773;
      v198 = ".si.unfold.phi";
      v197.m128i_i64[1] = v56;
      v181 = *(_QWORD *)(v188.m128i_i64[0] + 8);
      v57 = sub_BD2DA0(80);
      v58 = v57;
      if ( v57 )
      {
        v59 = v57;
        LOBYTE(v60) = v179;
        HIBYTE(v60) = v174;
        sub_B44260(v59, v181, 55, 0x8000000u, v170, v60);
        *(_DWORD *)(v58 + 72) = 1;
        sub_BD6B50((unsigned __int8 *)v58, (const char **)&v197);
        sub_BD2A10(v58, *(_DWORD *)(v58 + 72), 1);
      }
      sub_F0A850(v51, (__int64)v44, v18);
      sub_F0A850(v58, (__int64)v45, (__int64)v189);
      if ( *v44 == 86 )
      {
        v197.m128i_i64[0] = (__int64)v44;
        v197.m128i_i64[1] = v51;
        sub_2765570((unsigned __int64 *)&v191, &v197);
      }
      if ( *v45 == 86 )
      {
        v197.m128i_i64[0] = (__int64)v45;
        v197.m128i_i64[1] = v58;
        sub_2765570((unsigned __int64 *)&v191, &v197);
      }
      v61 = v188.m128i_i64[0];
      sub_F0A850(v188.m128i_i64[0], v51, (__int64)v189);
      sub_F0A850(v61, v58, v190);
      v62 = *(_DWORD *)(v61 + 4) & 0x7FFFFFF;
      if ( v62 )
      {
        v63 = 0;
        while ( 1 )
        {
          v64 = v63;
          if ( v18 == *(_QWORD *)(*(_QWORD *)(v61 - 8) + 32LL * *(unsigned int *)(v61 + 72) + 8 * v63) )
            break;
          if ( v62 == (_DWORD)++v63 )
            goto LABEL_120;
        }
      }
      else
      {
LABEL_120:
        v64 = -1;
      }
      sub_B48BF0(v188.m128i_i64[0], v64, 1);
      v65 = sub_AA5930(v185);
      v68 = v188.m128i_i64[0];
      v70 = v69;
      for ( i = v65; v70 != i; i = v95 - 24 )
      {
        if ( v68 == i )
          goto LABEL_86;
        while ( 1 )
        {
          v72 = (__int64)v189;
          v73 = 0x1FFFFFFFE0LL;
          v74 = *(_QWORD *)(i - 8);
          v75 = *(_DWORD *)(i + 72);
          v76 = *(_DWORD *)(i + 4) & 0x7FFFFFF;
          if ( v76 )
          {
            v77 = 0;
            do
            {
              if ( v18 == *(_QWORD *)(v74 + 32LL * v75 + 8 * v77) )
              {
                v73 = 32 * v77;
                goto LABEL_60;
              }
              ++v77;
            }
            while ( v76 != (_DWORD)v77 );
            v78 = *(_QWORD *)(v74 + 0x1FFFFFFFE0LL);
            if ( v76 == v75 )
            {
LABEL_117:
              v188.m128i_i64[0] = v78;
              sub_B48D90(i);
              v74 = *(_QWORD *)(i - 8);
              v78 = v188.m128i_i64[0];
              v76 = *(_DWORD *)(i + 4) & 0x7FFFFFF;
            }
          }
          else
          {
LABEL_60:
            v78 = *(_QWORD *)(v74 + v73);
            if ( v76 == v75 )
              goto LABEL_117;
          }
          v79 = (v76 + 1) & 0x7FFFFFF;
          *(_DWORD *)(i + 4) = v79 | *(_DWORD *)(i + 4) & 0xF8000000;
          v80 = v74 + 32LL * (unsigned int)(v79 - 1);
          if ( *(_QWORD *)v80 )
          {
            v81 = *(_QWORD *)(v80 + 8);
            **(_QWORD **)(v80 + 16) = v81;
            if ( v81 )
              *(_QWORD *)(v81 + 16) = *(_QWORD *)(v80 + 16);
          }
          *(_QWORD *)v80 = v78;
          if ( v78 )
          {
            v82 = *(_QWORD *)(v78 + 16);
            *(_QWORD *)(v80 + 8) = v82;
            if ( v82 )
              *(_QWORD *)(v82 + 16) = v80 + 8;
            *(_QWORD *)(v80 + 16) = v78 + 16;
            *(_QWORD *)(v78 + 16) = v80;
          }
          *(_QWORD *)(*(_QWORD *)(i - 8)
                    + 32LL * *(unsigned int *)(i + 72)
                    + 8LL * ((*(_DWORD *)(i + 4) & 0x7FFFFFFu) - 1)) = v72;
          v83 = v190;
          v84 = *(_QWORD *)(i - 8);
          v85 = *(_DWORD *)(i + 4) & 0x7FFFFFF;
          if ( v85 )
          {
            v86 = 0;
            v87 = *(unsigned int *)(i + 72);
            do
            {
              if ( v18 == *(_QWORD *)(v84 + 32 * v87 + 8 * v86) )
              {
                v88 = 32 * v86;
                goto LABEL_73;
              }
              ++v86;
            }
            while ( v85 != (_DWORD)v86 );
            v89 = *(_QWORD *)(v84 + 0x1FFFFFFFE0LL);
            if ( v85 != (_DWORD)v87 )
              goto LABEL_74;
          }
          else
          {
            v88 = 0x1FFFFFFFE0LL;
            LODWORD(v87) = *(_DWORD *)(i + 72);
LABEL_73:
            v89 = *(_QWORD *)(v84 + v88);
            if ( v85 != (_DWORD)v87 )
              goto LABEL_74;
          }
          v188.m128i_i64[0] = v89;
          sub_B48D90(i);
          v84 = *(_QWORD *)(i - 8);
          v89 = v188.m128i_i64[0];
          v85 = *(_DWORD *)(i + 4) & 0x7FFFFFF;
LABEL_74:
          v90 = (v85 + 1) & 0x7FFFFFF;
          *(_DWORD *)(i + 4) = v90 | *(_DWORD *)(i + 4) & 0xF8000000;
          v91 = v84 + 32LL * (unsigned int)(v90 - 1);
          if ( *(_QWORD *)v91 )
          {
            v92 = *(_QWORD *)(v91 + 8);
            **(_QWORD **)(v91 + 16) = v92;
            if ( v92 )
              *(_QWORD *)(v92 + 16) = *(_QWORD *)(v91 + 16);
          }
          *(_QWORD *)v91 = v89;
          if ( v89 )
          {
            v93 = *(_QWORD *)(v89 + 16);
            *(_QWORD *)(v91 + 8) = v93;
            if ( v93 )
              *(_QWORD *)(v93 + 16) = v91 + 8;
            *(_QWORD *)(v91 + 16) = v89 + 16;
            *(_QWORD *)(v89 + 16) = v91;
          }
          *(_QWORD *)(*(_QWORD *)(i - 8)
                    + 32LL * *(unsigned int *)(i + 72)
                    + 8LL * ((*(_DWORD *)(i + 4) & 0x7FFFFFFu) - 1)) = v83;
          if ( (*(_DWORD *)(i + 4) & 0x7FFFFFF) != 0 )
          {
            v94 = 0;
            while ( v18 != *(_QWORD *)(*(_QWORD *)(i - 8) + 32LL * *(unsigned int *)(i + 72) + 8 * v94) )
            {
              if ( (*(_DWORD *)(i + 4) & 0x7FFFFFF) == (_DWORD)++v94 )
                goto LABEL_115;
            }
            sub_B48BF0(i, v94, 1);
          }
          else
          {
LABEL_115:
            sub_B48BF0(i, 0xFFFFFFFF, 1);
          }
LABEL_86:
          v95 = *(_QWORD *)(i + 32);
          if ( !v95 )
            BUG();
          if ( *(_BYTE *)(v95 - 24) == 84 )
            break;
          if ( !v70 )
            goto LABEL_89;
          i = 0;
        }
      }
LABEL_89:
      v96 = (__int64)v189;
      v97 = *(_QWORD *)(v183 - 88);
      v98 = v183 - 32LL * ((v97 != 0) & (unsigned __int8)(v185 == v97)) - 56;
      if ( *(_QWORD *)v98 )
      {
        v97 = *(_QWORD *)(v98 + 8);
        **(_QWORD **)(v98 + 16) = v97;
        if ( v97 )
          *(_QWORD *)(v97 + 16) = *(_QWORD *)(v98 + 16);
      }
      *(_QWORD *)v98 = v96;
      if ( v96 )
      {
        v97 = *(_QWORD *)(v96 + 16);
        *(_QWORD *)(v98 + 8) = v97;
        if ( v97 )
          *(_QWORD *)(v97 + 16) = v98 + 8;
        *(_QWORD *)(v98 + 16) = v96 + 16;
        *(_QWORD *)(v96 + 16) = v98;
      }
      v197.m128i_i64[0] = v18;
      v198 = (const char *)v18;
      v197.m128i_i64[1] = v185 & 0xFFFFFFFFFFFFFFFBLL | 4;
      v99 = (__int64)v189;
LABEL_97:
      v199 = v99 & 0xFFFFFFFFFFFFFFFBLL;
      sub_FFB3D0((__int64)v205, (unsigned __int64 *)&v197, 2, v97, v66, v67);
      a2 = (_BYTE *)v187[5];
      v100 = *(_DWORD *)(v184 + 24);
      v101 = *(_QWORD *)(v184 + 8);
      if ( v100 )
      {
        v102 = v100 - 1;
        v103 = v102 & (((unsigned int)a2 >> 9) ^ ((unsigned int)a2 >> 4));
        v104 = (_QWORD *)(v101 + 16LL * v103);
        v105 = (_BYTE *)*v104;
        if ( a2 == (_BYTE *)*v104 )
        {
LABEL_99:
          v106 = (__int64 *)v104[1];
          if ( v106 )
          {
            v107 = (_QWORD *)v194;
            v108 = v195;
            while ( v108 != (_BYTE *)v107 )
            {
              a2 = (_BYTE *)*v107++;
              sub_D4F330(v106, (__int64)a2, v184);
            }
          }
        }
        else
        {
          v164 = 1;
          while ( v105 != (_BYTE *)-4096LL )
          {
            v165 = v164 + 1;
            v103 = v102 & (v164 + v103);
            v104 = (_QWORD *)(v101 + 16LL * v103);
            v105 = (_BYTE *)*v104;
            if ( a2 == (_BYTE *)*v104 )
              goto LABEL_99;
            v164 = v165;
          }
        }
      }
      sub_B43D60(v187);
      v109 = v192;
      v110 = v191;
      for ( j = (unsigned int)v203; v109 != v110; LODWORD(v203) = v203 + 1 )
      {
        a4 = HIDWORD(v203);
        a3 = j + 1;
        v112 = _mm_loadu_si128(v110);
        if ( j + 1 > (unsigned __int64)HIDWORD(v203) )
        {
          a2 = v204;
          v188 = v112;
          sub_C8D5F0((__int64)&v202, v204, a3, 0x10u, v4, v5);
          j = (unsigned int)v203;
          v112 = _mm_load_si128(&v188);
        }
        ++v110;
        *(__m128i *)&v202[16 * j] = v112;
        j = (unsigned int)(v203 + 1);
      }
      if ( v194 )
      {
        a2 = &v196[-v194];
        j_j___libc_free_0(v194);
      }
      if ( v191 )
      {
        a2 = (_BYTE *)(v193 - (_QWORD)v191);
        j_j___libc_free_0((unsigned __int64)v191);
      }
      v14 = v203;
      if ( !(_DWORD)v203 )
        goto LABEL_111;
    }
    v113 = sub_AA5780(v18);
    v114 = *(_QWORD *)(v113 + 72);
    v115 = v113;
    v116.m128i_i64[0] = (__int64)sub_BD5D20((__int64)v187);
    LOWORD(v200) = 773;
    v197 = v116;
    v198 = ".si.unfold.false";
    v117 = sub_BD5C60((__int64)v187);
    v118 = sub_22077B0(0x50u);
    if ( v118 )
      sub_AA4D50(v118, v117, (__int64)&v197, v114, v115);
    v190 = v118;
    v119 = v195;
    if ( v195 == v196 )
    {
      sub_9319A0((__int64)&v194, v195, &v190);
      v118 = v190;
    }
    else
    {
      if ( v195 )
      {
        *(_QWORD *)v195 = v118;
        v119 = v195;
        v118 = v190;
      }
      v195 = v119 + 8;
    }
    sub_B43C20((__int64)&v197, v118);
    v120 = v197.m128i_i64[0];
    v121 = v197.m128i_u16[4];
    v123 = sub_BD2C40(72, 1u);
    if ( v123 )
      sub_B4C8F0((__int64)v123, v115, 1u, v120, v121);
    v197.m128i_i64[0] = v190;
    v197.m128i_i64[1] = v115 & 0xFFFFFFFFFFFFFFFBLL;
    sub_FFB3D0((__int64)v205, (unsigned __int64 *)&v197, 1, v122, v124, v125);
    v186 = (_BYTE *)*(v187 - 8);
    v180 = (_BYTE *)*(v187 - 4);
    v127 = sub_AA5190(v190);
    if ( v127 )
    {
      v128 = v126;
      v171 = HIBYTE(v126);
    }
    else
    {
      v171 = 0;
      v128 = 0;
    }
    v175 = v127;
    v197.m128i_i64[0] = (__int64)sub_BD5D20((__int64)v180);
    v198 = ".si.unfold.phi";
    LOWORD(v200) = 773;
    v197.m128i_i64[1] = v129;
    v130 = *(_QWORD *)(v188.m128i_i64[0] + 8);
    v131 = sub_BD2DA0(80);
    if ( v131 )
    {
      LOBYTE(v132) = v128;
      HIBYTE(v132) = v171;
      sub_B44260(v131, v130, 55, 0x8000000u, v175, v132);
      *(_DWORD *)(v131 + 72) = 1;
      sub_BD6B50((unsigned __int8 *)v131, (const char **)&v197);
      sub_BD2A10(v131, *(_DWORD *)(v131 + 72), 1);
    }
    sub_F0A850(v131, (__int64)v180, v18);
    v133 = sub_AA5930(v115);
    v135 = v134;
    if ( v133 != v134 )
    {
      v136 = v188.m128i_i64[0];
      v176 = v131;
      v137 = v18;
      v138 = v133;
      while ( 1 )
      {
        if ( v136 == v138 )
          goto LABEL_142;
        while ( 1 )
        {
          v139 = *(_QWORD *)(v138 - 8);
          v140 = 0x1FFFFFFFE0LL;
          if ( (*(_DWORD *)(v138 + 4) & 0x7FFFFFF) == 0 )
            goto LABEL_141;
          v141 = 0;
          do
          {
            if ( v137 == *(_QWORD *)(v139 + 32LL * *(unsigned int *)(v138 + 72) + 8 * v141) )
            {
              v140 = 32 * v141;
              goto LABEL_141;
            }
            ++v141;
          }
          while ( (*(_DWORD *)(v138 + 4) & 0x7FFFFFF) != (_DWORD)v141 );
          v140 = 0x1FFFFFFFE0LL;
LABEL_141:
          sub_F0A850(v138, *(_QWORD *)(v139 + v140), v190);
LABEL_142:
          v142 = *(_QWORD *)(v138 + 32);
          if ( !v142 )
            BUG();
          if ( *(_BYTE *)(v142 - 24) == 84 )
            break;
          if ( !v135 )
          {
LABEL_145:
            v18 = v137;
            v131 = v176;
            goto LABEL_146;
          }
          v138 = 0;
        }
        v138 = v142 - 24;
        if ( v135 == v142 - 24 )
          goto LABEL_145;
      }
    }
LABEL_146:
    v143 = v188.m128i_i64[0];
    if ( v115 == *(_QWORD *)(v188.m128i_i64[0] + 40) )
    {
      v163 = v188.m128i_i64[0];
      sub_F0A850(v188.m128i_i64[0], v131, v190);
      sub_BD2ED0(v163, (__int64)v187, (__int64)v186);
      v157 = (__int64)v186;
      if ( *v186 != 86 )
        goto LABEL_168;
    }
    else
    {
      v145 = sub_AA5190(v115);
      if ( v145 )
      {
        v177 = v144;
        v172 = HIBYTE(v144);
      }
      else
      {
        v172 = 0;
        v177 = 0;
      }
      v197.m128i_i64[0] = (__int64)sub_BD5D20((__int64)v187);
      LOWORD(v200) = 773;
      v197.m128i_i64[1] = v146;
      v198 = ".si.unfold.phi";
      v147 = *(_QWORD *)(v115 + 16);
      do
      {
        if ( !v147 )
        {
          v182 = 0;
          goto LABEL_157;
        }
        v148 = **(_BYTE **)(v147 + 24);
        v149 = v147;
        v147 = *(_QWORD *)(v147 + 8);
      }
      while ( (unsigned __int8)(v148 - 30) > 0xAu );
      v150 = 0;
      while ( 1 )
      {
        v149 = *(_QWORD *)(v149 + 8);
        if ( !v149 )
          break;
        while ( (unsigned __int8)(**(_BYTE **)(v149 + 24) - 30) <= 0xAu )
        {
          v149 = *(_QWORD *)(v149 + 8);
          ++v150;
          if ( !v149 )
            goto LABEL_156;
        }
      }
LABEL_156:
      v182 = v150 + 1;
LABEL_157:
      v167 = *(_QWORD *)(v188.m128i_i64[0] + 8);
      v188.m128i_i64[0] = sub_BD2DA0(80);
      v151 = v188.m128i_i64[0];
      if ( v188.m128i_i64[0] )
      {
        LOBYTE(v152) = v177;
        HIBYTE(v152) = v172;
        sub_B44260(v188.m128i_i64[0], v167, 55, 0x8000000u, v145, v152);
        *(_DWORD *)(v151 + 72) = v182;
        sub_BD6B50((unsigned __int8 *)v151, (const char **)&v197);
        sub_BD2A10(v151, *(_DWORD *)(v151 + 72), 1);
      }
      v153 = *(_QWORD *)(v115 + 16);
      if ( v153 )
      {
        while ( 1 )
        {
          v154 = *(_QWORD *)(v153 + 24);
          if ( (unsigned __int8)(*(_BYTE *)v154 - 30) <= 0xAu )
            break;
          v153 = *(_QWORD *)(v153 + 8);
          if ( !v153 )
            goto LABEL_167;
        }
LABEL_163:
        v155 = *(_QWORD *)(v154 + 40);
        if ( v18 != v155 && v155 != v190 )
          sub_F0A850(v188.m128i_i64[0], v188.m128i_i64[0], v155);
        while ( 1 )
        {
          v153 = *(_QWORD *)(v153 + 8);
          if ( !v153 )
            break;
          v154 = *(_QWORD *)(v153 + 24);
          if ( (unsigned __int8)(*(_BYTE *)v154 - 30) <= 0xAu )
            goto LABEL_163;
        }
      }
LABEL_167:
      v156 = v188.m128i_i64[0];
      sub_F0A850(v188.m128i_i64[0], (__int64)v186, v18);
      sub_F0A850(v156, v131, v190);
      sub_BD2ED0(v143, (__int64)v187, v156);
      v157 = (__int64)v186;
      if ( *v186 != 86 )
      {
LABEL_168:
        v158 = (__int64)v180;
        if ( *v180 != 86 )
        {
LABEL_169:
          sub_B43D60((_QWORD *)(v183 - 24));
          sub_B43C20((__int64)&v197, v18);
          v159 = v190;
          v160 = v197.m128i_i64[0];
          v161 = v197.m128i_u16[4];
          v188.m128i_i64[0] = *(v187 - 12);
          v162 = sub_BD2C40(72, 3u);
          if ( v162 )
            sub_B4C9A0((__int64)v162, v115, v159, v188.m128i_i64[0], 3u, v67, v160, v161);
          v197.m128i_i64[0] = v18;
          v198 = (const char *)v18;
          v197.m128i_i64[1] = v115 & 0xFFFFFFFFFFFFFFFBLL;
          v99 = v190;
          goto LABEL_97;
        }
LABEL_188:
        v197.m128i_i64[0] = v158;
        v197.m128i_i64[1] = v131;
        sub_2765570((unsigned __int64 *)&v191, &v197);
        goto LABEL_169;
      }
    }
    v197.m128i_i64[0] = v157;
    v197.m128i_i64[1] = v188.m128i_i64[0];
    sub_2765570((unsigned __int64 *)&v191, &v197);
    v158 = (__int64)v180;
    if ( *v180 != 86 )
      goto LABEL_169;
    goto LABEL_188;
  }
LABEL_111:
  if ( v202 != v204 )
    _libc_free((unsigned __int64)v202);
LABEL_2:
  sub_FFCE90((__int64)v205, (__int64)a2, a3, a4, v4, v5);
  sub_FFD870((__int64)v205, (__int64)a2, v6, v7, v8, v9);
  sub_FFBC40((__int64)v205, (__int64)a2);
  v10 = v220;
  v11 = v219;
  if ( v220 != v219 )
  {
    do
    {
      v12 = (void (__fastcall *)(_QWORD *, _QWORD *, __int64))v11[7];
      *v11 = &unk_49E5048;
      if ( v12 )
        v12(v11 + 5, v11 + 5, 3);
      *v11 = &unk_49DB368;
      v13 = v11[3];
      if ( v13 != 0 && v13 != -4096 && v13 != -8192 )
        sub_BD60C0(v11 + 1);
      v11 += 9;
    }
    while ( v10 != v11 );
    v11 = v219;
  }
  if ( v11 )
    j_j___libc_free_0((unsigned __int64)v11);
  if ( !v216 )
    _libc_free((unsigned __int64)v213);
  if ( (_BYTE *)v205[0] != v206 )
    _libc_free(v205[0]);
}
